Fri Mar 10 07:22:45 UTC 2023
customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_app_configuration []

PRETEST: tests/azure_app_configuration

TEST: tests/azure_app_configuration
Running terraform

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_app_configuration.named_test_resource will be created
  + resource "azurerm_app_configuration" "named_test_resource" {
      + endpoint            = (known after apply)
      + id                  = (known after apply)
      + location            = "westeurope"
      + name                = "turbottest73474"
      + primary_read_key    = (known after apply)
      + primary_write_key   = (known after apply)
      + resource_group_name = "turbottest73474"
      + secondary_read_key  = (known after apply)
      + secondary_write_key = (known after apply)
      + sku                 = "free"
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "westeurope"
      + name     = "turbottest73474"
    }

Plan: 2 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + region             = "westeurope"
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest73474"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 2s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest73474]
azurerm_app_configuration.named_test_resource: Creating...
azurerm_app_configuration.named_test_resource: Still creating... [10s elapsed]
azurerm_app_configuration.named_test_resource: Creation complete after 16s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest73474/providers/Microsoft.AppConfiguration/configurationStores/turbottest73474]

Apply complete! Resources: 2 added, 0 changed, 0 destroyed.

Outputs:

region = "westeurope"
resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest73474/providers/Microsoft.AppConfiguration/configurationStores/turbottest73474"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest73474/providers/microsoft.appconfiguration/configurationstores/turbottest73474"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest73474/providers/Microsoft.AppConfiguration/configurationStores/turbottest73474"
resource_name = "turbottest73474"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest73474/providers/Microsoft.AppConfiguration/configurationStores/turbottest73474",
    "name": "turbottest73474",
    "region": "westeurope",
    "resource_group": "turbottest73474",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "type": "Microsoft.AppConfiguration/configurationStores"
  }
]
✔ PASSED

Running SQL query: test-list-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest73474/providers/Microsoft.AppConfiguration/configurationStores/turbottest73474",
    "name": "turbottest73474",
    "region": "westeurope",
    "resource_group": "turbottest73474",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "type": "Microsoft.AppConfiguration/configurationStores"
  }
]
✔ PASSED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest73474/providers/Microsoft.AppConfiguration/configurationStores/turbottest73474",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest73474/providers/microsoft.appconfiguration/configurationstores/turbottest73474"
    ],
    "name": "turbottest73474",
    "title": "turbottest73474"
  }
]
✔ PASSED

POSTTEST: tests/azure_app_configuration

TEARDOWN: tests/azure_app_configuration

SUMMARY:

1/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_app_service_environment []

PRETEST: tests/azure_app_service_environment

TEST: tests/azure_app_service_environment
Running terraform

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 29, in data "null_data_source" "resource":
  29: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

Error: Missing required argument

  on variables.tf line 47, in resource "azurerm_subnet" "named_test_resource":
  47: resource "azurerm_subnet" "named_test_resource" {

The argument "address_prefixes" is required, but no definition was found.

Error: Unsupported argument

  on variables.tf line 51, in resource "azurerm_subnet" "named_test_resource":
  51:   address_prefix       = "10.0.1.0/24"

An argument named "address_prefix" is not expected here. Did you mean
"address_prefixes"?
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_app_service_environment
Error: Missing required argument

  on variables.tf line 47, in resource "azurerm_subnet" "named_test_resource":
  47: resource "azurerm_subnet" "named_test_resource" {

The argument "address_prefixes" is required, but no definition was found.

Error: Unsupported argument

  on variables.tf line 51, in resource "azurerm_subnet" "named_test_resource":
  51:   address_prefix       = "10.0.1.0/24"

An argument named "address_prefix" is not expected here. Did you mean
"address_prefixes"?
SUMMARY:

✘ tests/azure_app_service_environment failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_app_service_function_app []

PRETEST: tests/azure_app_service_function_app

TEST: tests/azure_app_service_function_app
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_app_service_plan.named_test_resource will be created
  + resource "azurerm_app_service_plan" "named_test_resource" {
      + id                           = (known after apply)
      + kind                         = "Windows"
      + location                     = "eastus"
      + maximum_elastic_worker_count = (known after apply)
      + maximum_number_of_workers    = (known after apply)
      + name                         = "turbottest7943"
      + resource_group_name          = "turbottest7943"

      + sku {
          + capacity = (known after apply)
          + size     = "S1"
          + tier     = "Standard"
        }
    }

  # azurerm_function_app.named_test_resource will be created
  + resource "azurerm_function_app" "named_test_resource" {
      + app_service_plan_id             = (known after apply)
      + app_settings                    = (known after apply)
      + custom_domain_verification_id   = (known after apply)
      + default_hostname                = (known after apply)
      + enable_builtin_logging          = true
      + enabled                         = true
      + https_only                      = false
      + id                              = (known after apply)
      + key_vault_reference_identity_id = (known after apply)
      + kind                            = (known after apply)
      + location                        = "eastus"
      + name                            = "turbottest7943"
      + outbound_ip_addresses           = (known after apply)
      + possible_outbound_ip_addresses  = (known after apply)
      + resource_group_name             = "turbottest7943"
      + site_credential                 = (known after apply)
      + storage_account_access_key      = (sensitive value)
      + storage_account_name            = "turbottest7943"
      + tags                            = {
          + "name" = "turbottest7943"
        }
      + version                         = "~1"

      + auth_settings {
          + additional_login_params        = (known after apply)
          + allowed_external_redirect_urls = (known after apply)
          + default_provider               = (known after apply)
          + enabled                        = (known after apply)
          + issuer                         = (known after apply)
          + runtime_version                = (known after apply)
          + token_refresh_extension_hours  = (known after apply)
          + token_store_enabled            = (known after apply)
          + unauthenticated_client_action  = (known after apply)

          + active_directory {
              + allowed_audiences = (known after apply)
              + client_id         = (known after apply)
              + client_secret     = (sensitive value)
            }

          + facebook {
              + app_id       = (known after apply)
              + app_secret   = (sensitive value)
              + oauth_scopes = (known after apply)
            }

          + google {
              + client_id     = (known after apply)
              + client_secret = (sensitive value)
              + oauth_scopes  = (known after apply)
            }

          + microsoft {
              + client_id     = (known after apply)
              + client_secret = (sensitive value)
              + oauth_scopes  = (known after apply)
            }

          + twitter {
              + consumer_key    = (known after apply)
              + consumer_secret = (sensitive value)
            }
        }

      + connection_string {
          + name  = (known after apply)
          + type  = (known after apply)
          + value = (sensitive value)
        }

      + site_config {
          + always_on                        = (known after apply)
          + app_scale_limit                  = (known after apply)
          + auto_swap_slot_name              = (known after apply)
          + dotnet_framework_version         = (known after apply)
          + elastic_instance_minimum         = (known after apply)
          + ftps_state                       = (known after apply)
          + health_check_path                = (known after apply)
          + http2_enabled                    = (known after apply)
          + ip_restriction                   = (known after apply)
          + java_version                     = (known after apply)
          + linux_fx_version                 = (known after apply)
          + min_tls_version                  = (known after apply)
          + pre_warmed_instance_count        = (known after apply)
          + runtime_scale_monitoring_enabled = (known after apply)
          + scm_ip_restriction               = (known after apply)
          + scm_type                         = (known after apply)
          + scm_use_main_ip_restriction      = (known after apply)
          + use_32_bit_worker_process        = (known after apply)
          + vnet_route_all_enabled           = (known after apply)
          + websockets_enabled               = (known after apply)

          + cors {
              + allowed_origins     = (known after apply)
              + support_credentials = (known after apply)
            }
        }

      + source_control {
          + branch             = (known after apply)
          + manual_integration = (known after apply)
          + repo_url           = (known after apply)
          + rollback_enabled   = (known after apply)
          + use_mercurial      = (known after apply)
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "eastus"
      + name     = "turbottest7943"
    }

  # azurerm_storage_account.named_test_resource will be created
  + resource "azurerm_storage_account" "named_test_resource" {
      + access_tier                       = (known after apply)
      + account_kind                      = "StorageV2"
      + account_replication_type          = "LRS"
      + account_tier                      = "Standard"
      + allow_nested_items_to_be_public   = true
      + cross_tenant_replication_enabled  = true
      + default_to_oauth_authentication   = false
      + enable_https_traffic_only         = true
      + id                                = (known after apply)
      + infrastructure_encryption_enabled = false
      + is_hns_enabled                    = false
      + large_file_share_enabled          = (known after apply)
      + location                          = "eastus"
      + min_tls_version                   = "TLS1_2"
      + name                              = "turbottest7943"
      + nfsv3_enabled                     = false
      + primary_access_key                = (sensitive value)
      + primary_blob_connection_string    = (sensitive value)
      + primary_blob_endpoint             = (known after apply)
      + primary_blob_host                 = (known after apply)
      + primary_connection_string         = (sensitive value)
      + primary_dfs_endpoint              = (known after apply)
      + primary_dfs_host                  = (known after apply)
      + primary_file_endpoint             = (known after apply)
      + primary_file_host                 = (known after apply)
      + primary_location                  = (known after apply)
      + primary_queue_endpoint            = (known after apply)
      + primary_queue_host                = (known after apply)
      + primary_table_endpoint            = (known after apply)
      + primary_table_host                = (known after apply)
      + primary_web_endpoint              = (known after apply)
      + primary_web_host                  = (known after apply)
      + public_network_access_enabled     = true
      + queue_encryption_key_type         = "Service"
      + resource_group_name               = "turbottest7943"
      + secondary_access_key              = (sensitive value)
      + secondary_blob_connection_string  = (sensitive value)
      + secondary_blob_endpoint           = (known after apply)
      + secondary_blob_host               = (known after apply)
      + secondary_connection_string       = (sensitive value)
      + secondary_dfs_endpoint            = (known after apply)
      + secondary_dfs_host                = (known after apply)
      + secondary_file_endpoint           = (known after apply)
      + secondary_file_host               = (known after apply)
      + secondary_location                = (known after apply)
      + secondary_queue_endpoint          = (known after apply)
      + secondary_queue_host              = (known after apply)
      + secondary_table_endpoint          = (known after apply)
      + secondary_table_host              = (known after apply)
      + secondary_web_endpoint            = (known after apply)
      + secondary_web_host                = (known after apply)
      + sftp_enabled                      = false
      + shared_access_key_enabled         = true
      + table_encryption_key_type         = "Service"

      + blob_properties {
          + change_feed_enabled           = (known after apply)
          + change_feed_retention_in_days = (known after apply)
          + default_service_version       = (known after apply)
          + last_access_time_enabled      = (known after apply)
          + versioning_enabled            = (known after apply)

          + container_delete_retention_policy {
              + days = (known after apply)
            }

          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + delete_retention_policy {
              + days = (known after apply)
            }

          + restore_policy {
              + days = (known after apply)
            }
        }

      + network_rules {
          + bypass                     = (known after apply)
          + default_action             = (known after apply)
          + ip_rules                   = (known after apply)
          + virtual_network_subnet_ids = (known after apply)

          + private_link_access {
              + endpoint_resource_id = (known after apply)
              + endpoint_tenant_id   = (known after apply)
            }
        }

      + queue_properties {
          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + hour_metrics {
              + enabled               = (known after apply)
              + include_apis          = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
            }

          + logging {
              + delete                = (known after apply)
              + read                  = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
              + write                 = (known after apply)
            }

          + minute_metrics {
              + enabled               = (known after apply)
              + include_apis          = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
            }
        }

      + routing {
          + choice                      = (known after apply)
          + publish_internet_endpoints  = (known after apply)
          + publish_microsoft_endpoints = (known after apply)
        }

      + share_properties {
          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + retention_policy {
              + days = (known after apply)
            }

          + smb {
              + authentication_types            = (known after apply)
              + channel_encryption_type         = (known after apply)
              + kerberos_ticket_encryption_type = (known after apply)
              + multichannel_enabled            = (known after apply)
              + versions                        = (known after apply)
            }
        }
    }

Plan: 4 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest7943"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 5s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest7943]
azurerm_app_service_plan.named_test_resource: Creating...
azurerm_storage_account.named_test_resource: Creating...
azurerm_app_service_plan.named_test_resource: Still creating... [10s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [10s elapsed]
azurerm_app_service_plan.named_test_resource: Creation complete after 15s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest7943/providers/Microsoft.Web/serverfarms/turbottest7943]
azurerm_storage_account.named_test_resource: Still creating... [20s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [30s elapsed]
azurerm_storage_account.named_test_resource: Creation complete after 34s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest7943/providers/Microsoft.Storage/storageAccounts/turbottest7943]
azurerm_function_app.named_test_resource: Creating...
azurerm_function_app.named_test_resource: Still creating... [10s elapsed]
azurerm_function_app.named_test_resource: Still creating... [20s elapsed]
azurerm_function_app.named_test_resource: Still creating... [30s elapsed]
azurerm_function_app.named_test_resource: Still creating... [40s elapsed]
azurerm_function_app.named_test_resource: Still creating... [50s elapsed]
azurerm_function_app.named_test_resource: Creation complete after 55s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest7943/providers/Microsoft.Web/sites/turbottest7943]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 29, in data "null_data_source" "resource":
  29: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Warning: Deprecated Resource

  with azurerm_app_service_plan.named_test_resource,
  on variables.tf line 48, in resource "azurerm_app_service_plan" "named_test_resource":
  48: resource "azurerm_app_service_plan" "named_test_resource" {

The `azurerm_app_service_plan` resource has been superseded by the
`azurerm_service_plan` resource. Whilst this resource will continue to be
available in the 2.x and 3.x releases it is feature-frozen for compatibility
purposes, will no longer receive any updates and will be removed in a future
major release of the Azure Provider.

(and 5 more similar warnings elsewhere)

Apply complete! Resources: 4 added, 0 changed, 0 destroyed.

Outputs:

resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest7943/providers/Microsoft.Web/sites/turbottest7943"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest7943/providers/microsoft.web/sites/turbottest7943"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest7943/providers/Microsoft.Web/sites/turbottest7943"
resource_name = "turbottest7943"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "client_affinity_enabled": false,
    "enabled": true,
    "https_only": false,
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest7943/providers/Microsoft.Web/sites/turbottest7943",
    "kind": "functionapp",
    "name": "turbottest7943",
    "region": "east us",
    "resource_group": "turbottest7943"
  }
]
✔ PASSED

Running SQL query: test-hydrate-query.sql
[
  {
    "client_affinity_enabled": false,
    "enabled": true,
    "https_only": false,
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest7943/providers/Microsoft.Web/sites/turbottest7943",
    "kind": "functionapp",
    "name": "turbottest7943",
    "region": "east us",
    "resource_group": "turbottest7943"
  }
]
✔ PASSED

Running SQL query: test-list-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest7943/providers/Microsoft.Web/sites/turbottest7943",
    "name": "turbottest7943"
  }
]
✔ PASSED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest7943/providers/Microsoft.Web/sites/turbottest7943",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest7943/providers/microsoft.web/sites/turbottest7943"
    ],
    "name": "turbottest7943",
    "tags": {
      "name": "turbottest7943"
    },
    "title": "turbottest7943"
  }
]
✔ PASSED

POSTTEST: tests/azure_app_service_function_app

TEARDOWN: tests/azure_app_service_function_app

SUMMARY:

1/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_app_service_web_app []

PRETEST: tests/azure_app_service_web_app

TEST: tests/azure_app_service_web_app
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_app_service.named_test_resource will be created
  + resource "azurerm_app_service" "named_test_resource" {
      + app_service_plan_id               = (known after apply)
      + app_settings                      = (known after apply)
      + client_affinity_enabled           = false
      + client_cert_enabled               = false
      + client_cert_mode                  = (known after apply)
      + custom_domain_verification_id     = (known after apply)
      + default_site_hostname             = (known after apply)
      + enabled                           = true
      + https_only                        = false
      + id                                = (known after apply)
      + key_vault_reference_identity_id   = (known after apply)
      + location                          = "eastus"
      + name                              = "turbottest81704"
      + outbound_ip_address_list          = (known after apply)
      + outbound_ip_addresses             = (known after apply)
      + possible_outbound_ip_address_list = (known after apply)
      + possible_outbound_ip_addresses    = (known after apply)
      + resource_group_name               = "turbottest81704"
      + site_credential                   = (known after apply)
      + tags                              = {
          + "name" = "turbottest81704"
        }

      + auth_settings {
          + additional_login_params        = (known after apply)
          + allowed_external_redirect_urls = (known after apply)
          + default_provider               = (known after apply)
          + enabled                        = (known after apply)
          + issuer                         = (known after apply)
          + runtime_version                = (known after apply)
          + token_refresh_extension_hours  = (known after apply)
          + token_store_enabled            = (known after apply)
          + unauthenticated_client_action  = (known after apply)

          + active_directory {
              + allowed_audiences = (known after apply)
              + client_id         = (known after apply)
              + client_secret     = (sensitive value)
            }

          + facebook {
              + app_id       = (known after apply)
              + app_secret   = (sensitive value)
              + oauth_scopes = (known after apply)
            }

          + google {
              + client_id     = (known after apply)
              + client_secret = (sensitive value)
              + oauth_scopes  = (known after apply)
            }

          + microsoft {
              + client_id     = (known after apply)
              + client_secret = (sensitive value)
              + oauth_scopes  = (known after apply)
            }

          + twitter {
              + consumer_key    = (known after apply)
              + consumer_secret = (sensitive value)
            }
        }

      + connection_string {
          + name  = (known after apply)
          + type  = (known after apply)
          + value = (sensitive value)
        }

      + identity {
          + principal_id = (known after apply)
          + tenant_id    = (known after apply)
          + type         = "SystemAssigned"
        }

      + logs {
          + detailed_error_messages_enabled = (known after apply)
          + failed_request_tracing_enabled  = (known after apply)

          + application_logs {
              + file_system_level = (known after apply)

              + azure_blob_storage {
                  + level             = (known after apply)
                  + retention_in_days = (known after apply)
                  + sas_url           = (sensitive value)
                }
            }

          + http_logs {
              + azure_blob_storage {
                  + retention_in_days = (known after apply)
                  + sas_url           = (sensitive value)
                }

              + file_system {
                  + retention_in_days = (known after apply)
                  + retention_in_mb   = (known after apply)
                }
            }
        }

      + site_config {
          + acr_use_managed_identity_credentials = (known after apply)
          + acr_user_managed_identity_client_id  = (known after apply)
          + always_on                            = (known after apply)
          + app_command_line                     = (known after apply)
          + auto_swap_slot_name                  = (known after apply)
          + default_documents                    = (known after apply)
          + dotnet_framework_version             = (known after apply)
          + ftps_state                           = (known after apply)
          + health_check_path                    = (known after apply)
          + http2_enabled                        = (known after apply)
          + ip_restriction                       = (known after apply)
          + java_container                       = (known after apply)
          + java_container_version               = (known after apply)
          + java_version                         = (known after apply)
          + linux_fx_version                     = (known after apply)
          + local_mysql_enabled                  = (known after apply)
          + managed_pipeline_mode                = (known after apply)
          + min_tls_version                      = (known after apply)
          + number_of_workers                    = (known after apply)
          + php_version                          = (known after apply)
          + python_version                       = (known after apply)
          + remote_debugging_enabled             = (known after apply)
          + remote_debugging_version             = (known after apply)
          + scm_ip_restriction                   = (known after apply)
          + scm_type                             = (known after apply)
          + scm_use_main_ip_restriction          = (known after apply)
          + use_32_bit_worker_process            = (known after apply)
          + vnet_route_all_enabled               = (known after apply)
          + websockets_enabled                   = (known after apply)
          + windows_fx_version                   = (known after apply)

          + cors {
              + allowed_origins     = (known after apply)
              + support_credentials = (known after apply)
            }
        }

      + source_control {
          + branch             = (known after apply)
          + manual_integration = (known after apply)
          + repo_url           = (known after apply)
          + rollback_enabled   = (known after apply)
          + use_mercurial      = (known after apply)
        }

      + storage_account {
          + access_key   = (sensitive value)
          + account_name = (known after apply)
          + mount_path   = (known after apply)
          + name         = (known after apply)
          + share_name   = (known after apply)
          + type         = (known after apply)
        }
    }

  # azurerm_app_service_plan.named_test_resource will be created
  + resource "azurerm_app_service_plan" "named_test_resource" {
      + id                           = (known after apply)
      + kind                         = "Windows"
      + location                     = "eastus"
      + maximum_elastic_worker_count = (known after apply)
      + maximum_number_of_workers    = (known after apply)
      + name                         = "turbottest81704"
      + resource_group_name          = "turbottest81704"

      + sku {
          + capacity = (known after apply)
          + size     = "F1"
          + tier     = "Free"
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "eastus"
      + name     = "turbottest81704"
    }

  # azurerm_storage_account.named_test_resource will be created
  + resource "azurerm_storage_account" "named_test_resource" {
      + access_tier                       = (known after apply)
      + account_kind                      = "StorageV2"
      + account_replication_type          = "LRS"
      + account_tier                      = "Standard"
      + allow_nested_items_to_be_public   = true
      + cross_tenant_replication_enabled  = true
      + default_to_oauth_authentication   = false
      + enable_https_traffic_only         = true
      + id                                = (known after apply)
      + infrastructure_encryption_enabled = false
      + is_hns_enabled                    = false
      + large_file_share_enabled          = (known after apply)
      + location                          = "eastus"
      + min_tls_version                   = "TLS1_2"
      + name                              = "turbottest81704"
      + nfsv3_enabled                     = false
      + primary_access_key                = (sensitive value)
      + primary_blob_connection_string    = (sensitive value)
      + primary_blob_endpoint             = (known after apply)
      + primary_blob_host                 = (known after apply)
      + primary_connection_string         = (sensitive value)
      + primary_dfs_endpoint              = (known after apply)
      + primary_dfs_host                  = (known after apply)
      + primary_file_endpoint             = (known after apply)
      + primary_file_host                 = (known after apply)
      + primary_location                  = (known after apply)
      + primary_queue_endpoint            = (known after apply)
      + primary_queue_host                = (known after apply)
      + primary_table_endpoint            = (known after apply)
      + primary_table_host                = (known after apply)
      + primary_web_endpoint              = (known after apply)
      + primary_web_host                  = (known after apply)
      + public_network_access_enabled     = true
      + queue_encryption_key_type         = "Service"
      + resource_group_name               = "turbottest81704"
      + secondary_access_key              = (sensitive value)
      + secondary_blob_connection_string  = (sensitive value)
      + secondary_blob_endpoint           = (known after apply)
      + secondary_blob_host               = (known after apply)
      + secondary_connection_string       = (sensitive value)
      + secondary_dfs_endpoint            = (known after apply)
      + secondary_dfs_host                = (known after apply)
      + secondary_file_endpoint           = (known after apply)
      + secondary_file_host               = (known after apply)
      + secondary_location                = (known after apply)
      + secondary_queue_endpoint          = (known after apply)
      + secondary_queue_host              = (known after apply)
      + secondary_table_endpoint          = (known after apply)
      + secondary_table_host              = (known after apply)
      + secondary_web_endpoint            = (known after apply)
      + secondary_web_host                = (known after apply)
      + sftp_enabled                      = false
      + shared_access_key_enabled         = true
      + table_encryption_key_type         = "Service"

      + blob_properties {
          + change_feed_enabled           = (known after apply)
          + change_feed_retention_in_days = (known after apply)
          + default_service_version       = (known after apply)
          + last_access_time_enabled      = (known after apply)
          + versioning_enabled            = (known after apply)

          + container_delete_retention_policy {
              + days = (known after apply)
            }

          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + delete_retention_policy {
              + days = (known after apply)
            }

          + restore_policy {
              + days = (known after apply)
            }
        }

      + network_rules {
          + bypass                     = (known after apply)
          + default_action             = (known after apply)
          + ip_rules                   = (known after apply)
          + virtual_network_subnet_ids = (known after apply)

          + private_link_access {
              + endpoint_resource_id = (known after apply)
              + endpoint_tenant_id   = (known after apply)
            }
        }

      + queue_properties {
          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + hour_metrics {
              + enabled               = (known after apply)
              + include_apis          = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
            }

          + logging {
              + delete                = (known after apply)
              + read                  = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
              + write                 = (known after apply)
            }

          + minute_metrics {
              + enabled               = (known after apply)
              + include_apis          = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
            }
        }

      + routing {
          + choice                      = (known after apply)
          + publish_internet_endpoints  = (known after apply)
          + publish_microsoft_endpoints = (known after apply)
        }

      + share_properties {
          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + retention_policy {
              + days = (known after apply)
            }

          + smb {
              + authentication_types            = (known after apply)
              + channel_encryption_type         = (known after apply)
              + kerberos_ticket_encryption_type = (known after apply)
              + multichannel_enabled            = (known after apply)
              + versions                        = (known after apply)
            }
        }
    }

Plan: 4 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + principal_id       = (known after apply)
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest81704"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
  + tenant_id          = (known after apply)
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 4s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest81704]
azurerm_app_service_plan.named_test_resource: Creating...
azurerm_storage_account.named_test_resource: Creating...
azurerm_app_service_plan.named_test_resource: Still creating... [10s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [10s elapsed]
azurerm_app_service_plan.named_test_resource: Creation complete after 12s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest81704/providers/Microsoft.Web/serverfarms/turbottest81704]
azurerm_app_service.named_test_resource: Creating...
azurerm_storage_account.named_test_resource: Still creating... [20s elapsed]
azurerm_app_service.named_test_resource: Still creating... [10s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [30s elapsed]
azurerm_app_service.named_test_resource: Still creating... [20s elapsed]
azurerm_storage_account.named_test_resource: Creation complete after 33s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest81704/providers/Microsoft.Storage/storageAccounts/turbottest81704]
azurerm_app_service.named_test_resource: Still creating... [30s elapsed]
azurerm_app_service.named_test_resource: Still creating... [40s elapsed]
azurerm_app_service.named_test_resource: Still creating... [50s elapsed]
azurerm_app_service.named_test_resource: Creation complete after 58s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest81704/providers/Microsoft.Web/sites/turbottest81704]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 29, in data "null_data_source" "resource":
  29: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Warning: Deprecated Resource

  with azurerm_app_service_plan.named_test_resource,
  on variables.tf line 48, in resource "azurerm_app_service_plan" "named_test_resource":
  48: resource "azurerm_app_service_plan" "named_test_resource" {

The `azurerm_app_service_plan` resource has been superseded by the
`azurerm_service_plan` resource. Whilst this resource will continue to be
available in the 2.x and 3.x releases it is feature-frozen for compatibility
purposes, will no longer receive any updates and will be removed in a future
major release of the Azure Provider.

(and 5 more similar warnings elsewhere)

Apply complete! Resources: 4 added, 0 changed, 0 destroyed.

Outputs:

principal_id = "218b12d3-a72c-4c71-addf-4172944be132"
resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest81704/providers/Microsoft.Web/sites/turbottest81704"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest81704/providers/microsoft.web/sites/turbottest81704"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest81704/providers/Microsoft.Web/sites/turbottest81704"
resource_name = "turbottest81704"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"
tenant_id = "cdffd708-7da0-4cea-abeb-0a4c334d7f64"

Running SQL query: test-get-query.sql
[
  {
    "client_affinity_enabled": false,
    "enabled": true,
    "https_only": false,
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest81704/providers/Microsoft.Web/sites/turbottest81704",
    "identity": {
      "PrincipalID": "218b12d3-a72c-4c71-addf-4172944be132",
      "TenantID": "cdffd708-7da0-4cea-abeb-0a4c334d7f64"
    },
    "kind": "app",
    "name": "turbottest81704",
    "region": "east us",
    "reserved": false,
    "resource_group": "turbottest81704"
  }
]
✔ PASSED

Running SQL query: test-hydrate-query.sql
[
  {
    "client_affinity_enabled": false,
    "enabled": true,
    "https_only": false,
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest81704/providers/Microsoft.Web/sites/turbottest81704",
    "kind": "app",
    "name": "turbottest81704",
    "region": "east us",
    "resource_group": "turbottest81704"
  }
]
✔ PASSED

Running SQL query: test-list-query.sql
null
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest81704/providers/Microsoft.Web/sites/turbottest81704",
    "identity": {
      "PrincipalID": "218b12d3-a72c-4c71-addf-4172944be132",
      "TenantID": "cdffd708-7da0-4cea-abeb-0a4c334d7f64"
    },
    "name": "turbottest81704"
  }
]

✘ FAILED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest81704/providers/Microsoft.Web/sites/turbottest81704",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest81704/providers/microsoft.web/sites/turbottest81704"
    ],
    "name": "turbottest81704",
    "tags": {
      "name": "turbottest81704"
    },
    "title": "turbottest81704"
  }
]
✔ PASSED

TEARDOWN: tests/azure_app_service_web_app

SUMMARY:

✘ tests/azure_app_service_web_app failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_automation_account []

PRETEST: tests/azure_automation_account

TEST: tests/azure_automation_account
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_automation_account.named_test_resource will be created
  + resource "azurerm_automation_account" "named_test_resource" {
      + dsc_primary_access_key        = (sensitive value)
      + dsc_secondary_access_key      = (sensitive value)
      + dsc_server_endpoint           = (known after apply)
      + hybrid_service_url            = (known after apply)
      + id                            = (known after apply)
      + local_authentication_enabled  = true
      + location                      = "eastus"
      + name                          = "turbottest89288"
      + private_endpoint_connection   = (known after apply)
      + public_network_access_enabled = true
      + resource_group_name           = "turbottest89288"
      + sku_name                      = "Basic"
      + tags                          = {
          + "name" = "turbottest89288"
        }

      + encryption {
          + key_source                = (known after apply)
          + key_vault_key_id          = (known after apply)
          + user_assigned_identity_id = (known after apply)
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "eastus"
      + name     = "turbottest89288"
    }

Plan: 2 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + location           = "eastus"
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest89288"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 4s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest89288]
azurerm_automation_account.named_test_resource: Creating...
azurerm_automation_account.named_test_resource: Still creating... [10s elapsed]
azurerm_automation_account.named_test_resource: Creation complete after 12s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest89288/providers/Microsoft.Automation/automationAccounts/turbottest89288]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 28, in data "null_data_source" "resource":
  28: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Apply complete! Resources: 2 added, 0 changed, 0 destroyed.

Outputs:

location = "eastus"
resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest89288/providers/Microsoft.Automation/automationAccounts/turbottest89288"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest89288/providers/microsoft.automation/automationaccounts/turbottest89288"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest89288/providers/Microsoft.Automation/automationAccounts/turbottest89288"
resource_name = "turbottest89288"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest89288/providers/Microsoft.Automation/automationAccounts/turbottest89288",
    "name": "turbottest89288",
    "region": "eastus",
    "resource_group": "turbottest89288",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "type": "Microsoft.Automation/AutomationAccounts"
  }
]
✔ PASSED

Running SQL query: test-list-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest89288/providers/Microsoft.Automation/automationAccounts/turbottest89288",
    "name": "turbottest89288",
    "type": "Microsoft.Automation/AutomationAccounts"
  }
]
✔ PASSED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest89288/providers/Microsoft.Automation/automationAccounts/turbottest89288",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest89288/providers/microsoft.automation/automationaccounts/turbottest89288"
    ],
    "name": "turbottest89288",
    "title": "turbottest89288"
  }
]
✔ PASSED

POSTTEST: tests/azure_automation_account

TEARDOWN: tests/azure_automation_account

SUMMARY:

1/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_automation_variable []

PRETEST: tests/azure_automation_variable

TEST: tests/azure_automation_variable
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_automation_account.named_test_resource will be created
  + resource "azurerm_automation_account" "named_test_resource" {
      + dsc_primary_access_key        = (sensitive value)
      + dsc_secondary_access_key      = (sensitive value)
      + dsc_server_endpoint           = (known after apply)
      + hybrid_service_url            = (known after apply)
      + id                            = (known after apply)
      + local_authentication_enabled  = true
      + location                      = "eastus"
      + name                          = "turbottest97893"
      + private_endpoint_connection   = (known after apply)
      + public_network_access_enabled = true
      + resource_group_name           = "turbottest97893"
      + sku_name                      = "Basic"
      + tags                          = {
          + "name" = "turbottest97893"
        }

      + encryption {
          + key_source                = (known after apply)
          + key_vault_key_id          = (known after apply)
          + user_assigned_identity_id = (known after apply)
        }
    }

  # azurerm_automation_variable_string.named_test_resource will be created
  + resource "azurerm_automation_variable_string" "named_test_resource" {
      + automation_account_name = "turbottest97893"
      + encrypted               = false
      + id                      = (known after apply)
      + name                    = "turbottest97893"
      + resource_group_name     = "turbottest97893"
      + value                   = "Hello, Terraform Basic Test."
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "eastus"
      + name     = "turbottest97893"
    }

Plan: 3 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest97893"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 4s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest97893]
azurerm_automation_account.named_test_resource: Creating...
azurerm_automation_account.named_test_resource: Still creating... [10s elapsed]
azurerm_automation_account.named_test_resource: Creation complete after 10s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest97893/providers/Microsoft.Automation/automationAccounts/turbottest97893]
azurerm_automation_variable_string.named_test_resource: Creating...
azurerm_automation_variable_string.named_test_resource: Creation complete after 3s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest97893/providers/Microsoft.Automation/automationAccounts/turbottest97893/variables/turbottest97893]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 28, in data "null_data_source" "resource":
  28: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Apply complete! Resources: 3 added, 0 changed, 0 destroyed.

Outputs:

resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest97893/providers/Microsoft.Automation/automationAccounts/turbottest97893/variables/turbottest97893"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest97893/providers/microsoft.automation/automationaccounts/turbottest97893/variables/turbottest97893"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest97893/providers/Microsoft.Automation/automationAccounts/turbottest97893/variables/turbottest97893"
resource_name = "turbottest97893"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest97893/providers/Microsoft.Automation/automationAccounts/turbottest97893/variables/turbottest97893",
    "name": "turbottest97893",
    "resource_group": "turbottest97893",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "type": "Microsoft.Automation/AutomationAccounts/Variables"
  }
]
✔ PASSED

Running SQL query: test-list-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest97893/providers/Microsoft.Automation/automationAccounts/turbottest97893/variables/turbottest97893",
    "name": "turbottest97893",
    "type": "Microsoft.Automation/AutomationAccounts/Variables"
  }
]
✔ PASSED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
null
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest97893/providers/Microsoft.Automation/automationAccounts/turbottest97893/variables/turbottest97893",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest97893/providers/microsoft.automation/automationaccounts/turbottest97893/variables/turbottest97893"
    ],
    "name": "turbottest97893",
    "title": "turbottest97893"
  }
]

✘ FAILED

TEARDOWN: tests/azure_automation_variable

SUMMARY:

✘ tests/azure_automation_variable failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_batch_account []

PRETEST: tests/azure_batch_account

TEST: tests/azure_batch_account
Running terraform

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 28, in data "null_data_source" "resource":
  28: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

Error: Missing required argument

  with azurerm_batch_account.named_test_resource,
  on variables.tf line 52, in resource "azurerm_batch_account" "named_test_resource":
  52:   storage_account_id   = azurerm_storage_account.named_test_resource.id

"storage_account_id": all of
`storage_account_authentication_mode,storage_account_id` must be specified
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_batch_account


Error: Missing required argument

  with azurerm_batch_account.named_test_resource,
  on variables.tf line 52, in resource "azurerm_batch_account" "named_test_resource":
  52:   storage_account_id   = azurerm_storage_account.named_test_resource.id

"storage_account_id": all of
`storage_account_authentication_mode,storage_account_id` must be specified
SUMMARY:

✘ tests/azure_batch_account failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_compute_disk_encryption_set []

PRETEST: tests/azure_compute_disk_encryption_set

TEST: tests/azure_compute_disk_encryption_set
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_disk_encryption_set.named_test_resource will be created
  + resource "azurerm_disk_encryption_set" "named_test_resource" {
      + encryption_type     = "EncryptionAtRestWithCustomerKey"
      + id                  = (known after apply)
      + key_vault_key_id    = (known after apply)
      + location            = "eastus"
      + name                = "turbottest67369"
      + resource_group_name = "turbottest67369"
      + tags                = {
          + "name" = "turbottest67369"
        }

      + identity {
          + principal_id = (known after apply)
          + tenant_id    = (known after apply)
          + type         = "SystemAssigned"
        }
    }

  # azurerm_key_vault.named_test_resource will be created
  + resource "azurerm_key_vault" "named_test_resource" {
      + access_policy                 = (known after apply)
      + enabled_for_disk_encryption   = true
      + id                            = (known after apply)
      + location                      = "eastus"
      + name                          = "turbottest67369"
      + public_network_access_enabled = true
      + purge_protection_enabled      = true
      + resource_group_name           = "turbottest67369"
      + sku_name                      = "premium"
      + soft_delete_retention_days    = 7
      + tenant_id                     = "cdffd708-7da0-4cea-abeb-0a4c334d7f64"
      + vault_uri                     = (known after apply)

      + network_acls {
          + bypass                     = (known after apply)
          + default_action             = (known after apply)
          + ip_rules                   = (known after apply)
          + virtual_network_subnet_ids = (known after apply)
        }
    }

  # azurerm_key_vault_access_policy.named_test_resource will be created
  + resource "azurerm_key_vault_access_policy" "named_test_resource" {
      + id              = (known after apply)
      + key_permissions = [
          + "Create",
          + "Delete",
          + "Get",
          + "Purge",
          + "Recover",
          + "Update",
          + "List",
          + "Decrypt",
          + "Sign",
        ]
      + key_vault_id    = (known after apply)
      + object_id       = "06fd46b0-a867-49a1-a4f1-f7768465caba"
      + tenant_id       = "cdffd708-7da0-4cea-abeb-0a4c334d7f64"
    }

  # azurerm_key_vault_key.named_test_resource will be created
  + resource "azurerm_key_vault_key" "named_test_resource" {
      + curve                   = (known after apply)
      + e                       = (known after apply)
      + id                      = (known after apply)
      + key_opts                = [
          + "decrypt",
          + "encrypt",
          + "sign",
          + "unwrapKey",
          + "verify",
          + "wrapKey",
        ]
      + key_size                = 2048
      + key_type                = "RSA"
      + key_vault_id            = (known after apply)
      + n                       = (known after apply)
      + name                    = "turbottest67369"
      + public_key_openssh      = (known after apply)
      + public_key_pem          = (known after apply)
      + resource_id             = (known after apply)
      + resource_versionless_id = (known after apply)
      + version                 = (known after apply)
      + versionless_id          = (known after apply)
      + x                       = (known after apply)
      + y                       = (known after apply)

      + rotation_policy {
          + expire_after         = (known after apply)
          + notify_before_expiry = (known after apply)

          + automatic {
              + time_after_creation = (known after apply)
              + time_before_expiry  = (known after apply)
            }
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "eastus"
      + name     = "turbottest67369"
    }

  # azurerm_role_assignment.example-disk will be created
  + resource "azurerm_role_assignment" "example-disk" {
      + id                               = (known after apply)
      + name                             = (known after apply)
      + principal_id                     = (known after apply)
      + principal_type                   = (known after apply)
      + role_definition_id               = (known after apply)
      + role_definition_name             = "Key Vault Crypto Service Encryption User"
      + scope                            = (known after apply)
      + skip_service_principal_aad_check = (known after apply)
    }

Plan: 6 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + key_id              = (known after apply)
  + object_id           = "06fd46b0-a867-49a1-a4f1-f7768465caba"
  + resource_aka        = (known after apply)
  + resource_aka_lower  = (known after apply)
  + resource_id         = (known after apply)
  + resource_name       = "turbottest67369"
  + resource_name_upper = "TURBOTTEST67369"
  + subscription_id     = "d46d7416-f95f-4771-bbb5-529d4c76659c"
  + tenant_id           = "cdffd708-7da0-4cea-abeb-0a4c334d7f64"
  + vault_id            = (known after apply)
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 3s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest67369]
azurerm_key_vault.named_test_resource: Creating...
azurerm_key_vault.named_test_resource: Still creating... [10s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [20s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [30s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [40s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [50s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m0s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m10s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m20s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m30s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m40s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m50s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m0s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m10s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m20s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m30s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m40s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m50s elapsed]
azurerm_key_vault.named_test_resource: Creation complete after 2m55s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest67369/providers/Microsoft.KeyVault/vaults/turbottest67369]
azurerm_key_vault_access_policy.named_test_resource: Creating...
azurerm_key_vault_access_policy.named_test_resource: Still creating... [10s elapsed]
azurerm_key_vault_access_policy.named_test_resource: Creation complete after 17s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest67369/providers/Microsoft.KeyVault/vaults/turbottest67369/objectId/06fd46b0-a867-49a1-a4f1-f7768465caba]
azurerm_key_vault_key.named_test_resource: Creating...

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 29, in data "null_data_source" "resource":
  29: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Error: current client lacks permissions to read Key Rotation Policy for Key "turbottest67369" ("Vault: (Name \"turbottest67369\" / Resource Group \"turbottest67369\")", Vault url: "https://turbottest67369.vault.azure.net/"), please update this as described here: https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_key#example-usage : keyvault.BaseClient#GetKeyRotationPolicy: Failure responding to request: StatusCode=403 -- Original Error: autorest/azure: Service returned an error. Status=403 Code="Forbidden" Message="The user, group or application 'appid=04b07795-8ddb-461a-bbee-02f9e1bf7b46;oid=06fd46b0-a867-49a1-a4f1-f7768465caba;numgroups=1;iss=https://sts.windows.net/cdffd708-7da0-4cea-abeb-0a4c334d7f64/' does not have keys getrotationpolicy permission on key vault 'turbottest67369;location=eastus'. For help resolving this issue, please see https://go.microsoft.com/fwlink/?linkid=2125287" InnerError={"code":"ForbiddenByPolicy"}

  with azurerm_key_vault_key.named_test_resource,
  on variables.tf line 51, in resource "azurerm_key_vault_key" "named_test_resource":
  51: resource "azurerm_key_vault_key" "named_test_resource" {

Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_compute_disk_encryption_set


Error: current client lacks permissions to read Key Rotation Policy for Key "turbottest67369" ("Vault: (Name \"turbottest67369\" / Resource Group \"turbottest67369\")", Vault url: "https://turbottest67369.vault.azure.net/"), please update this as described here: https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_key#example-usage : keyvault.BaseClient#GetKeyRotationPolicy: Failure responding to request: StatusCode=403 -- Original Error: autorest/azure: Service returned an error. Status=403 Code="Forbidden" Message="The user, group or application 'appid=04b07795-8ddb-461a-bbee-02f9e1bf7b46;oid=06fd46b0-a867-49a1-a4f1-f7768465caba;numgroups=1;iss=https://sts.windows.net/cdffd708-7da0-4cea-abeb-0a4c334d7f64/' does not have keys getrotationpolicy permission on key vault 'turbottest67369;location=eastus'. For help resolving this issue, please see https://go.microsoft.com/fwlink/?linkid=2125287" InnerError={"code":"ForbiddenByPolicy"}

  with azurerm_key_vault_key.named_test_resource,
  on variables.tf line 51, in resource "azurerm_key_vault_key" "named_test_resource":
  51: resource "azurerm_key_vault_key" "named_test_resource" {

SUMMARY:

✘ tests/azure_compute_disk_encryption_set failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_compute_snapshot []

PRETEST: tests/azure_compute_snapshot

TEST: tests/azure_compute_snapshot
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_managed_disk.named_test_resource will be created
  + resource "azurerm_managed_disk" "named_test_resource" {
      + create_option                 = "Empty"
      + disk_iops_read_only           = (known after apply)
      + disk_iops_read_write          = (known after apply)
      + disk_mbps_read_only           = (known after apply)
      + disk_mbps_read_write          = (known after apply)
      + disk_size_gb                  = 10
      + id                            = (known after apply)
      + location                      = "eastus"
      + logical_sector_size           = (known after apply)
      + max_shares                    = (known after apply)
      + name                          = "turbottest92612"
      + public_network_access_enabled = true
      + resource_group_name           = "turbottest92612"
      + source_uri                    = (known after apply)
      + storage_account_type          = "Standard_LRS"
      + tier                          = (known after apply)
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "eastus"
      + name     = "turbottest92612"
    }

  # azurerm_snapshot.named_test_resource will be created
  + resource "azurerm_snapshot" "named_test_resource" {
      + create_option          = "Copy"
      + disk_size_gb           = (known after apply)
      + id                     = (known after apply)
      + location               = "eastus"
      + name                   = "turbottest92612snapshot"
      + resource_group_name    = "turbottest92612"
      + source_uri             = (known after apply)
      + tags                   = {
          + "name" = "turbottest92612"
        }
      + trusted_launch_enabled = (known after apply)
    }

Plan: 3 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + resource_aka        = (known after apply)
  + resource_aka_lower  = (known after apply)
  + resource_id         = (known after apply)
  + resource_name       = "turbottest92612"
  + resource_name_upper = "TURBOTTEST92612"
  + subscription_id     = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 2s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest92612]
azurerm_managed_disk.named_test_resource: Creating...
azurerm_managed_disk.named_test_resource: Creation complete after 8s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest92612/providers/Microsoft.Compute/disks/turbottest92612]
azurerm_snapshot.named_test_resource: Creating...
azurerm_snapshot.named_test_resource: Still creating... [10s elapsed]
azurerm_snapshot.named_test_resource: Still creating... [20s elapsed]
azurerm_snapshot.named_test_resource: Still creating... [30s elapsed]
azurerm_snapshot.named_test_resource: Still creating... [40s elapsed]
azurerm_snapshot.named_test_resource: Creation complete after 50s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest92612/providers/Microsoft.Compute/snapshots/turbottest92612snapshot]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 29, in data "null_data_source" "resource":
  29: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Apply complete! Resources: 3 added, 0 changed, 0 destroyed.

Outputs:

resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest92612/providers/Microsoft.Compute/snapshots/turbottest92612snapshot"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest92612/providers/microsoft.compute/snapshots/turbottest92612snapshot"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest92612/providers/Microsoft.Compute/snapshots/turbottest92612snapshot"
resource_name = "turbottest92612"
resource_name_upper = "TURBOTTEST92612"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "create_option": "Copy",
    "disk_size_bytes": 10737418240,
    "disk_size_gb": 10,
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest92612/providers/Microsoft.Compute/snapshots/turbottest92612snapshot",
    "incremental": false,
    "name": "turbottest92612snapshot",
    "region": "eastus",
    "resource_group": "turbottest92612",
    "sku_name": "Standard_LRS",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "type": "Microsoft.Compute/snapshots"
  }
]
✔ PASSED

Running SQL query: test-hydrate-query.sql
[
  {
    "create_option": "Copy",
    "disk_size_bytes": 10737418240,
    "disk_size_gb": 10,
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest92612/providers/Microsoft.Compute/snapshots/turbottest92612snapshot",
    "incremental": false,
    "name": "turbottest92612snapshot",
    "region": "eastus",
    "resource_group": "turbottest92612",
    "sku_name": "Standard_LRS",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "type": "Microsoft.Compute/snapshots"
  }
]
✔ PASSED

Running SQL query: test-list-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/TURBOTTEST92612/providers/Microsoft.Compute/snapshots/turbottest92612snapshot",
    "name": "turbottest92612snapshot",
    "type": "Microsoft.Compute/snapshots"
  }
]
✔ PASSED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest92612/providers/Microsoft.Compute/snapshots/turbottest92612snapshot",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest92612/providers/microsoft.compute/snapshots/turbottest92612snapshot"
    ],
    "name": "turbottest92612snapshot",
    "tags": {
      "name": "turbottest92612"
    },
    "title": "turbottest92612snapshot"
  }
]
✔ PASSED

POSTTEST: tests/azure_compute_snapshot

TEARDOWN: tests/azure_compute_snapshot

SUMMARY:

1/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_cosmosdb_account []

PRETEST: tests/azure_cosmosdb_account

TEST: tests/azure_cosmosdb_account
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_cosmosdb_account.named_test_resource will be created
  + resource "azurerm_cosmosdb_account" "named_test_resource" {
      + access_key_metadata_writes_enabled       = true
      + analytical_storage_enabled               = false
      + connection_strings                       = (sensitive value)
      + create_mode                              = (known after apply)
      + default_identity_type                    = (known after apply)
      + enable_automatic_failover                = true
      + enable_free_tier                         = false
      + enable_multiple_write_locations          = false
      + endpoint                                 = (known after apply)
      + id                                       = (known after apply)
      + is_virtual_network_filter_enabled        = false
      + kind                                     = "GlobalDocumentDB"
      + local_authentication_disabled            = false
      + location                                 = "eastus"
      + mongo_server_version                     = (known after apply)
      + name                                     = "turbottest79612"
      + network_acl_bypass_for_azure_services    = false
      + offer_type                               = "Standard"
      + primary_key                              = (sensitive value)
      + primary_readonly_key                     = (sensitive value)
      + primary_readonly_sql_connection_string   = (sensitive value)
      + primary_sql_connection_string            = (sensitive value)
      + public_network_access_enabled            = true
      + read_endpoints                           = (known after apply)
      + resource_group_name                      = "turbottest79612"
      + secondary_key                            = (sensitive value)
      + secondary_readonly_key                   = (sensitive value)
      + secondary_readonly_sql_connection_string = (sensitive value)
      + secondary_sql_connection_string          = (sensitive value)
      + tags                                     = {
          + "name" = "turbottest79612"
        }
      + write_endpoints                          = (known after apply)

      + analytical_storage {
          + schema_type = (known after apply)
        }

      + backup {
          + interval_in_minutes = (known after apply)
          + retention_in_hours  = (known after apply)
          + storage_redundancy  = (known after apply)
          + type                = (known after apply)
        }

      + capabilities {
          + name = (known after apply)
        }

      + capacity {
          + total_throughput_limit = (known after apply)
        }

      + consistency_policy {
          + consistency_level       = "BoundedStaleness"
          + max_interval_in_seconds = 600
          + max_staleness_prefix    = 200000
        }

      + geo_location {
          + failover_priority = 0
          + id                = (known after apply)
          + location          = "eastus"
          + zone_redundant    = false
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "eastus"
      + name     = "turbottest79612"
    }

Plan: 2 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest79612"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 3s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest79612]
azurerm_cosmosdb_account.named_test_resource: Creating...
azurerm_cosmosdb_account.named_test_resource: Still creating... [10s elapsed]
azurerm_cosmosdb_account.named_test_resource: Still creating... [20s elapsed]
azurerm_cosmosdb_account.named_test_resource: Still creating... [30s elapsed]
azurerm_cosmosdb_account.named_test_resource: Still creating... [40s elapsed]
azurerm_cosmosdb_account.named_test_resource: Still creating... [50s elapsed]
azurerm_cosmosdb_account.named_test_resource: Still creating... [1m0s elapsed]
azurerm_cosmosdb_account.named_test_resource: Still creating... [1m10s elapsed]
azurerm_cosmosdb_account.named_test_resource: Still creating... [1m20s elapsed]
azurerm_cosmosdb_account.named_test_resource: Still creating... [1m30s elapsed]
azurerm_cosmosdb_account.named_test_resource: Still creating... [1m40s elapsed]
azurerm_cosmosdb_account.named_test_resource: Still creating... [1m50s elapsed]
azurerm_cosmosdb_account.named_test_resource: Still creating... [2m0s elapsed]
azurerm_cosmosdb_account.named_test_resource: Still creating... [2m10s elapsed]
azurerm_cosmosdb_account.named_test_resource: Still creating... [2m20s elapsed]
azurerm_cosmosdb_account.named_test_resource: Creation complete after 2m22s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest79612/providers/Microsoft.DocumentDB/databaseAccounts/turbottest79612]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 29, in data "null_data_source" "resource":
  29: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Apply complete! Resources: 2 added, 0 changed, 0 destroyed.

Outputs:

resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest79612/providers/Microsoft.DocumentDB/databaseAccounts/turbottest79612"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest79612/providers/microsoft.documentdb/databaseaccounts/turbottest79612"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest79612/providers/Microsoft.DocumentDB/databaseAccounts/turbottest79612"
resource_name = "turbottest79612"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "consistency_policy_max_interval": 600,
    "consistency_policy_max_staleness_prefix": 200000,
    "database_account_offer_type": "Standard",
    "default_consistency_level": "BoundedStaleness",
    "disable_key_based_metadata_write_access": false,
    "document_endpoint": "https://turbottest79612.documents.azure.com:443/",
    "enable_automatic_failover": true,
    "enable_multiple_write_locations": false,
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest79612/providers/Microsoft.DocumentDB/databaseAccounts/turbottest79612",
    "is_virtual_network_filter_enabled": false,
    "kind": "GlobalDocumentDB",
    "name": "turbottest79612",
    "region": "east us",
    "resource_group": "turbottest79612",
    "type": "Microsoft.DocumentDB/databaseAccounts"
  }
]
✔ PASSED

Running SQL query: test-hydrate-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest79612/providers/Microsoft.DocumentDB/databaseAccounts/turbottest79612",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest79612/providers/microsoft.documentdb/databaseaccounts/turbottest79612"
    ],
    "name": "turbottest79612",
    "tags": {
      "name": "turbottest79612"
    },
    "title": "turbottest79612"
  }
]
✔ PASSED

Running SQL query: test-list-query.sql
null
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest79612/providers/Microsoft.DocumentDB/databaseAccounts/turbottest79612",
    "name": "turbottest79612"
  }
]

✘ FAILED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest79612/providers/Microsoft.DocumentDB/databaseAccounts/turbottest79612",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest79612/providers/microsoft.documentdb/databaseaccounts/turbottest79612"
    ],
    "name": "turbottest79612",
    "tags": {
      "name": "turbottest79612"
    },
    "title": "turbottest79612"
  }
]
✔ PASSED

TEARDOWN: tests/azure_cosmosdb_account

SUMMARY:

✘ tests/azure_cosmosdb_account failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_cosmosdb_mongo_database []

PRETEST: tests/azure_cosmosdb_mongo_database

TEST: tests/azure_cosmosdb_mongo_database
Running terraform

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 29, in data "null_data_source" "resource":
  29: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

Error: Unsupported argument

  on variables.tf line 53, in resource "azurerm_cosmosdb_account" "named_test_resource":
  53:     prefix = "turbot-cosmos-db"

An argument named "prefix" is not expected here.
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_cosmosdb_mongo_database


Error: Unsupported argument

  on variables.tf line 53, in resource "azurerm_cosmosdb_account" "named_test_resource":
  53:     prefix = "turbot-cosmos-db"

An argument named "prefix" is not expected here.
SUMMARY:

✘ tests/azure_cosmosdb_mongo_database failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_cosmosdb_sql_database []

PRETEST: tests/azure_cosmosdb_sql_database

TEST: tests/azure_cosmosdb_sql_database
Running terraform

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 29, in data "null_data_source" "resource":
  29: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

Error: Unsupported argument

  on variables.tf line 55, in resource "azurerm_cosmosdb_account" "named_test_resource":
  55:     prefix = "turbot-cosmos-db"

An argument named "prefix" is not expected here.
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_cosmosdb_sql_database


Error: Unsupported argument

  on variables.tf line 55, in resource "azurerm_cosmosdb_account" "named_test_resource":
  55:     prefix = "turbot-cosmos-db"

An argument named "prefix" is not expected here.
SUMMARY:

✘ tests/azure_cosmosdb_sql_database failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_data_factory []

PRETEST: tests/azure_data_factory

TEST: tests/azure_data_factory
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_data_factory.named_test_resource will be created
  + resource "azurerm_data_factory" "named_test_resource" {
      + id                     = (known after apply)
      + location               = "eastus"
      + name                   = "turbottest78956"
      + public_network_enabled = true
      + resource_group_name    = "turbottest78956"
      + tags                   = {
          + "name" = "turbottest78956"
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "eastus"
      + name     = "turbottest78956"
    }

Plan: 2 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + location           = "eastus"
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest78956"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 3s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest78956]
azurerm_data_factory.named_test_resource: Creating...
azurerm_data_factory.named_test_resource: Creation complete after 8s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest78956/providers/Microsoft.DataFactory/factories/turbottest78956]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 29, in data "null_data_source" "resource":
  29: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Apply complete! Resources: 2 added, 0 changed, 0 destroyed.

Outputs:

location = "eastus"
resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest78956/providers/Microsoft.DataFactory/factories/turbottest78956"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest78956/providers/microsoft.datafactory/factories/turbottest78956"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest78956/providers/Microsoft.DataFactory/factories/turbottest78956"
resource_name = "turbottest78956"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest78956/providers/Microsoft.DataFactory/factories/turbottest78956",
    "name": "turbottest78956",
    "region": "eastus",
    "resource_group": "turbottest78956",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "tags": {
      "name": "turbottest78956"
    },
    "type": "Microsoft.DataFactory/factories"
  }
]
✔ PASSED

Running SQL query: test-list-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest78956/providers/Microsoft.DataFactory/factories/turbottest78956",
    "name": "turbottest78956",
    "type": "Microsoft.DataFactory/factories"
  }
]
✔ PASSED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest78956/providers/Microsoft.DataFactory/factories/turbottest78956",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest78956/providers/microsoft.datafactory/factories/turbottest78956"
    ],
    "name": "turbottest78956",
    "tags": {
      "name": "turbottest78956"
    },
    "title": "turbottest78956"
  }
]
✔ PASSED

POSTTEST: tests/azure_data_factory

TEARDOWN: tests/azure_data_factory

SUMMARY:

1/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_data_lake_analytics_account []

PRETEST: tests/azure_data_lake_analytics_account

TEST: tests/azure_data_lake_analytics_account
Running terraform

Warning: Version constraints inside provider configuration blocks are deprecated

  on variables.tf line 21, in provider "azurerm":
  21:   version         = "=1.36.0"

Terraform 0.13 and earlier allowed provider version constraints inside the
provider configuration block, but that is now deprecated and will be removed
in a future version of Terraform. To silence this warning, move the provider
version constraint into the required_providers block.

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 28, in data "null_data_source" "resource":
  28: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

Error: Error building AzureRM Client: Error populating Client ID from the Azure CLI: No Authorization Tokens were found - please ensure the Azure CLI is installed and then log-in with `az login`.

  with provider["registry.terraform.io/hashicorp/azurerm"],
  on variables.tf line 19, in provider "azurerm":
  19: provider "azurerm" {

Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_data_lake_analytics_account


Error: Error building AzureRM Client: Error populating Client ID from the Azure CLI: No Authorization Tokens were found - please ensure the Azure CLI is installed and then log-in with `az login`.

  with provider["registry.terraform.io/hashicorp/azurerm"],
  on variables.tf line 19, in provider "azurerm":
  19: provider "azurerm" {

SUMMARY:

✘ tests/azure_data_lake_analytics_account failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_data_lake_store []

PRETEST: tests/azure_data_lake_store

TEST: tests/azure_data_lake_store
Running terraform

Warning: Version constraints inside provider configuration blocks are deprecated

  on variables.tf line 21, in provider "azurerm":
  21:   version         = "=1.36.0"

Terraform 0.13 and earlier allowed provider version constraints inside the
provider configuration block, but that is now deprecated and will be removed
in a future version of Terraform. To silence this warning, move the provider
version constraint into the required_providers block.

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 28, in data "null_data_source" "resource":
  28: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

Error: Error building AzureRM Client: Error populating Client ID from the Azure CLI: No Authorization Tokens were found - please ensure the Azure CLI is installed and then log-in with `az login`.

  with provider["registry.terraform.io/hashicorp/azurerm"],
  on variables.tf line 19, in provider "azurerm":
  19: provider "azurerm" {

Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_data_lake_store


Error: Error building AzureRM Client: Error populating Client ID from the Azure CLI: No Authorization Tokens were found - please ensure the Azure CLI is installed and then log-in with `az login`.

  with provider["registry.terraform.io/hashicorp/azurerm"],
  on variables.tf line 19, in provider "azurerm":
  19: provider "azurerm" {

SUMMARY:

✘ tests/azure_data_lake_store failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_eventgrid_domain []

PRETEST: tests/azure_eventgrid_domain

TEST: tests/azure_eventgrid_domain
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_eventgrid_domain.named_test_resource will be created
  + resource "azurerm_eventgrid_domain" "named_test_resource" {
      + auto_create_topic_with_first_subscription = true
      + auto_delete_topic_with_last_subscription  = true
      + endpoint                                  = (known after apply)
      + id                                        = (known after apply)
      + input_schema                              = "EventGridSchema"
      + local_auth_enabled                        = true
      + location                                  = "westus"
      + name                                      = "turbottest57828"
      + primary_access_key                        = (sensitive value)
      + public_network_access_enabled             = true
      + resource_group_name                       = "turbottest57828"
      + secondary_access_key                      = (sensitive value)
      + tags                                      = {
          + "environment" = "Production"
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "westus"
      + name     = "turbottest57828"
    }

Plan: 2 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest57828"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 6s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest57828]
azurerm_eventgrid_domain.named_test_resource: Creating...
azurerm_eventgrid_domain.named_test_resource: Still creating... [10s elapsed]
azurerm_eventgrid_domain.named_test_resource: Still creating... [20s elapsed]
azurerm_eventgrid_domain.named_test_resource: Creation complete after 24s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest57828/providers/Microsoft.EventGrid/domains/turbottest57828]

Warning: Deprecated

  with data.null_data_source.resource,
  on variable.tf line 27, in data "null_data_source" "resource":
  27: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Apply complete! Resources: 2 added, 0 changed, 0 destroyed.

Outputs:

resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest57828/providers/Microsoft.EventGrid/domains/turbottest57828"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest57828/providers/microsoft.eventgrid/domains/turbottest57828"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest57828/providers/Microsoft.EventGrid/domains/turbottest57828"
resource_name = "turbottest57828"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest57828/providers/Microsoft.EventGrid/domains/turbottest57828",
    "name": "turbottest57828",
    "type": "Microsoft.EventGrid/domains"
  }
]
✔ PASSED

Running SQL query: test-hydrate-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest57828/providers/Microsoft.EventGrid/domains/turbottest57828",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest57828/providers/microsoft.eventgrid/domains/turbottest57828"
    ],
    "name": "turbottest57828",
    "title": "turbottest57828"
  }
]
✔ PASSED

Running SQL query: test-list-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest57828/providers/Microsoft.EventGrid/domains/turbottest57828",
    "name": "turbottest57828"
  }
]
✔ PASSED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest57828/providers/Microsoft.EventGrid/domains/turbottest57828",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest57828/providers/microsoft.eventgrid/domains/turbottest57828"
    ],
    "name": "turbottest57828",
    "title": "turbottest57828"
  }
]
✔ PASSED

POSTTEST: tests/azure_eventgrid_domain

TEARDOWN: tests/azure_eventgrid_domain

SUMMARY:

1/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_eventgrid_topic []

PRETEST: tests/azure_eventgrid_topic

TEST: tests/azure_eventgrid_topic
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_eventgrid_topic.named_test_resource will be created
  + resource "azurerm_eventgrid_topic" "named_test_resource" {
      + endpoint                      = (known after apply)
      + id                            = (known after apply)
      + input_schema                  = "EventGridSchema"
      + local_auth_enabled            = true
      + location                      = "westus"
      + name                          = "turbottest75779"
      + primary_access_key            = (sensitive value)
      + public_network_access_enabled = true
      + resource_group_name           = "turbottest75779"
      + secondary_access_key          = (sensitive value)
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "westus"
      + name     = "turbottest75779"
    }

Plan: 2 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest75779"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 4s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest75779]
azurerm_eventgrid_topic.named_test_resource: Creating...
azurerm_eventgrid_topic.named_test_resource: Still creating... [10s elapsed]
azurerm_eventgrid_topic.named_test_resource: Still creating... [20s elapsed]
azurerm_eventgrid_topic.named_test_resource: Creation complete after 22s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest75779/providers/Microsoft.EventGrid/topics/turbottest75779]

Warning: Deprecated

  with data.null_data_source.resource,
  on variable.tf line 27, in data "null_data_source" "resource":
  27: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Apply complete! Resources: 2 added, 0 changed, 0 destroyed.

Outputs:

resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest75779/providers/Microsoft.EventGrid/topics/turbottest75779"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest75779/providers/microsoft.eventgrid/topics/turbottest75779"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest75779/providers/Microsoft.EventGrid/topics/turbottest75779"
resource_name = "turbottest75779"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest75779/providers/Microsoft.EventGrid/topics/turbottest75779",
    "name": "turbottest75779",
    "type": "Microsoft.EventGrid/topics"
  }
]
✔ PASSED

Running SQL query: test-list-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest75779/providers/Microsoft.EventGrid/topics/turbottest75779",
    "name": "turbottest75779"
  }
]
✔ PASSED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
null
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest75779/providers/Microsoft.EventGrid/topics/turbottest75779",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest75779/providers/microsoft.eventgrid/topics/turbottest75779"
    ],
    "name": "turbottest75779",
    "title": "turbottest75779"
  }
]

✘ FAILED

TEARDOWN: tests/azure_eventgrid_topic

SUMMARY:

✘ tests/azure_eventgrid_topic failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_firewall []

PRETEST: tests/azure_firewall

TEST: tests/azure_firewall
Running terraform

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 29, in data "null_data_source" "resource":
  29: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

Error: Missing required argument

  on variables.tf line 62, in resource "azurerm_firewall" "named_test_resource":
  62: resource "azurerm_firewall" "named_test_resource" {

The argument "sku_name" is required, but no definition was found.
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_firewall


Error: Missing required argument

  on variables.tf line 62, in resource "azurerm_firewall" "named_test_resource":
  62: resource "azurerm_firewall" "named_test_resource" {

The argument "sku_name" is required, but no definition was found.
SUMMARY:

✘ tests/azure_firewall failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_hpc_cache []

PRETEST: tests/azure_hpc_cache

TEST: tests/azure_hpc_cache
Running terraform

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_hpc_cache.named_test_resource will be created
  + resource "azurerm_hpc_cache" "named_test_resource" {
      + cache_size_in_gb    = 3072
      + id                  = (known after apply)
      + location            = "westeurope"
      + mount_addresses     = (known after apply)
      + mtu                 = 1500
      + name                = "turbottest11832"
      + ntp_server          = "time.windows.com"
      + resource_group_name = "turbottest11832"
      + root_squash_enabled = (known after apply)
      + sku_name            = "Standard_2G"
      + subnet_id           = (known after apply)

      + default_access_policy {
          + access_rule {
              + access                  = (known after apply)
              + anonymous_gid           = (known after apply)
              + anonymous_uid           = (known after apply)
              + filter                  = (known after apply)
              + root_squash_enabled     = (known after apply)
              + scope                   = (known after apply)
              + submount_access_enabled = (known after apply)
              + suid_enabled            = (known after apply)
            }
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "westeurope"
      + name     = "turbottest11832"
    }

  # azurerm_subnet.named_test_resource will be created
  + resource "azurerm_subnet" "named_test_resource" {
      + address_prefix                                 = (known after apply)
      + address_prefixes                               = [
          + "10.0.1.0/24",
        ]
      + enforce_private_link_endpoint_network_policies = false
      + enforce_private_link_service_network_policies  = false
      + id                                             = (known after apply)
      + name                                           = "turbottest11832"
      + resource_group_name                            = "turbottest11832"
      + virtual_network_name                           = "turbottest11832"
    }

  # azurerm_virtual_network.named_test_resource will be created
  + resource "azurerm_virtual_network" "named_test_resource" {
      + address_space         = [
          + "10.0.0.0/16",
        ]
      + dns_servers           = (known after apply)
      + guid                  = (known after apply)
      + id                    = (known after apply)
      + location              = "westeurope"
      + name                  = "turbottest11832"
      + resource_group_name   = "turbottest11832"
      + subnet                = (known after apply)
      + vm_protection_enabled = false
    }

Plan: 4 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + region             = "westeurope"
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_id_upper  = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/TURBOTTEST11832/providers/Microsoft.StorageCache/caches/turbottest11832"
  + resource_name      = "turbottest11832"
  + sku_name           = "Standard_2G"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 3s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest11832]
azurerm_virtual_network.named_test_resource: Creating...
azurerm_virtual_network.named_test_resource: Creation complete after 10s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest11832/providers/Microsoft.Network/virtualNetworks/turbottest11832]
azurerm_subnet.named_test_resource: Creating...
azurerm_subnet.named_test_resource: Creation complete after 7s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest11832/providers/Microsoft.Network/virtualNetworks/turbottest11832/subnets/turbottest11832]
azurerm_hpc_cache.named_test_resource: Creating...
azurerm_hpc_cache.named_test_resource: Still creating... [10s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [20s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [30s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [40s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [50s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [1m0s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [1m10s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [1m20s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [1m30s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [1m40s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [1m50s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [2m0s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [2m10s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [2m20s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [2m30s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [2m40s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [2m50s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [3m0s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [3m10s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [3m20s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [3m30s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [3m40s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [3m50s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [4m0s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [4m10s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [4m20s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [4m30s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [4m40s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [4m50s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [5m0s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [5m10s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [5m20s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [5m30s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [5m40s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [5m50s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [6m0s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [6m10s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [6m20s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [6m30s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [6m40s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [6m50s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [7m0s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [7m10s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [7m20s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [7m30s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [7m40s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [7m50s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [8m0s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [8m10s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [8m20s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [8m30s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [8m40s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [8m50s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [9m0s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [9m10s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [9m20s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [9m30s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [9m40s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [9m50s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [10m0s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [10m10s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [10m20s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [10m30s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [10m40s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [10m50s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [11m0s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [11m10s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [11m20s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [11m30s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [11m40s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [11m50s elapsed]
azurerm_hpc_cache.named_test_resource: Still creating... [12m0s elapsed]
azurerm_hpc_cache.named_test_resource: Creation complete after 12m2s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest11832/providers/Microsoft.StorageCache/caches/turbottest11832]

Apply complete! Resources: 4 added, 0 changed, 0 destroyed.

Outputs:

region = "westeurope"
resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest11832/providers/Microsoft.StorageCache/caches/turbottest11832"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest11832/providers/microsoft.storagecache/caches/turbottest11832"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest11832/providers/Microsoft.StorageCache/caches/turbottest11832"
resource_id_upper = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/TURBOTTEST11832/providers/Microsoft.StorageCache/caches/turbottest11832"
resource_name = "turbottest11832"
sku_name = "Standard_2G"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest11832/providers/Microsoft.StorageCache/caches/turbottest11832",
    "name": "turbottest11832",
    "region": "westeurope",
    "resource_group": "turbottest11832",
    "sku_name": "Standard_2G",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "type": "Microsoft.StorageCache/caches"
  }
]
✔ PASSED

Running SQL query: test-list-query.sql
null
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/TURBOTTEST11832/providers/Microsoft.StorageCache/caches/turbottest11832",
    "name": "turbottest11832",
    "region": "westeurope",
    "resource_group": "turbottest11832",
    "sku_name": "Standard_2G",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "type": "Microsoft.StorageCache/caches"
  }
]

✘ FAILED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest11832/providers/Microsoft.StorageCache/caches/turbottest11832",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest11832/providers/microsoft.storagecache/caches/turbottest11832"
    ],
    "name": "turbottest11832",
    "title": "turbottest11832"
  }
]
✔ PASSED

TEARDOWN: tests/azure_hpc_cache

SUMMARY:

✘ tests/azure_hpc_cache failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_iothub []

PRETEST: tests/azure_iothub

TEST: tests/azure_iothub
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_eventhub.named_test_resource will be created
  + resource "azurerm_eventhub" "named_test_resource" {
      + id                  = (known after apply)
      + message_retention   = 1
      + name                = "turbottest4572"
      + namespace_name      = "turbottest4572"
      + partition_count     = 2
      + partition_ids       = (known after apply)
      + resource_group_name = "turbottest4572"
      + status              = "Active"
    }

  # azurerm_eventhub_authorization_rule.named_test_resource will be created
  + resource "azurerm_eventhub_authorization_rule" "named_test_resource" {
      + eventhub_name                     = "turbottest4572"
      + id                                = (known after apply)
      + listen                            = false
      + manage                            = false
      + name                              = "turbottest4572"
      + namespace_name                    = "turbottest4572"
      + primary_connection_string         = (sensitive value)
      + primary_connection_string_alias   = (sensitive value)
      + primary_key                       = (sensitive value)
      + resource_group_name               = "turbottest4572"
      + secondary_connection_string       = (sensitive value)
      + secondary_connection_string_alias = (sensitive value)
      + secondary_key                     = (sensitive value)
      + send                              = true
    }

  # azurerm_eventhub_namespace.named_test_resource will be created
  + resource "azurerm_eventhub_namespace" "named_test_resource" {
      + auto_inflate_enabled                      = false
      + capacity                                  = 1
      + default_primary_connection_string         = (sensitive value)
      + default_primary_connection_string_alias   = (sensitive value)
      + default_primary_key                       = (sensitive value)
      + default_secondary_connection_string       = (sensitive value)
      + default_secondary_connection_string_alias = (sensitive value)
      + default_secondary_key                     = (sensitive value)
      + id                                        = (known after apply)
      + local_authentication_enabled              = true
      + location                                  = "eastus"
      + maximum_throughput_units                  = (known after apply)
      + minimum_tls_version                       = (known after apply)
      + name                                      = "turbottest4572"
      + network_rulesets                          = (known after apply)
      + public_network_access_enabled             = true
      + resource_group_name                       = "turbottest4572"
      + sku                                       = "Basic"
      + zone_redundant                            = false
    }

  # azurerm_iothub.named_test_resource will be created
  + resource "azurerm_iothub" "named_test_resource" {
      + endpoint                      = [
          + {
              + authentication_type        = "keyBased"
              + batch_frequency_in_seconds = 60
              + connection_string          = (sensitive)
              + container_name             = "turbottest4572"
              + encoding                   = "Avro"
              + endpoint_uri               = null
              + entity_path                = null
              + file_name_format           = "{iothub}/{partition}_{YYYY}_{MM}_{DD}_{HH}_{mm}"
              + identity_id                = null
              + max_chunk_size_in_bytes    = 10485760
              + name                       = "export"
              + resource_group_name        = null
              + type                       = "AzureIotHub.StorageContainer"
            },
          + {
              + authentication_type        = "keyBased"
              + batch_frequency_in_seconds = null
              + connection_string          = (sensitive)
              + container_name             = null
              + encoding                   = null
              + endpoint_uri               = null
              + entity_path                = null
              + file_name_format           = null
              + identity_id                = null
              + max_chunk_size_in_bytes    = null
              + name                       = "export2"
              + resource_group_name        = null
              + type                       = "AzureIotHub.EventHub"
            },
        ]
      + enrichment                    = (known after apply)
      + event_hub_events_endpoint     = (known after apply)
      + event_hub_events_namespace    = (known after apply)
      + event_hub_events_path         = (known after apply)
      + event_hub_operations_endpoint = (known after apply)
      + event_hub_operations_path     = (known after apply)
      + event_hub_partition_count     = (known after apply)
      + event_hub_retention_in_days   = (known after apply)
      + hostname                      = (known after apply)
      + id                            = (known after apply)
      + location                      = "eastus"
      + name                          = "turbottest4572"
      + resource_group_name           = "turbottest4572"
      + route                         = [
          + {
              + condition      = "true"
              + enabled        = true
              + endpoint_names = [
                  + "export",
                ]
              + name           = "export"
              + source         = "DeviceMessages"
            },
          + {
              + condition      = "true"
              + enabled        = true
              + endpoint_names = [
                  + "export2",
                ]
              + name           = "export2"
              + source         = "DeviceMessages"
            },
        ]
      + shared_access_policy          = (known after apply)
      + type                          = (known after apply)

      + cloud_to_device {
          + default_ttl        = (known after apply)
          + max_delivery_count = (known after apply)

          + feedback {
              + lock_duration      = (known after apply)
              + max_delivery_count = (known after apply)
              + time_to_live       = (known after apply)
            }
        }

      + fallback_route {
          + condition      = (known after apply)
          + enabled        = (known after apply)
          + endpoint_names = (known after apply)
          + source         = (known after apply)
        }

      + sku {
          + capacity = 1
          + name     = "S1"
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "eastus"
      + name     = "turbottest4572"
    }

  # azurerm_storage_account.named_test_resource will be created
  + resource "azurerm_storage_account" "named_test_resource" {
      + access_tier                       = (known after apply)
      + account_kind                      = "StorageV2"
      + account_replication_type          = "LRS"
      + account_tier                      = "Standard"
      + allow_nested_items_to_be_public   = true
      + cross_tenant_replication_enabled  = true
      + default_to_oauth_authentication   = false
      + enable_https_traffic_only         = true
      + id                                = (known after apply)
      + infrastructure_encryption_enabled = false
      + is_hns_enabled                    = false
      + large_file_share_enabled          = (known after apply)
      + location                          = "eastus"
      + min_tls_version                   = "TLS1_2"
      + name                              = "turbottest4572"
      + nfsv3_enabled                     = false
      + primary_access_key                = (sensitive value)
      + primary_blob_connection_string    = (sensitive value)
      + primary_blob_endpoint             = (known after apply)
      + primary_blob_host                 = (known after apply)
      + primary_connection_string         = (sensitive value)
      + primary_dfs_endpoint              = (known after apply)
      + primary_dfs_host                  = (known after apply)
      + primary_file_endpoint             = (known after apply)
      + primary_file_host                 = (known after apply)
      + primary_location                  = (known after apply)
      + primary_queue_endpoint            = (known after apply)
      + primary_queue_host                = (known after apply)
      + primary_table_endpoint            = (known after apply)
      + primary_table_host                = (known after apply)
      + primary_web_endpoint              = (known after apply)
      + primary_web_host                  = (known after apply)
      + public_network_access_enabled     = true
      + queue_encryption_key_type         = "Service"
      + resource_group_name               = "turbottest4572"
      + secondary_access_key              = (sensitive value)
      + secondary_blob_connection_string  = (sensitive value)
      + secondary_blob_endpoint           = (known after apply)
      + secondary_blob_host               = (known after apply)
      + secondary_connection_string       = (sensitive value)
      + secondary_dfs_endpoint            = (known after apply)
      + secondary_dfs_host                = (known after apply)
      + secondary_file_endpoint           = (known after apply)
      + secondary_file_host               = (known after apply)
      + secondary_location                = (known after apply)
      + secondary_queue_endpoint          = (known after apply)
      + secondary_queue_host              = (known after apply)
      + secondary_table_endpoint          = (known after apply)
      + secondary_table_host              = (known after apply)
      + secondary_web_endpoint            = (known after apply)
      + secondary_web_host                = (known after apply)
      + sftp_enabled                      = false
      + shared_access_key_enabled         = true
      + table_encryption_key_type         = "Service"

      + blob_properties {
          + change_feed_enabled           = (known after apply)
          + change_feed_retention_in_days = (known after apply)
          + default_service_version       = (known after apply)
          + last_access_time_enabled      = (known after apply)
          + versioning_enabled            = (known after apply)

          + container_delete_retention_policy {
              + days = (known after apply)
            }

          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + delete_retention_policy {
              + days = (known after apply)
            }

          + restore_policy {
              + days = (known after apply)
            }
        }

      + network_rules {
          + bypass                     = (known after apply)
          + default_action             = (known after apply)
          + ip_rules                   = (known after apply)
          + virtual_network_subnet_ids = (known after apply)

          + private_link_access {
              + endpoint_resource_id = (known after apply)
              + endpoint_tenant_id   = (known after apply)
            }
        }

      + queue_properties {
          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + hour_metrics {
              + enabled               = (known after apply)
              + include_apis          = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
            }

          + logging {
              + delete                = (known after apply)
              + read                  = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
              + write                 = (known after apply)
            }

          + minute_metrics {
              + enabled               = (known after apply)
              + include_apis          = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
            }
        }

      + routing {
          + choice                      = (known after apply)
          + publish_internet_endpoints  = (known after apply)
          + publish_microsoft_endpoints = (known after apply)
        }

      + share_properties {
          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + retention_policy {
              + days = (known after apply)
            }

          + smb {
              + authentication_types            = (known after apply)
              + channel_encryption_type         = (known after apply)
              + kerberos_ticket_encryption_type = (known after apply)
              + multichannel_enabled            = (known after apply)
              + versions                        = (known after apply)
            }
        }
    }

  # azurerm_storage_container.named_test_resource will be created
  + resource "azurerm_storage_container" "named_test_resource" {
      + container_access_type   = "private"
      + has_immutability_policy = (known after apply)
      + has_legal_hold          = (known after apply)
      + id                      = (known after apply)
      + metadata                = (known after apply)
      + name                    = "turbottest4572"
      + resource_manager_id     = (known after apply)
      + storage_account_name    = "turbottest4572"
    }

Plan: 7 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + location           = "eastus"
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest4572"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 2s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest4572]
azurerm_eventhub_namespace.named_test_resource: Creating...
azurerm_storage_account.named_test_resource: Creating...
azurerm_eventhub_namespace.named_test_resource: Still creating... [10s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [10s elapsed]
azurerm_eventhub_namespace.named_test_resource: Still creating... [20s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [20s elapsed]
azurerm_eventhub_namespace.named_test_resource: Still creating... [30s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [30s elapsed]
azurerm_storage_account.named_test_resource: Creation complete after 31s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest4572/providers/Microsoft.Storage/storageAccounts/turbottest4572]
azurerm_storage_container.named_test_resource: Creating...
azurerm_storage_container.named_test_resource: Creation complete after 1s [id=https://turbottest4572.blob.core.windows.net/turbottest4572]
azurerm_eventhub_namespace.named_test_resource: Still creating... [40s elapsed]
azurerm_eventhub_namespace.named_test_resource: Still creating... [50s elapsed]
azurerm_eventhub_namespace.named_test_resource: Still creating... [1m0s elapsed]
azurerm_eventhub_namespace.named_test_resource: Still creating... [1m10s elapsed]
azurerm_eventhub_namespace.named_test_resource: Creation complete after 1m16s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest4572/providers/Microsoft.EventHub/namespaces/turbottest4572]
azurerm_eventhub.named_test_resource: Creating...
azurerm_eventhub.named_test_resource: Creation complete after 8s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest4572/providers/Microsoft.EventHub/namespaces/turbottest4572/eventhubs/turbottest4572]
azurerm_eventhub_authorization_rule.named_test_resource: Creating...
azurerm_eventhub_authorization_rule.named_test_resource: Still creating... [10s elapsed]
azurerm_eventhub_authorization_rule.named_test_resource: Creation complete after 10s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest4572/providers/Microsoft.EventHub/namespaces/turbottest4572/eventhubs/turbottest4572/authorizationRules/turbottest4572]
azurerm_iothub.named_test_resource: Creating...
azurerm_iothub.named_test_resource: Still creating... [10s elapsed]
azurerm_iothub.named_test_resource: Still creating... [20s elapsed]
azurerm_iothub.named_test_resource: Still creating... [30s elapsed]
azurerm_iothub.named_test_resource: Still creating... [40s elapsed]
azurerm_iothub.named_test_resource: Still creating... [50s elapsed]
azurerm_iothub.named_test_resource: Still creating... [1m0s elapsed]
azurerm_iothub.named_test_resource: Still creating... [1m10s elapsed]
azurerm_iothub.named_test_resource: Still creating... [1m21s elapsed]
azurerm_iothub.named_test_resource: Still creating... [1m31s elapsed]
azurerm_iothub.named_test_resource: Still creating... [1m41s elapsed]
azurerm_iothub.named_test_resource: Still creating... [1m51s elapsed]
azurerm_iothub.named_test_resource: Still creating... [2m1s elapsed]
azurerm_iothub.named_test_resource: Still creating... [2m11s elapsed]
azurerm_iothub.named_test_resource: Still creating... [2m21s elapsed]
azurerm_iothub.named_test_resource: Still creating... [2m31s elapsed]
azurerm_iothub.named_test_resource: Still creating... [2m41s elapsed]
azurerm_iothub.named_test_resource: Still creating... [2m51s elapsed]
azurerm_iothub.named_test_resource: Still creating... [3m1s elapsed]
azurerm_iothub.named_test_resource: Still creating... [3m11s elapsed]
azurerm_iothub.named_test_resource: Still creating... [3m21s elapsed]
azurerm_iothub.named_test_resource: Creation complete after 3m22s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest4572/providers/Microsoft.Devices/iotHubs/turbottest4572]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 28, in data "null_data_source" "resource":
  28: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Apply complete! Resources: 7 added, 0 changed, 0 destroyed.

Outputs:

location = "eastus"
resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest4572/providers/Microsoft.Devices/iotHubs/turbottest4572"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest4572/providers/microsoft.devices/iothubs/turbottest4572"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest4572/providers/Microsoft.Devices/iotHubs/turbottest4572"
resource_name = "turbottest4572"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest4572/providers/Microsoft.Devices/IotHubs/turbottest4572",
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest4572/providers/Microsoft.Devices/iotHubs/turbottest4572",
    "name": "turbottest4572",
    "region": "eastus",
    "resource_group": "turbottest4572",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "type": "Microsoft.Devices/IotHubs"
  }
]

✘ FAILED

Running SQL query: test-list-query.sql
null
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest4572/providers/Microsoft.Devices/iotHubs/turbottest4572",
    "name": "turbottest4572",
    "type": "Microsoft.Devices/IotHubs"
  }
]

✘ FAILED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest4572/providers/Microsoft.Devices/IotHubs/turbottest4572",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest4572/providers/Microsoft.Devices/iotHubs/turbottest4572",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest4572/providers/microsoft.devices/iothubs/turbottest4572"
    ],
    "name": "turbottest4572",
    "title": "turbottest4572"
  }
]

✘ FAILED

TEARDOWN: tests/azure_iothub

SUMMARY:

✘ tests/azure_iothub failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_key_vault_deleted_vault []

PRETEST: tests/azure_key_vault_deleted_vault

TEST: tests/azure_key_vault_deleted_vault
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create
 <= read (data resources)

Terraform will perform the following actions:

  # data.local_file.input will be read during apply
  # (depends on a resource or a module with changes pending)
 <= data "local_file" "input" {
      + content              = (known after apply)
      + content_base64       = (known after apply)
      + content_base64sha256 = (known after apply)
      + content_base64sha512 = (known after apply)
      + content_md5          = (known after apply)
      + content_sha1         = (known after apply)
      + content_sha256       = (known after apply)
      + content_sha512       = (known after apply)
      + filename             = "/tmp/tests/azure_key_vault_deleted_vault/terraform/test/output.json"
      + id                   = (known after apply)
    }

  # azurerm_key_vault.named_test_resource will be created
  + resource "azurerm_key_vault" "named_test_resource" {
      + access_policy                 = (known after apply)
      + id                            = (known after apply)
      + location                      = "westus"
      + name                          = "turbottest91307"
      + public_network_access_enabled = true
      + purge_protection_enabled      = false
      + resource_group_name           = "turbottest91307"
      + sku_name                      = "standard"
      + soft_delete_retention_days    = 7
      + tenant_id                     = "cdffd708-7da0-4cea-abeb-0a4c334d7f64"
      + vault_uri                     = (known after apply)

      + network_acls {
          + bypass                     = (known after apply)
          + default_action             = (known after apply)
          + ip_rules                   = (known after apply)
          + virtual_network_subnet_ids = (known after apply)
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "westus"
      + name     = "turbottest91307"
    }

  # null_resource.named_test_resource will be created
  + resource "null_resource" "named_test_resource" {
      + id = (known after apply)
    }

Plan: 3 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + region             = (known after apply)
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = (known after apply)
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 5s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest91307]
azurerm_key_vault.named_test_resource: Creating...
azurerm_key_vault.named_test_resource: Still creating... [10s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [20s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [30s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [40s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [50s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m0s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m10s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m20s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m30s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m40s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m50s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m0s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m10s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m20s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m30s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m40s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m50s elapsed]
azurerm_key_vault.named_test_resource: Creation complete after 2m57s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest91307/providers/Microsoft.KeyVault/vaults/turbottest91307]
null_resource.named_test_resource: Creating...
null_resource.named_test_resource: Provisioning with 'local-exec'...
null_resource.named_test_resource (local-exec): Executing: ["/bin/sh" "-c" "az keyvault delete --name turbottest91307 --resource-group turbottest91307"]
null_resource.named_test_resource (local-exec): ERROR: The command failed with an unexpected error. Here is the traceback:
null_resource.named_test_resource (local-exec): ERROR: No module named '_cffi_backend'
null_resource.named_test_resource (local-exec): Traceback (most recent call last):
null_resource.named_test_resource (local-exec):   File "/usr/lib64/az/lib/python3.6/site-packages/knack/cli.py", line 231, in invoke
null_resource.named_test_resource (local-exec):     cmd_result = self.invocation.execute(args)
null_resource.named_test_resource (local-exec):   File "/usr/lib64/az/lib/python3.6/site-packages/azure/cli/core/commands/__init__.py", line 561, in execute
null_resource.named_test_resource (local-exec):     self.commands_loader.load_arguments(command)
null_resource.named_test_resource (local-exec):   File "/usr/lib64/az/lib/python3.6/site-packages/azure/cli/core/__init__.py", line 515, in load_arguments
null_resource.named_test_resource (local-exec):     self.command_table[command].load_arguments()  # this loads the arguments via reflection
null_resource.named_test_resource (local-exec):   File "/usr/lib64/az/lib/python3.6/site-packages/azure/cli/core/commands/__init__.py", line 318, in load_arguments
null_resource.named_test_resource (local-exec):     super(AzCliCommand, self).load_arguments()
null_resource.named_test_resource (local-exec):   File "/usr/lib64/az/lib/python3.6/site-packages/knack/commands.py", line 104, in load_arguments
null_resource.named_test_resource (local-exec):     cmd_args = self.arguments_loader()
null_resource.named_test_resource (local-exec):   File "/usr/lib64/az/lib/python3.6/site-packages/azure/cli/core/commands/command_operation.py", line 125, in arguments_loader
null_resource.named_test_resource (local-exec):     op = self.get_op_handler(self.op_path)
null_resource.named_test_resource (local-exec):   File "/usr/lib64/az/lib/python3.6/site-packages/azure/cli/core/commands/command_operation.py", line 59, in get_op_handler
null_resource.named_test_resource (local-exec):     handler = import_module(mod_to_import)
null_resource.named_test_resource (local-exec):   File "/usr/lib64/python3.7/importlib/__init__.py", line 127, in import_module
null_resource.named_test_resource (local-exec):     return _bootstrap._gcd_import(name[level:], package, level)
null_resource.named_test_resource (local-exec):   File "<frozen importlib._bootstrap>", line 1006, in _gcd_import
null_resource.named_test_resource (local-exec):   File "<frozen importlib._bootstrap>", line 983, in _find_and_load
null_resource.named_test_resource (local-exec):   File "<frozen importlib._bootstrap>", line 967, in _find_and_load_unlocked
null_resource.named_test_resource (local-exec):   File "<frozen importlib._bootstrap>", line 677, in _load_unlocked
null_resource.named_test_resource (local-exec):   File "<frozen importlib._bootstrap_external>", line 728, in exec_module
null_resource.named_test_resource (local-exec):   File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
null_resource.named_test_resource (local-exec):   File "/usr/lib64/az/lib/python3.6/site-packages/azure/cli/command_modules/keyvault/custom.py", line 21, in <module>
null_resource.named_test_resource (local-exec):     from azure.cli.command_modules.keyvault.security_domain.jwe import JWE
null_resource.named_test_resource (local-exec):   File "/usr/lib64/az/lib/python3.6/site-packages/azure/cli/command_modules/keyvault/security_domain/jwe.py", line 13, in <module>
null_resource.named_test_resource (local-exec):     from cryptography.hazmat.primitives import hashes, padding
null_resource.named_test_resource (local-exec):   File "/usr/lib64/az/lib/python3.6/site-packages/cryptography/hazmat/primitives/padding.py", line 13, in <module>
null_resource.named_test_resource (local-exec):     from cryptography.hazmat.bindings._padding import lib
null_resource.named_test_resource (local-exec): ModuleNotFoundError: No module named '_cffi_backend'
null_resource.named_test_resource (local-exec): To open an issue, please run: 'az feedback'

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 27, in data "null_data_source" "resource":
  27: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Error: local-exec provisioner error

  with null_resource.named_test_resource,
  on variables.tf line 55, in resource "null_resource" "named_test_resource":
  55:   provisioner "local-exec" {

Error running command 'az keyvault delete --name turbottest91307
--resource-group turbottest91307': exit status 1. Output: ERROR: The command
failed with an unexpected error. Here is the traceback:
ERROR: No module named '_cffi_backend'
Traceback (most recent call last):
  File "/usr/lib64/az/lib/python3.6/site-packages/knack/cli.py", line 231, in invoke
    cmd_result = self.invocation.execute(args)
  File "/usr/lib64/az/lib/python3.6/site-packages/azure/cli/core/commands/__init__.py", line 561, in execute
    self.commands_loader.load_arguments(command)
  File "/usr/lib64/az/lib/python3.6/site-packages/azure/cli/core/__init__.py", line 515, in load_arguments
    self.command_table[command].load_arguments()  # this loads the arguments via reflection
  File "/usr/lib64/az/lib/python3.6/site-packages/azure/cli/core/commands/__init__.py", line 318, in load_arguments
    super(AzCliCommand, self).load_arguments()
  File "/usr/lib64/az/lib/python3.6/site-packages/knack/commands.py", line 104, in load_arguments
    cmd_args = self.arguments_loader()
  File "/usr/lib64/az/lib/python3.6/site-packages/azure/cli/core/commands/command_operation.py", line 125, in arguments_loader
    op = self.get_op_handler(self.op_path)
  File "/usr/lib64/az/lib/python3.6/site-packages/azure/cli/core/commands/command_operation.py", line 59, in get_op_handler
    handler = import_module(mod_to_import)
  File "/usr/lib64/python3.7/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1006, in _gcd_import
  File "<frozen importlib._bootstrap>", line 983, in _find_and_load
  File "<frozen importlib._bootstrap>", line 967, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 677, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/usr/lib64/az/lib/python3.6/site-packages/azure/cli/command_modules/keyvault/custom.py", line 21, in <module>
    from azure.cli.command_modules.keyvault.security_domain.jwe import JWE
  File "/usr/lib64/az/lib/python3.6/site-packages/azure/cli/command_modules/keyvault/security_domain/jwe.py", line 13, in <module>
    from cryptography.hazmat.primitives import hashes, padding
  File "/usr/lib64/az/lib/python3.6/site-packages/cryptography/hazmat/primitives/padding.py", line 13, in <module>
    from cryptography.hazmat.bindings._padding import lib
ModuleNotFoundError: No module named '_cffi_backend'
To open an issue, please run: 'az feedback'

Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_key_vault_deleted_vault

SUMMARY:

✘ tests/azure_key_vault_deleted_vault failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_key_vault_key []

PRETEST: tests/azure_key_vault_key

TEST: tests/azure_key_vault_key
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 28, in data "null_data_source" "resource":
  28: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Error: expected access_policy.0.key_permissions.0 to be one of [Backup Create Decrypt Delete Encrypt Get Import List Purge Recover Restore Sign UnwrapKey Update Verify WrapKey Release Rotate GetRotationPolicy SetRotationPolicy], got create

  with azurerm_key_vault.named_test_resource,
  on variables.tf line 56, in resource "azurerm_key_vault" "named_test_resource":
  56:       "recover"


Error: expected access_policy.0.key_permissions.1 to be one of [Backup Create Decrypt Delete Encrypt Get Import List Purge Recover Restore Sign UnwrapKey Update Verify WrapKey Release Rotate GetRotationPolicy SetRotationPolicy], got delete

  with azurerm_key_vault.named_test_resource,
  on variables.tf line 56, in resource "azurerm_key_vault" "named_test_resource":
  56:       "recover"


Error: expected access_policy.0.key_permissions.2 to be one of [Backup Create Decrypt Delete Encrypt Get Import List Purge Recover Restore Sign UnwrapKey Update Verify WrapKey Release Rotate GetRotationPolicy SetRotationPolicy], got get

  with azurerm_key_vault.named_test_resource,
  on variables.tf line 56, in resource "azurerm_key_vault" "named_test_resource":
  56:       "recover"


Error: expected access_policy.0.key_permissions.3 to be one of [Backup Create Decrypt Delete Encrypt Get Import List Purge Recover Restore Sign UnwrapKey Update Verify WrapKey Release Rotate GetRotationPolicy SetRotationPolicy], got purge

  with azurerm_key_vault.named_test_resource,
  on variables.tf line 56, in resource "azurerm_key_vault" "named_test_resource":
  56:       "recover"


Error: expected access_policy.0.key_permissions.4 to be one of [Backup Create Decrypt Delete Encrypt Get Import List Purge Recover Restore Sign UnwrapKey Update Verify WrapKey Release Rotate GetRotationPolicy SetRotationPolicy], got recover

  with azurerm_key_vault.named_test_resource,
  on variables.tf line 56, in resource "azurerm_key_vault" "named_test_resource":
  56:       "recover"


Error: expected access_policy.0.secret_permissions.0 to be one of [Backup Delete Get List Purge Recover Restore Set], got set

  with azurerm_key_vault.named_test_resource,
  on variables.tf line 60, in resource "azurerm_key_vault" "named_test_resource":
  60:       "set",

Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_key_vault_key


Error: expected access_policy.0.key_permissions.0 to be one of [Backup Create Decrypt Delete Encrypt Get Import List Purge Recover Restore Sign UnwrapKey Update Verify WrapKey Release Rotate GetRotationPolicy SetRotationPolicy], got create

  with azurerm_key_vault.named_test_resource,
  on variables.tf line 56, in resource "azurerm_key_vault" "named_test_resource":
  56:       "recover"


Error: expected access_policy.0.key_permissions.1 to be one of [Backup Create Decrypt Delete Encrypt Get Import List Purge Recover Restore Sign UnwrapKey Update Verify WrapKey Release Rotate GetRotationPolicy SetRotationPolicy], got delete

  with azurerm_key_vault.named_test_resource,
  on variables.tf line 56, in resource "azurerm_key_vault" "named_test_resource":
  56:       "recover"


Error: expected access_policy.0.key_permissions.2 to be one of [Backup Create Decrypt Delete Encrypt Get Import List Purge Recover Restore Sign UnwrapKey Update Verify WrapKey Release Rotate GetRotationPolicy SetRotationPolicy], got get

  with azurerm_key_vault.named_test_resource,
  on variables.tf line 56, in resource "azurerm_key_vault" "named_test_resource":
  56:       "recover"


Error: expected access_policy.0.key_permissions.3 to be one of [Backup Create Decrypt Delete Encrypt Get Import List Purge Recover Restore Sign UnwrapKey Update Verify WrapKey Release Rotate GetRotationPolicy SetRotationPolicy], got purge

  with azurerm_key_vault.named_test_resource,
  on variables.tf line 56, in resource "azurerm_key_vault" "named_test_resource":
  56:       "recover"


Error: expected access_policy.0.key_permissions.4 to be one of [Backup Create Decrypt Delete Encrypt Get Import List Purge Recover Restore Sign UnwrapKey Update Verify WrapKey Release Rotate GetRotationPolicy SetRotationPolicy], got recover

  with azurerm_key_vault.named_test_resource,
  on variables.tf line 56, in resource "azurerm_key_vault" "named_test_resource":
  56:       "recover"


Error: expected access_policy.0.secret_permissions.0 to be one of [Backup Delete Get List Purge Recover Restore Set], got set

  with azurerm_key_vault.named_test_resource,
  on variables.tf line 60, in resource "azurerm_key_vault" "named_test_resource":
  60:       "set",

SUMMARY:

✘ tests/azure_key_vault_key failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_key_vault_key_version []

PRETEST: tests/azure_key_vault_key_version

TEST: tests/azure_key_vault_key_version
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_key_vault.named_test_resource will be created
  + resource "azurerm_key_vault" "named_test_resource" {
      + access_policy                 = [
          + {
              + application_id          = null
              + certificate_permissions = null
              + key_permissions         = [
                  + "Create",
                  + "Delete",
                  + "Get",
                  + "Purge",
                  + "Recover",
                ]
              + object_id               = "06fd46b0-a867-49a1-a4f1-f7768465caba"
              + secret_permissions      = [
                  + "Set",
                ]
              + storage_permissions     = null
              + tenant_id               = "cdffd708-7da0-4cea-abeb-0a4c334d7f64"
            },
        ]
      + id                            = (known after apply)
      + location                      = "westus"
      + name                          = "turbottest37683"
      + public_network_access_enabled = true
      + resource_group_name           = "turbottest37683"
      + sku_name                      = "standard"
      + soft_delete_retention_days    = 7
      + tags                          = {
          + "name" = "turbottest37683"
        }
      + tenant_id                     = "cdffd708-7da0-4cea-abeb-0a4c334d7f64"
      + vault_uri                     = (known after apply)

      + network_acls {
          + bypass                     = (known after apply)
          + default_action             = (known after apply)
          + ip_rules                   = (known after apply)
          + virtual_network_subnet_ids = (known after apply)
        }
    }

  # azurerm_key_vault_key.named_test_resource will be created
  + resource "azurerm_key_vault_key" "named_test_resource" {
      + curve                   = (known after apply)
      + e                       = (known after apply)
      + id                      = (known after apply)
      + key_opts                = [
          + "decrypt",
          + "encrypt",
          + "sign",
          + "unwrapKey",
          + "verify",
          + "wrapKey",
        ]
      + key_size                = 2048
      + key_type                = "RSA"
      + key_vault_id            = (known after apply)
      + n                       = (known after apply)
      + name                    = "turbottest37683"
      + public_key_openssh      = (known after apply)
      + public_key_pem          = (known after apply)
      + resource_id             = (known after apply)
      + resource_versionless_id = (known after apply)
      + tags                    = {
          + "name" = "turbottest37683"
        }
      + version                 = (known after apply)
      + versionless_id          = (known after apply)
      + x                       = (known after apply)
      + y                       = (known after apply)

      + rotation_policy {
          + expire_after         = (known after apply)
          + notify_before_expiry = (known after apply)

          + automatic {
              + time_after_creation = (known after apply)
              + time_before_expiry  = (known after apply)
            }
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "westus"
      + name     = "turbottest37683"
    }

Plan: 3 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + key_uri_without_version = (known after apply)
  + key_version             = (known after apply)
  + location                = "westus"
  + location_lower          = "westus"
  + resource_aka            = (known after apply)
  + resource_aka_lower      = (known after apply)
  + resource_id             = (known after apply)
  + resource_name           = "turbottest37683"
  + subscription_id         = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 6s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest37683]
azurerm_key_vault.named_test_resource: Creating...
azurerm_key_vault.named_test_resource: Still creating... [10s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [20s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [30s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [40s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [50s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m0s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m10s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m20s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m30s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m40s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m50s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m0s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m10s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m20s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m30s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m40s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m50s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [3m0s elapsed]
azurerm_key_vault.named_test_resource: Creation complete after 3m0s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest37683/providers/Microsoft.KeyVault/vaults/turbottest37683]
azurerm_key_vault_key.named_test_resource: Creating...

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 28, in data "null_data_source" "resource":
  28: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Error: current client lacks permissions to read Key Rotation Policy for Key "turbottest37683" ("Vault: (Name \"turbottest37683\" / Resource Group \"turbottest37683\")", Vault url: "https://turbottest37683.vault.azure.net/"), please update this as described here: https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_key#example-usage : keyvault.BaseClient#GetKeyRotationPolicy: Failure responding to request: StatusCode=403 -- Original Error: autorest/azure: Service returned an error. Status=403 Code="Forbidden" Message="The user, group or application 'appid=04b07795-8ddb-461a-bbee-02f9e1bf7b46;oid=06fd46b0-a867-49a1-a4f1-f7768465caba;numgroups=1;iss=https://sts.windows.net/cdffd708-7da0-4cea-abeb-0a4c334d7f64/' does not have keys getrotationpolicy permission on key vault 'turbottest37683;location=westus'. For help resolving this issue, please see https://go.microsoft.com/fwlink/?linkid=2125287" InnerError={"code":"ForbiddenByPolicy"}

  with azurerm_key_vault_key.named_test_resource,
  on variables.tf line 69, in resource "azurerm_key_vault_key" "named_test_resource":
  69: resource "azurerm_key_vault_key" "named_test_resource" {

Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_key_vault_key_version


Error: current client lacks permissions to read Key Rotation Policy for Key "turbottest37683" ("Vault: (Name \"turbottest37683\" / Resource Group \"turbottest37683\")", Vault url: "https://turbottest37683.vault.azure.net/"), please update this as described here: https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_key#example-usage : keyvault.BaseClient#GetKeyRotationPolicy: Failure responding to request: StatusCode=403 -- Original Error: autorest/azure: Service returned an error. Status=403 Code="Forbidden" Message="The user, group or application 'appid=04b07795-8ddb-461a-bbee-02f9e1bf7b46;oid=06fd46b0-a867-49a1-a4f1-f7768465caba;numgroups=1;iss=https://sts.windows.net/cdffd708-7da0-4cea-abeb-0a4c334d7f64/' does not have keys getrotationpolicy permission on key vault 'turbottest37683;location=westus'. For help resolving this issue, please see https://go.microsoft.com/fwlink/?linkid=2125287" InnerError={"code":"ForbiddenByPolicy"}

  with azurerm_key_vault_key.named_test_resource,
  on variables.tf line 69, in resource "azurerm_key_vault_key" "named_test_resource":
  69: resource "azurerm_key_vault_key" "named_test_resource" {

SUMMARY:

✘ tests/azure_key_vault_key_version failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_key_vault_managed_hardware_security_module []

PRETEST: tests/azure_key_vault_managed_hardware_security_module

TEST: tests/azure_key_vault_managed_hardware_security_module
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_key_vault_managed_hardware_security_module.named_test_resource will be created
  + resource "azurerm_key_vault_managed_hardware_security_module" "named_test_resource" {
      + admin_object_ids              = [
          + "06fd46b0-a867-49a1-a4f1-f7768465caba",
        ]
      + hsm_uri                       = (known after apply)
      + id                            = (known after apply)
      + location                      = "eastus"
      + name                          = "turbottest46765"
      + public_network_access_enabled = true
      + purge_protection_enabled      = false
      + resource_group_name           = "turbottest46765"
      + sku_name                      = "Standard_B1"
      + soft_delete_retention_days    = 8
      + tags                          = {
          + "Name" = "turbottest46765"
        }
      + tenant_id                     = "cdffd708-7da0-4cea-abeb-0a4c334d7f64"

      + network_acls {
          + bypass         = (known after apply)
          + default_action = (known after apply)
        }
    }

  # azurerm_monitor_diagnostic_setting.named_test_resource will be created
  + resource "azurerm_monitor_diagnostic_setting" "named_test_resource" {
      + id                             = (known after apply)
      + log_analytics_destination_type = (known after apply)
      + name                           = "turbottest46765"
      + storage_account_id             = (known after apply)
      + target_resource_id             = (known after apply)

      + enabled_log {
          + category       = (known after apply)
          + category_group = (known after apply)

          + retention_policy {
              + days    = (known after apply)
              + enabled = (known after apply)
            }
        }

      + log {
          + category = "AuditEvent"
          + enabled  = true

          + retention_policy {
              + days    = 30
              + enabled = true
            }
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "eastus"
      + name     = "turbottest46765"
    }

  # azurerm_storage_account.named_test_resource will be created
  + resource "azurerm_storage_account" "named_test_resource" {
      + access_tier                       = (known after apply)
      + account_kind                      = "StorageV2"
      + account_replication_type          = "LRS"
      + account_tier                      = "Standard"
      + allow_nested_items_to_be_public   = true
      + cross_tenant_replication_enabled  = true
      + default_to_oauth_authentication   = false
      + enable_https_traffic_only         = true
      + id                                = (known after apply)
      + infrastructure_encryption_enabled = false
      + is_hns_enabled                    = false
      + large_file_share_enabled          = (known after apply)
      + location                          = "eastus"
      + min_tls_version                   = "TLS1_2"
      + name                              = "turbottest46765"
      + nfsv3_enabled                     = false
      + primary_access_key                = (sensitive value)
      + primary_blob_connection_string    = (sensitive value)
      + primary_blob_endpoint             = (known after apply)
      + primary_blob_host                 = (known after apply)
      + primary_connection_string         = (sensitive value)
      + primary_dfs_endpoint              = (known after apply)
      + primary_dfs_host                  = (known after apply)
      + primary_file_endpoint             = (known after apply)
      + primary_file_host                 = (known after apply)
      + primary_location                  = (known after apply)
      + primary_queue_endpoint            = (known after apply)
      + primary_queue_host                = (known after apply)
      + primary_table_endpoint            = (known after apply)
      + primary_table_host                = (known after apply)
      + primary_web_endpoint              = (known after apply)
      + primary_web_host                  = (known after apply)
      + public_network_access_enabled     = true
      + queue_encryption_key_type         = "Service"
      + resource_group_name               = "turbottest46765"
      + secondary_access_key              = (sensitive value)
      + secondary_blob_connection_string  = (sensitive value)
      + secondary_blob_endpoint           = (known after apply)
      + secondary_blob_host               = (known after apply)
      + secondary_connection_string       = (sensitive value)
      + secondary_dfs_endpoint            = (known after apply)
      + secondary_dfs_host                = (known after apply)
      + secondary_file_endpoint           = (known after apply)
      + secondary_file_host               = (known after apply)
      + secondary_location                = (known after apply)
      + secondary_queue_endpoint          = (known after apply)
      + secondary_queue_host              = (known after apply)
      + secondary_table_endpoint          = (known after apply)
      + secondary_table_host              = (known after apply)
      + secondary_web_endpoint            = (known after apply)
      + secondary_web_host                = (known after apply)
      + sftp_enabled                      = false
      + shared_access_key_enabled         = true
      + table_encryption_key_type         = "Service"

      + blob_properties {
          + change_feed_enabled           = (known after apply)
          + change_feed_retention_in_days = (known after apply)
          + default_service_version       = (known after apply)
          + last_access_time_enabled      = (known after apply)
          + versioning_enabled            = (known after apply)

          + container_delete_retention_policy {
              + days = (known after apply)
            }

          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + delete_retention_policy {
              + days = (known after apply)
            }

          + restore_policy {
              + days = (known after apply)
            }
        }

      + network_rules {
          + bypass                     = (known after apply)
          + default_action             = (known after apply)
          + ip_rules                   = (known after apply)
          + virtual_network_subnet_ids = (known after apply)

          + private_link_access {
              + endpoint_resource_id = (known after apply)
              + endpoint_tenant_id   = (known after apply)
            }
        }

      + queue_properties {
          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + hour_metrics {
              + enabled               = (known after apply)
              + include_apis          = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
            }

          + logging {
              + delete                = (known after apply)
              + read                  = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
              + write                 = (known after apply)
            }

          + minute_metrics {
              + enabled               = (known after apply)
              + include_apis          = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
            }
        }

      + routing {
          + choice                      = (known after apply)
          + publish_internet_endpoints  = (known after apply)
          + publish_microsoft_endpoints = (known after apply)
        }

      + share_properties {
          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + retention_policy {
              + days = (known after apply)
            }

          + smb {
              + authentication_types            = (known after apply)
              + channel_encryption_type         = (known after apply)
              + kerberos_ticket_encryption_type = (known after apply)
              + multichannel_enabled            = (known after apply)
              + versions                        = (known after apply)
            }
        }
    }

Plan: 4 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + object_id          = "06fd46b0-a867-49a1-a4f1-f7768465caba"
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest46765"
  + storage_account_id = (known after apply)
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
  + tenant_id          = "cdffd708-7da0-4cea-abeb-0a4c334d7f64"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 6s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46765]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Creating...
azurerm_storage_account.named_test_resource: Creating...
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [10s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [10s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [20s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [20s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [30s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [30s elapsed]
azurerm_storage_account.named_test_resource: Creation complete after 33s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46765/providers/Microsoft.Storage/storageAccounts/turbottest46765]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [40s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [50s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [1m0s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [1m10s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [1m20s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [1m30s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [1m40s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [1m50s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [2m0s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [2m10s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [2m20s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [2m30s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [2m40s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [2m50s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [3m0s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [3m10s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [3m20s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [3m30s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [3m40s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [3m50s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [4m0s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [4m10s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [4m20s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [4m30s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [4m40s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [4m50s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [5m0s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [5m10s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [5m20s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [5m30s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [5m40s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [5m50s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [6m0s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [6m10s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [6m20s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [6m30s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [6m40s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [6m50s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [7m0s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [7m10s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [7m20s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [7m30s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [7m40s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [7m50s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [8m0s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [8m10s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [8m20s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [8m30s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [8m40s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [8m50s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [9m0s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [9m10s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [9m20s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [9m30s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [9m40s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [9m50s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [10m0s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [10m10s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [10m20s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [10m30s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [10m40s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [10m50s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [11m0s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [11m10s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [11m20s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [11m30s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [11m40s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [11m50s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [12m0s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [12m10s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [12m20s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [12m30s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [12m40s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [12m50s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [13m0s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [13m10s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [13m20s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [13m30s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [13m40s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [13m50s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [14m0s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [14m10s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [14m20s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [14m30s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [14m40s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Still creating... [14m50s elapsed]
azurerm_key_vault_managed_hardware_security_module.named_test_resource: Creation complete after 14m59s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46765/providers/Microsoft.KeyVault/managedHSMs/turbottest46765]
azurerm_monitor_diagnostic_setting.named_test_resource: Creating...
azurerm_monitor_diagnostic_setting.named_test_resource: Creation complete after 7s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46765/providers/Microsoft.KeyVault/managedHSMs/turbottest46765|turbottest46765]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 28, in data "null_data_source" "resource":
  28: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Warning: Argument is deprecated

  with azurerm_monitor_diagnostic_setting.named_test_resource,
  on variables.tf line 62, in resource "azurerm_monitor_diagnostic_setting" "named_test_resource":
  62: resource "azurerm_monitor_diagnostic_setting" "named_test_resource" {

`log` has been superseded by `enabled_log` and will be removed in version 4.0
of the AzureRM Provider.

(and 2 more similar warnings elsewhere)

Apply complete! Resources: 4 added, 0 changed, 0 destroyed.

Outputs:

object_id = "06fd46b0-a867-49a1-a4f1-f7768465caba"
resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46765/providers/Microsoft.KeyVault/managedHSMs/turbottest46765"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest46765/providers/microsoft.keyvault/managedhsms/turbottest46765"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46765/providers/Microsoft.KeyVault/managedHSMs/turbottest46765"
resource_name = "turbottest46765"
storage_account_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46765/providers/Microsoft.Storage/storageAccounts/turbottest46765"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"
tenant_id = "cdffd708-7da0-4cea-abeb-0a4c334d7f64"

Running SQL query: test-get-query.sql
[
  {
    "enable_soft_delete": true,
    "hsm_uri": "https://turbottest46765.managedhsm.azure.net/",
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46765/providers/Microsoft.KeyVault/managedHSMs/turbottest46765",
    "name": "turbottest46765",
    "region": "eastus",
    "resource_group": "turbottest46765",
    "soft_delete_retention_in_days": 8,
    "tenant_id": "cdffd708-7da0-4cea-abeb-0a4c334d7f64",
    "type": "Microsoft.KeyVault/managedHSMs"
  }
]
✔ PASSED

Running SQL query: test-hydrate-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46765/providers/Microsoft.KeyVault/managedHSMs/turbottest46765",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest46765/providers/microsoft.keyvault/managedhsms/turbottest46765"
    ],
    "name": "turbottest46765",
    "tags": {
      "Name": "turbottest46765"
    },
    "title": "turbottest46765"
  }
]
✔ PASSED

Running SQL query: test-list-query.sql
null
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46765/providers/Microsoft.KeyVault/managedHSMs/turbottest46765",
    "name": "turbottest46765"
  }
]

✘ FAILED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46765/providers/Microsoft.KeyVault/managedHSMs/turbottest46765",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest46765/providers/microsoft.keyvault/managedhsms/turbottest46765"
    ],
    "name": "turbottest46765",
    "tags": {
      "Name": "turbottest46765"
    },
    "title": "turbottest46765"
  }
]
✔ PASSED

TEARDOWN: tests/azure_key_vault_managed_hardware_security_module

SUMMARY:

✘ tests/azure_key_vault_managed_hardware_security_module failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_key_vault_secret []

PRETEST: tests/azure_key_vault_secret

TEST: tests/azure_key_vault_secret
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_key_vault.named_test_resource will be created
  + resource "azurerm_key_vault" "named_test_resource" {
      + access_policy                 = [
          + {
              + application_id          = null
              + certificate_permissions = null
              + key_permissions         = null
              + object_id               = "06fd46b0-a867-49a1-a4f1-f7768465caba"
              + secret_permissions      = [
                  + "Delete",
                  + "Get",
                  + "List",
                  + "Purge",
                  + "Recover",
                  + "Restore",
                  + "Set",
                ]
              + storage_permissions     = null
              + tenant_id               = "cdffd708-7da0-4cea-abeb-0a4c334d7f64"
            },
        ]
      + id                            = (known after apply)
      + location                      = "westus"
      + name                          = "turbottest57089"
      + public_network_access_enabled = true
      + resource_group_name           = "turbottest57089"
      + sku_name                      = "standard"
      + soft_delete_retention_days    = 7
      + tenant_id                     = "cdffd708-7da0-4cea-abeb-0a4c334d7f64"
      + vault_uri                     = (known after apply)

      + network_acls {
          + bypass                     = (known after apply)
          + default_action             = (known after apply)
          + ip_rules                   = (known after apply)
          + virtual_network_subnet_ids = (known after apply)
        }
    }

  # azurerm_key_vault_secret.named_test_resource will be created
  + resource "azurerm_key_vault_secret" "named_test_resource" {
      + content_type            = "text"
      + id                      = (known after apply)
      + key_vault_id            = (known after apply)
      + name                    = "turbottest57089"
      + resource_id             = (known after apply)
      + resource_versionless_id = (known after apply)
      + tags                    = {
          + "name" = "turbottest57089"
        }
      + value                   = (sensitive value)
      + version                 = (known after apply)
      + versionless_id          = (known after apply)
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "westus"
      + name     = "turbottest57089"
    }

Plan: 3 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + location                   = "westus"
  + resource_aka               = (known after apply)
  + resource_aka_lower         = (known after apply)
  + resource_id                = (known after apply)
  + resource_name              = "turbottest57089"
  + secret_uri_without_version = (known after apply)
  + secret_version             = (known after apply)
  + subscription_id            = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 4s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest57089]
azurerm_key_vault.named_test_resource: Creating...
azurerm_key_vault.named_test_resource: Still creating... [10s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [20s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [30s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [40s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [50s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m0s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m10s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m20s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m30s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m40s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [1m50s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m0s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m10s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m20s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m30s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m40s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [2m50s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [3m0s elapsed]
azurerm_key_vault.named_test_resource: Still creating... [3m10s elapsed]
azurerm_key_vault.named_test_resource: Creation complete after 3m15s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest57089/providers/Microsoft.KeyVault/vaults/turbottest57089]
azurerm_key_vault_secret.named_test_resource: Creating...
azurerm_key_vault_secret.named_test_resource: Creation complete after 2s [id=https://turbottest57089.vault.azure.net/secrets/turbottest57089/79b7224ff25c4d90b3c0cf825e63d1a7]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 28, in data "null_data_source" "resource":
  28: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Apply complete! Resources: 3 added, 0 changed, 0 destroyed.

Outputs:

location = "westus"
resource_aka = "azure://https://turbottest57089.vault.azure.net/secrets/turbottest57089/79b7224ff25c4d90b3c0cf825e63d1a7"
resource_aka_lower = "azure://https://turbottest57089.vault.azure.net/secrets/turbottest57089/79b7224ff25c4d90b3c0cf825e63d1a7"
resource_id = "https://turbottest57089.vault.azure.net/secrets/turbottest57089/79b7224ff25c4d90b3c0cf825e63d1a7"
resource_name = "turbottest57089"
secret_uri_without_version = "https://turbottest57089.vault.azure.net/secrets/turbottest57089"
secret_version = "79b7224ff25c4d90b3c0cf825e63d1a7"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
Error: rpc error: code = Internal desc = hydrate function getTurbotData failed with panic runtime error: index out of range [4] with length 1 (SQLSTATE HV000)
{}
[
  {
    "content_type": "text",
    "enabled": true,
    "id": "https://turbottest57089.vault.azure.net/secrets/turbottest57089/79b7224ff25c4d90b3c0cf825e63d1a7",
    "name": "turbottest57089",
    "recoverable_days": 7,
    "recovery_level": "CustomizedRecoverable+Purgeable",
    "region": "westus",
    "resource_group": "turbottest57089",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "value": "steampipe",
    "vault_name": "turbottest57089"
  }
]

✘ FAILED

Running SQL query: test-list-query.sql
Error: keyvault.BaseClient#GetSecrets: Failure responding to request: StatusCode=403 -- Original Error: autorest/azure: Service returned an error. Status=403 Code="Forbidden" Message="The user, group or application 'appid=04b07795-8ddb-461a-bbee-02f9e1bf7b46;oid=06fd46b0-a867-49a1-a4f1-f7768465caba;numgroups=1;iss=https://sts.windows.net/cdffd708-7da0-4cea-abeb-0a4c334d7f64/' does not have secrets list permission on key vault 'turbottest83809;location=eastus'. For help resolving this issue, please see https://go.microsoft.com/fwlink/?linkid=2125287" InnerError={"code":"ForbiddenByPolicy"} (SQLSTATE HV000)
{}
[
  {
    "id": "https://turbottest57089.vault.azure.net/secrets/turbottest57089/79b7224ff25c4d90b3c0cf825e63d1a7",
    "name": "turbottest57089"
  }
]

✘ FAILED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
Error: rpc error: code = Internal desc = hydrate function getTurbotData failed with panic runtime error: index out of range [4] with length 1 (SQLSTATE HV000)
{}
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest57089/providers/Microsoft.KeyVault/vaults/turbottest57089/secrets/turbottest57089",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest57089/providers/microsoft.keyvault/vaults/turbottest57089/secrets/turbottest57089"
    ],
    "name": "turbottest57089",
    "tags": {
      "name": "turbottest57089"
    },
    "title": "turbottest57089"
  }
]

✘ FAILED

TEARDOWN: tests/azure_key_vault_secret

SUMMARY:

✘ tests/azure_key_vault_secret failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_kubernetes_cluster []

PRETEST: tests/azure_kubernetes_cluster

TEST: tests/azure_kubernetes_cluster
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_kubernetes_cluster.named_test_resource will be created
  + resource "azurerm_kubernetes_cluster" "named_test_resource" {
      + api_server_authorized_ip_ranges     = (known after apply)
      + dns_prefix                          = "turbottest67308"
      + fqdn                                = (known after apply)
      + http_application_routing_zone_name  = (known after apply)
      + id                                  = (known after apply)
      + image_cleaner_enabled               = false
      + image_cleaner_interval_hours        = 48
      + kube_admin_config                   = (sensitive value)
      + kube_admin_config_raw               = (sensitive value)
      + kube_config                         = (sensitive value)
      + kube_config_raw                     = (sensitive value)
      + kubernetes_version                  = (known after apply)
      + location                            = "westus"
      + name                                = "turbottest67308"
      + node_resource_group                 = (known after apply)
      + node_resource_group_id              = (known after apply)
      + oidc_issuer_url                     = (known after apply)
      + portal_fqdn                         = (known after apply)
      + private_cluster_enabled             = false
      + private_cluster_public_fqdn_enabled = false
      + private_dns_zone_id                 = (known after apply)
      + private_fqdn                        = (known after apply)
      + public_network_access_enabled       = true
      + resource_group_name                 = "turbottest67308"
      + role_based_access_control_enabled   = true
      + run_command_enabled                 = true
      + sku_tier                            = "Free"
      + tags                                = {
          + "foo" = "bar"
        }
      + workload_identity_enabled           = false

      + api_server_access_profile {
          + authorized_ip_ranges     = (known after apply)
          + subnet_id                = (known after apply)
          + vnet_integration_enabled = (known after apply)
        }

      + auto_scaler_profile {
          + balance_similar_node_groups      = (known after apply)
          + empty_bulk_delete_max            = (known after apply)
          + expander                         = (known after apply)
          + max_graceful_termination_sec     = (known after apply)
          + max_node_provisioning_time       = (known after apply)
          + max_unready_nodes                = (known after apply)
          + max_unready_percentage           = (known after apply)
          + new_pod_scale_up_delay           = (known after apply)
          + scale_down_delay_after_add       = (known after apply)
          + scale_down_delay_after_delete    = (known after apply)
          + scale_down_delay_after_failure   = (known after apply)
          + scale_down_unneeded              = (known after apply)
          + scale_down_unready               = (known after apply)
          + scale_down_utilization_threshold = (known after apply)
          + scan_interval                    = (known after apply)
          + skip_nodes_with_local_storage    = (known after apply)
          + skip_nodes_with_system_pods      = (known after apply)
        }

      + default_node_pool {
          + kubelet_disk_type    = (known after apply)
          + max_pods             = (known after apply)
          + name                 = "default"
          + node_count           = 1
          + node_labels          = (known after apply)
          + orchestrator_version = (known after apply)
          + os_disk_size_gb      = (known after apply)
          + os_disk_type         = "Managed"
          + os_sku               = (known after apply)
          + scale_down_mode      = "Delete"
          + type                 = "VirtualMachineScaleSets"
          + ultra_ssd_enabled    = false
          + vm_size              = "Standard_D2_v2"
          + workload_runtime     = (known after apply)
        }

      + identity {
          + principal_id = (known after apply)
          + tenant_id    = (known after apply)
          + type         = "SystemAssigned"
        }

      + kubelet_identity {
          + client_id                 = (known after apply)
          + object_id                 = (known after apply)
          + user_assigned_identity_id = (known after apply)
        }

      + network_profile {
          + dns_service_ip      = (known after apply)
          + docker_bridge_cidr  = (known after apply)
          + ebpf_data_plane     = (known after apply)
          + ip_versions         = (known after apply)
          + load_balancer_sku   = (known after apply)
          + network_mode        = (known after apply)
          + network_plugin      = (known after apply)
          + network_plugin_mode = (known after apply)
          + network_policy      = (known after apply)
          + outbound_type       = (known after apply)
          + pod_cidr            = (known after apply)
          + pod_cidrs           = (known after apply)
          + service_cidr        = (known after apply)
          + service_cidrs       = (known after apply)

          + load_balancer_profile {
              + effective_outbound_ips      = (known after apply)
              + idle_timeout_in_minutes     = (known after apply)
              + managed_outbound_ip_count   = (known after apply)
              + managed_outbound_ipv6_count = (known after apply)
              + outbound_ip_address_ids     = (known after apply)
              + outbound_ip_prefix_ids      = (known after apply)
              + outbound_ports_allocated    = (known after apply)
            }

          + nat_gateway_profile {
              + effective_outbound_ips    = (known after apply)
              + idle_timeout_in_minutes   = (known after apply)
              + managed_outbound_ip_count = (known after apply)
            }
        }

      + windows_profile {
          + admin_password = (sensitive value)
          + admin_username = (known after apply)
          + license        = (known after apply)

          + gmsa {
              + dns_server  = (known after apply)
              + root_domain = (known after apply)
            }
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "westus"
      + name     = "turbottest67308"
    }

Plan: 2 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + cluster_fqdn        = (known after apply)
  + location            = "westus"
  + node_resource_group = (known after apply)
  + resource_aka        = (known after apply)
  + resource_aka_lower  = (known after apply)
  + resource_id         = (known after apply)
  + resource_name       = "turbottest67308"
  + subscription_id     = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 4s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest67308]
azurerm_kubernetes_cluster.named_test_resource: Creating...
azurerm_kubernetes_cluster.named_test_resource: Still creating... [10s elapsed]
azurerm_kubernetes_cluster.named_test_resource: Still creating... [20s elapsed]
azurerm_kubernetes_cluster.named_test_resource: Still creating... [30s elapsed]
azurerm_kubernetes_cluster.named_test_resource: Still creating... [40s elapsed]
azurerm_kubernetes_cluster.named_test_resource: Still creating... [50s elapsed]
azurerm_kubernetes_cluster.named_test_resource: Still creating... [1m0s elapsed]
azurerm_kubernetes_cluster.named_test_resource: Still creating... [1m10s elapsed]
azurerm_kubernetes_cluster.named_test_resource: Still creating... [1m20s elapsed]
azurerm_kubernetes_cluster.named_test_resource: Still creating... [1m30s elapsed]
azurerm_kubernetes_cluster.named_test_resource: Still creating... [1m40s elapsed]
azurerm_kubernetes_cluster.named_test_resource: Still creating... [1m50s elapsed]
azurerm_kubernetes_cluster.named_test_resource: Still creating... [2m0s elapsed]
azurerm_kubernetes_cluster.named_test_resource: Still creating... [2m10s elapsed]
azurerm_kubernetes_cluster.named_test_resource: Still creating... [2m20s elapsed]
azurerm_kubernetes_cluster.named_test_resource: Still creating... [2m30s elapsed]
azurerm_kubernetes_cluster.named_test_resource: Still creating... [2m40s elapsed]
azurerm_kubernetes_cluster.named_test_resource: Still creating... [2m50s elapsed]
azurerm_kubernetes_cluster.named_test_resource: Still creating... [3m0s elapsed]
azurerm_kubernetes_cluster.named_test_resource: Still creating... [3m10s elapsed]
azurerm_kubernetes_cluster.named_test_resource: Still creating... [3m20s elapsed]
azurerm_kubernetes_cluster.named_test_resource: Creation complete after 3m29s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest67308/providers/Microsoft.ContainerService/managedClusters/turbottest67308]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 29, in data "null_data_source" "resource":
  29: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Apply complete! Resources: 2 added, 0 changed, 0 destroyed.

Outputs:

cluster_fqdn = "turbottest67308-btzufz6h.hcp.westus.azmk8s.io"
location = "westus"
node_resource_group = "MC_turbottest67308_turbottest67308_westus"
resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest67308/providers/Microsoft.ContainerService/managedClusters/turbottest67308"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest67308/providers/microsoft.containerservice/managedclusters/turbottest67308"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest67308/providers/Microsoft.ContainerService/managedClusters/turbottest67308"
resource_name = "turbottest67308"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "addon_profiles": null,
    "addon_profiles": {
      "aciConnectorLinux": {
        "enabled": false
      },
      "azurepolicy": {
        "enabled": false
      },
      "httpApplicationRouting": {
        "enabled": false
      },
      "ingressApplicationGateway": {
        "enabled": false
      },
      "kubeDashboard": {
        "enabled": false
      },
      "omsagent": {
        "enabled": false
      }
    },
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest67308/providers/Microsoft.ContainerService/managedClusters/turbottest67308",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest67308/providers/microsoft.containerservice/managedclusters/turbottest67308"
    ],
    "api_server_access_profile": {
      "enablePrivateCluster": false
    },
    "dns_prefix": "turbottest67308",
    "enable_rbac": true,
    "enable_rbac": false,
    "fqdn": "turbottest67308-btzufz6h.hcp.westus.azmk8s.io",
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest67308/providers/Microsoft.ContainerService/managedClusters/turbottest67308",
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest67308/providers/Microsoft.ContainerService/managedClusters/turbottest67308",
    "identity": {
      "type": "SystemAssigned"
    },
    "location": "westus",
    "max_agent_pools": 100,
    "name": "turbottest67308",
    "node_resource_group": "MC_turbottest67308_turbottest67308_westus",
    "power_state": {
      "code": "Running"
    },
    "provisioning_state": "Succeeded",
    "region": "westus",
    "resource_group": "turbottest67308",
    "sku": {
      "name": "Basic",
      "tier": "Free"
    },
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "tags": {
      "foo": "bar"
    },
    "title": "turbottest67308",
    "type": "Microsoft.ContainerService/ManagedClusters"
  }
]

✘ FAILED

Running SQL query: test-list-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest67308/providers/Microsoft.ContainerService/managedClusters/turbottest67308",
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest67308/providers/Microsoft.ContainerService/managedClusters/turbottest67308",
    "name": "turbottest67308",
    "resource_group": "turbottest67308",
    "type": "Microsoft.ContainerService/ManagedClusters"
  }
]

✘ FAILED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest67308/providers/Microsoft.ContainerService/managedClusters/turbottest67308",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest67308/providers/microsoft.containerservice/managedclusters/turbottest67308"
    ],
    "name": "turbottest67308",
    "tags": {
      "foo": "bar"
    },
    "title": "turbottest67308"
  }
]
✔ PASSED

TEARDOWN: tests/azure_kubernetes_cluster

SUMMARY:

✘ tests/azure_kubernetes_cluster failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_kusto_cluster []

PRETEST: tests/azure_kusto_cluster

TEST: tests/azure_kusto_cluster
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_kusto_cluster.named_test_resource will be created
  + resource "azurerm_kusto_cluster" "named_test_resource" {
      + auto_stop_enabled                  = true
      + data_ingestion_uri                 = (known after apply)
      + disk_encryption_enabled            = false
      + engine                             = "V2"
      + id                                 = (known after apply)
      + location                           = "eastus"
      + name                               = "turbottest74061"
      + outbound_network_access_restricted = false
      + public_ip_type                     = "IPv4"
      + public_network_access_enabled      = true
      + purge_enabled                      = false
      + resource_group_name                = "turbottest74061"
      + streaming_ingestion_enabled        = false
      + tags                               = {
          + "Name" = "turbottest74061"
        }
      + trusted_external_tenants           = (known after apply)
      + uri                                = (known after apply)

      + sku {
          + capacity = 2
          + name     = "Standard_D13_v2"
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "eastus"
      + name     = "turbottest74061"
    }

Plan: 2 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + cluster_uri        = (known after apply)
  + location           = "eastus"
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest74061"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 4s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest74061]
azurerm_kusto_cluster.named_test_resource: Creating...
azurerm_kusto_cluster.named_test_resource: Still creating... [10s elapsed]
azurerm_kusto_cluster.named_test_resource: Still creating... [20s elapsed]
azurerm_kusto_cluster.named_test_resource: Still creating... [30s elapsed]
azurerm_kusto_cluster.named_test_resource: Still creating... [40s elapsed]
azurerm_kusto_cluster.named_test_resource: Still creating... [50s elapsed]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 29, in data "null_data_source" "resource":
  29: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Error: creating/updating Cluster (Subscription: "d46d7416-f95f-4771-bbb5-529d4c76659c"
Resource Group Name: "turbottest74061"
Cluster Name: "turbottest74061"): performing CreateOrUpdate: clusters.ClustersClient#CreateOrUpdate: Failure sending request: StatusCode=0 -- Original Error: autorest/azure: Service returned an error. Status=<nil> Code="RequestConflict" Message="Cannot modify resource with id '/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest74061/providers/Microsoft.Kusto/Clusters/turbottest74061' because the resource entity provisioning state is not terminal. Please wait for the provisioning state to become terminal and then retry the request."

  with azurerm_kusto_cluster.named_test_resource,
  on variables.tf line 40, in resource "azurerm_kusto_cluster" "named_test_resource":
  40: resource "azurerm_kusto_cluster" "named_test_resource" {

Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_kusto_cluster


Error: waiting for the deletion of Resource Group: (Resource Group "turbottest74061"): Future#WaitForCompletion: the number of retries has been exceeded: StatusCode=409 -- Original Error: Code="ResourceGroupDeletionBlocked" Message="Deletion of resource group 'turbottest74061' failed as resources with identifiers 'Microsoft.Kusto/clusters/turbottest74061' could not be deleted. The provisioning state of the resource group will be rolled back. The tracking Id is '4a552332-81c4-04d7-9c45-8057cb4a18d5'. Please check audit logs for more details." Details=[{"message":"{\"error\":{\"code\":\"RequestConflict\",\"message\":\"Cannot modify resource with id '/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest74061/providers/Microsoft.Kusto/Clusters/turbottest74061' because the resource entity provisioning state is not terminal. Please wait for the provisioning state to become terminal and then retry the request.\"}}","target":"/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest74061/providers/Microsoft.Kusto/clusters/turbottest74061"}]

SUMMARY:

✘ tests/azure_kusto_cluster failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_lb_outbound_rule []

PRETEST: tests/azure_lb_outbound_rule

TEST: tests/azure_lb_outbound_rule
Running terraform
data.azuread_client_config.current: Reading...
data.azuread_client_config.current: Read complete after 0s [id=cdffd708-7da0-4cea-abeb-0a4c334d7f64-04b07795-8ddb-461a-bbee-02f9e1bf7b46-06fd46b0-a867-49a1-a4f1-f7768465caba]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_lb.named_test_resource will be created
  + resource "azurerm_lb" "named_test_resource" {
      + id                   = (known after apply)
      + location             = "westus"
      + name                 = "turbottest53659"
      + private_ip_address   = (known after apply)
      + private_ip_addresses = (known after apply)
      + resource_group_name  = "turbottest53659"
      + sku                  = "Standard"
      + sku_tier             = "Regional"

      + frontend_ip_configuration {
          + gateway_load_balancer_frontend_ip_configuration_id = (known after apply)
          + id                                                 = (known after apply)
          + inbound_nat_rules                                  = (known after apply)
          + load_balancer_rules                                = (known after apply)
          + name                                               = "turbottest53659"
          + outbound_rules                                     = (known after apply)
          + private_ip_address                                 = (known after apply)
          + private_ip_address_allocation                      = (known after apply)
          + private_ip_address_version                         = (known after apply)
          + public_ip_address_id                               = (known after apply)
          + public_ip_prefix_id                                = (known after apply)
          + subnet_id                                          = (known after apply)
        }
    }

  # azurerm_lb_backend_address_pool.named_test_resource will be created
  + resource "azurerm_lb_backend_address_pool" "named_test_resource" {
      + backend_ip_configurations = (known after apply)
      + id                        = (known after apply)
      + inbound_nat_rules         = (known after apply)
      + load_balancing_rules      = (known after apply)
      + loadbalancer_id           = (known after apply)
      + name                      = "turbottest53659"
      + outbound_rules            = (known after apply)
    }

  # azurerm_lb_outbound_rule.named_test_resource will be created
  + resource "azurerm_lb_outbound_rule" "named_test_resource" {
      + allocated_outbound_ports = 1024
      + backend_address_pool_id  = (known after apply)
      + enable_tcp_reset         = false
      + id                       = (known after apply)
      + idle_timeout_in_minutes  = 4
      + loadbalancer_id          = (known after apply)
      + name                     = "turbottest53659"
      + protocol                 = "Tcp"

      + frontend_ip_configuration {
          + id   = (known after apply)
          + name = "turbottest53659"
        }
    }

  # azurerm_public_ip.named_test_resource will be created
  + resource "azurerm_public_ip" "named_test_resource" {
      + allocation_method       = "Static"
      + ddos_protection_mode    = "VirtualNetworkInherited"
      + fqdn                    = (known after apply)
      + id                      = (known after apply)
      + idle_timeout_in_minutes = 4
      + ip_address              = (known after apply)
      + ip_version              = "IPv4"
      + location                = "westus"
      + name                    = "turbottest53659"
      + resource_group_name     = "turbottest53659"
      + sku                     = "Standard"
      + sku_tier                = "Regional"
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "westus"
      + name     = "turbottest53659"
    }

Plan: 5 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest53659"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 5s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53659]
azurerm_public_ip.named_test_resource: Creating...
azurerm_public_ip.named_test_resource: Still creating... [10s elapsed]
azurerm_public_ip.named_test_resource: Creation complete after 10s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53659/providers/Microsoft.Network/publicIPAddresses/turbottest53659]
azurerm_lb.named_test_resource: Creating...
azurerm_lb.named_test_resource: Creation complete after 9s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53659/providers/Microsoft.Network/loadBalancers/turbottest53659]
azurerm_lb_backend_address_pool.named_test_resource: Creating...
azurerm_lb_backend_address_pool.named_test_resource: Creation complete after 7s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53659/providers/Microsoft.Network/loadBalancers/turbottest53659/backendAddressPools/turbottest53659]
azurerm_lb_outbound_rule.named_test_resource: Creating...
azurerm_lb_outbound_rule.named_test_resource: Still creating... [10s elapsed]
azurerm_lb_outbound_rule.named_test_resource: Creation complete after 11s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53659/providers/Microsoft.Network/loadBalancers/turbottest53659/outboundRules/turbottest53659]

Apply complete! Resources: 5 added, 0 changed, 0 destroyed.

Outputs:

resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53659/providers/Microsoft.Network/loadBalancers/turbottest53659/outboundRules/turbottest53659"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest53659/providers/microsoft.network/loadbalancers/turbottest53659/outboundrules/turbottest53659"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53659/providers/Microsoft.Network/loadBalancers/turbottest53659/outboundRules/turbottest53659"
resource_name = "turbottest53659"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53659/providers/Microsoft.Network/loadBalancers/turbottest53659/outboundRules/turbottest53659",
    "load_balancer_name": "turbottest53659",
    "name": "turbottest53659",
    "resource_group": "turbottest53659",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "type": "Microsoft.Network/loadBalancers/outboundRules"
  }
]
✔ PASSED

Running SQL query: test-list-query.sql
null
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53659/providers/Microsoft.Network/loadBalancers/turbottest53659/outboundRules/turbottest53659",
    "name": "turbottest53659"
  }
]

✘ FAILED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
null
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53659/providers/Microsoft.Network/loadBalancers/turbottest53659/outboundRules/turbottest53659",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest53659/providers/microsoft.network/loadbalancers/turbottest53659/outboundrules/turbottest53659"
    ],
    "name": "turbottest53659",
    "title": "turbottest53659"
  }
]

✘ FAILED

TEARDOWN: tests/azure_lb_outbound_rule

SUMMARY:

✘ tests/azure_lb_outbound_rule failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_log_alert []

PRETEST: tests/azure_log_alert

TEST: tests/azure_log_alert
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_monitor_action_group.named_test_resource will be created
  + resource "azurerm_monitor_action_group" "named_test_resource" {
      + enabled             = true
      + id                  = (known after apply)
      + location            = "global"
      + name                = "turbottest53472"
      + resource_group_name = "turbottest53472"
      + short_name          = "p0action"

      + webhook_receiver {
          + name        = "callmyapi"
          + service_uri = "http://example.com/alert"
        }
    }

  # azurerm_monitor_activity_log_alert.named_test_resource will be created
  + resource "azurerm_monitor_activity_log_alert" "named_test_resource" {
      + description         = "This alert will monitor a specific storage account updates."
      + enabled             = true
      + id                  = (known after apply)
      + name                = "turbottest53472"
      + resource_group_name = "turbottest53472"
      + scopes              = (known after apply)

      + action {
          + action_group_id    = (known after apply)
          + webhook_properties = {
              + "from" = "terraform"
            }
        }

      + criteria {
          + category       = "Recommendation"
          + operation_name = "Microsoft.Storage/storageAccounts/write"
          + resource_id    = (known after apply)

          + resource_health {
              + current  = (known after apply)
              + previous = (known after apply)
              + reason   = (known after apply)
            }

          + service_health {
              + events    = (known after apply)
              + locations = (known after apply)
              + services  = (known after apply)
            }
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "westus"
      + name     = "turbottest53472"
    }

  # azurerm_storage_account.named_test_resource will be created
  + resource "azurerm_storage_account" "named_test_resource" {
      + access_tier                       = (known after apply)
      + account_kind                      = "StorageV2"
      + account_replication_type          = "LRS"
      + account_tier                      = "Standard"
      + allow_nested_items_to_be_public   = true
      + cross_tenant_replication_enabled  = true
      + default_to_oauth_authentication   = false
      + enable_https_traffic_only         = true
      + id                                = (known after apply)
      + infrastructure_encryption_enabled = false
      + is_hns_enabled                    = false
      + large_file_share_enabled          = (known after apply)
      + location                          = "westus"
      + min_tls_version                   = "TLS1_2"
      + name                              = "turbottest53472"
      + nfsv3_enabled                     = false
      + primary_access_key                = (sensitive value)
      + primary_blob_connection_string    = (sensitive value)
      + primary_blob_endpoint             = (known after apply)
      + primary_blob_host                 = (known after apply)
      + primary_connection_string         = (sensitive value)
      + primary_dfs_endpoint              = (known after apply)
      + primary_dfs_host                  = (known after apply)
      + primary_file_endpoint             = (known after apply)
      + primary_file_host                 = (known after apply)
      + primary_location                  = (known after apply)
      + primary_queue_endpoint            = (known after apply)
      + primary_queue_host                = (known after apply)
      + primary_table_endpoint            = (known after apply)
      + primary_table_host                = (known after apply)
      + primary_web_endpoint              = (known after apply)
      + primary_web_host                  = (known after apply)
      + public_network_access_enabled     = true
      + queue_encryption_key_type         = "Service"
      + resource_group_name               = "turbottest53472"
      + secondary_access_key              = (sensitive value)
      + secondary_blob_connection_string  = (sensitive value)
      + secondary_blob_endpoint           = (known after apply)
      + secondary_blob_host               = (known after apply)
      + secondary_connection_string       = (sensitive value)
      + secondary_dfs_endpoint            = (known after apply)
      + secondary_dfs_host                = (known after apply)
      + secondary_file_endpoint           = (known after apply)
      + secondary_file_host               = (known after apply)
      + secondary_location                = (known after apply)
      + secondary_queue_endpoint          = (known after apply)
      + secondary_queue_host              = (known after apply)
      + secondary_table_endpoint          = (known after apply)
      + secondary_table_host              = (known after apply)
      + secondary_web_endpoint            = (known after apply)
      + secondary_web_host                = (known after apply)
      + sftp_enabled                      = false
      + shared_access_key_enabled         = true
      + table_encryption_key_type         = "Service"

      + blob_properties {
          + change_feed_enabled           = (known after apply)
          + change_feed_retention_in_days = (known after apply)
          + default_service_version       = (known after apply)
          + last_access_time_enabled      = (known after apply)
          + versioning_enabled            = (known after apply)

          + container_delete_retention_policy {
              + days = (known after apply)
            }

          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + delete_retention_policy {
              + days = (known after apply)
            }

          + restore_policy {
              + days = (known after apply)
            }
        }

      + network_rules {
          + bypass                     = (known after apply)
          + default_action             = (known after apply)
          + ip_rules                   = (known after apply)
          + virtual_network_subnet_ids = (known after apply)

          + private_link_access {
              + endpoint_resource_id = (known after apply)
              + endpoint_tenant_id   = (known after apply)
            }
        }

      + queue_properties {
          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + hour_metrics {
              + enabled               = (known after apply)
              + include_apis          = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
            }

          + logging {
              + delete                = (known after apply)
              + read                  = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
              + write                 = (known after apply)
            }

          + minute_metrics {
              + enabled               = (known after apply)
              + include_apis          = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
            }
        }

      + routing {
          + choice                      = (known after apply)
          + publish_internet_endpoints  = (known after apply)
          + publish_microsoft_endpoints = (known after apply)
        }

      + share_properties {
          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + retention_policy {
              + days = (known after apply)
            }

          + smb {
              + authentication_types            = (known after apply)
              + channel_encryption_type         = (known after apply)
              + kerberos_ticket_encryption_type = (known after apply)
              + multichannel_enabled            = (known after apply)
              + versions                        = (known after apply)
            }
        }
    }

Plan: 4 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest53472"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 3s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53472]
azurerm_monitor_action_group.named_test_resource: Creating...
azurerm_storage_account.named_test_resource: Creating...
azurerm_monitor_action_group.named_test_resource: Creation complete after 8s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53472/providers/Microsoft.Insights/actionGroups/turbottest53472]
azurerm_storage_account.named_test_resource: Still creating... [10s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [20s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [30s elapsed]
azurerm_storage_account.named_test_resource: Creation complete after 34s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53472/providers/Microsoft.Storage/storageAccounts/turbottest53472]
azurerm_monitor_activity_log_alert.named_test_resource: Creating...
azurerm_monitor_activity_log_alert.named_test_resource: Creation complete after 8s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53472/providers/Microsoft.Insights/activityLogAlerts/turbottest53472]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 26, in data "null_data_source" "resource":
  26: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Apply complete! Resources: 4 added, 0 changed, 0 destroyed.

Outputs:

resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53472/providers/Microsoft.Insights/activityLogAlerts/turbottest53472"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest53472/providers/microsoft.insights/activitylogalerts/turbottest53472"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53472/providers/Microsoft.Insights/activityLogAlerts/turbottest53472"
resource_name = "turbottest53472"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53472/providers/microsoft.insights/activityLogAlerts/turbottest53472",
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53472/providers/Microsoft.Insights/activityLogAlerts/turbottest53472",
    "name": "turbottest53472",
    "region": "global",
    "type": "Microsoft.Insights/ActivityLogAlerts"
  }
]

✘ FAILED

Running SQL query: test-hydrate-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53472/providers/microsoft.insights/activityLogAlerts/turbottest53472",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53472/providers/Microsoft.Insights/activityLogAlerts/turbottest53472",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest53472/providers/microsoft.insights/activitylogalerts/turbottest53472"
    ],
    "name": "turbottest53472",
    "title": "turbottest53472"
  }
]

✘ FAILED

Running SQL query: test-list-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53472/providers/microsoft.insights/activityLogAlerts/turbottest53472",
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53472/providers/Microsoft.Insights/activityLogAlerts/turbottest53472",
    "name": "turbottest53472"
  }
]

✘ FAILED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53472/providers/microsoft.insights/activityLogAlerts/turbottest53472",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest53472/providers/Microsoft.Insights/activityLogAlerts/turbottest53472",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest53472/providers/microsoft.insights/activitylogalerts/turbottest53472"
    ],
    "name": "turbottest53472",
    "title": "turbottest53472"
  }
]

✘ FAILED

TEARDOWN: tests/azure_log_alert

SUMMARY:

✘ tests/azure_log_alert failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_log_profile []

PRETEST: tests/azure_log_profile

TEST: tests/azure_log_profile
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_eventhub_namespace.named_test_resource will be created
  + resource "azurerm_eventhub_namespace" "named_test_resource" {
      + auto_inflate_enabled                      = false
      + capacity                                  = 2
      + default_primary_connection_string         = (sensitive value)
      + default_primary_connection_string_alias   = (sensitive value)
      + default_primary_key                       = (sensitive value)
      + default_secondary_connection_string       = (sensitive value)
      + default_secondary_connection_string_alias = (sensitive value)
      + default_secondary_key                     = (sensitive value)
      + id                                        = (known after apply)
      + local_authentication_enabled              = true
      + location                                  = "westus"
      + maximum_throughput_units                  = (known after apply)
      + minimum_tls_version                       = (known after apply)
      + name                                      = "turbottest33996"
      + network_rulesets                          = (known after apply)
      + public_network_access_enabled             = true
      + resource_group_name                       = "turbottest33996"
      + sku                                       = "Standard"
      + zone_redundant                            = false
    }

  # azurerm_monitor_log_profile.named_test_resource will be created
  + resource "azurerm_monitor_log_profile" "named_test_resource" {
      + categories         = [
          + "Action",
          + "Delete",
          + "Write",
        ]
      + id                 = (known after apply)
      + locations          = [
          + "global",
          + "westus",
        ]
      + name               = "turbottest33996"
      + servicebus_rule_id = (known after apply)
      + storage_account_id = (known after apply)

      + retention_policy {
          + days    = 7
          + enabled = true
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "westus"
      + name     = "turbottest33996"
    }

  # azurerm_storage_account.named_test_resource will be created
  + resource "azurerm_storage_account" "named_test_resource" {
      + access_tier                       = (known after apply)
      + account_kind                      = "StorageV2"
      + account_replication_type          = "LRS"
      + account_tier                      = "Standard"
      + allow_nested_items_to_be_public   = true
      + cross_tenant_replication_enabled  = true
      + default_to_oauth_authentication   = false
      + enable_https_traffic_only         = true
      + id                                = (known after apply)
      + infrastructure_encryption_enabled = false
      + is_hns_enabled                    = false
      + large_file_share_enabled          = (known after apply)
      + location                          = "westus"
      + min_tls_version                   = "TLS1_2"
      + name                              = "turbottest33996"
      + nfsv3_enabled                     = false
      + primary_access_key                = (sensitive value)
      + primary_blob_connection_string    = (sensitive value)
      + primary_blob_endpoint             = (known after apply)
      + primary_blob_host                 = (known after apply)
      + primary_connection_string         = (sensitive value)
      + primary_dfs_endpoint              = (known after apply)
      + primary_dfs_host                  = (known after apply)
      + primary_file_endpoint             = (known after apply)
      + primary_file_host                 = (known after apply)
      + primary_location                  = (known after apply)
      + primary_queue_endpoint            = (known after apply)
      + primary_queue_host                = (known after apply)
      + primary_table_endpoint            = (known after apply)
      + primary_table_host                = (known after apply)
      + primary_web_endpoint              = (known after apply)
      + primary_web_host                  = (known after apply)
      + public_network_access_enabled     = true
      + queue_encryption_key_type         = "Service"
      + resource_group_name               = "turbottest33996"
      + secondary_access_key              = (sensitive value)
      + secondary_blob_connection_string  = (sensitive value)
      + secondary_blob_endpoint           = (known after apply)
      + secondary_blob_host               = (known after apply)
      + secondary_connection_string       = (sensitive value)
      + secondary_dfs_endpoint            = (known after apply)
      + secondary_dfs_host                = (known after apply)
      + secondary_file_endpoint           = (known after apply)
      + secondary_file_host               = (known after apply)
      + secondary_location                = (known after apply)
      + secondary_queue_endpoint          = (known after apply)
      + secondary_queue_host              = (known after apply)
      + secondary_table_endpoint          = (known after apply)
      + secondary_table_host              = (known after apply)
      + secondary_web_endpoint            = (known after apply)
      + secondary_web_host                = (known after apply)
      + sftp_enabled                      = false
      + shared_access_key_enabled         = true
      + table_encryption_key_type         = "Service"

      + blob_properties {
          + change_feed_enabled           = (known after apply)
          + change_feed_retention_in_days = (known after apply)
          + default_service_version       = (known after apply)
          + last_access_time_enabled      = (known after apply)
          + versioning_enabled            = (known after apply)

          + container_delete_retention_policy {
              + days = (known after apply)
            }

          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + delete_retention_policy {
              + days = (known after apply)
            }

          + restore_policy {
              + days = (known after apply)
            }
        }

      + network_rules {
          + bypass                     = (known after apply)
          + default_action             = (known after apply)
          + ip_rules                   = (known after apply)
          + virtual_network_subnet_ids = (known after apply)

          + private_link_access {
              + endpoint_resource_id = (known after apply)
              + endpoint_tenant_id   = (known after apply)
            }
        }

      + queue_properties {
          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + hour_metrics {
              + enabled               = (known after apply)
              + include_apis          = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
            }

          + logging {
              + delete                = (known after apply)
              + read                  = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
              + write                 = (known after apply)
            }

          + minute_metrics {
              + enabled               = (known after apply)
              + include_apis          = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
            }
        }

      + routing {
          + choice                      = (known after apply)
          + publish_internet_endpoints  = (known after apply)
          + publish_microsoft_endpoints = (known after apply)
        }

      + share_properties {
          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + retention_policy {
              + days = (known after apply)
            }

          + smb {
              + authentication_types            = (known after apply)
              + channel_encryption_type         = (known after apply)
              + kerberos_ticket_encryption_type = (known after apply)
              + multichannel_enabled            = (known after apply)
              + versions                        = (known after apply)
            }
        }
    }

Plan: 4 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest33996"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 5s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest33996]
azurerm_eventhub_namespace.named_test_resource: Creating...
azurerm_storage_account.named_test_resource: Creating...
azurerm_eventhub_namespace.named_test_resource: Still creating... [10s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [10s elapsed]
azurerm_eventhub_namespace.named_test_resource: Still creating... [20s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [20s elapsed]
azurerm_eventhub_namespace.named_test_resource: Still creating... [30s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [30s elapsed]
azurerm_storage_account.named_test_resource: Creation complete after 34s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest33996/providers/Microsoft.Storage/storageAccounts/turbottest33996]
azurerm_eventhub_namespace.named_test_resource: Still creating... [40s elapsed]
azurerm_eventhub_namespace.named_test_resource: Still creating... [50s elapsed]
azurerm_eventhub_namespace.named_test_resource: Still creating... [1m0s elapsed]
azurerm_eventhub_namespace.named_test_resource: Still creating... [1m10s elapsed]
azurerm_eventhub_namespace.named_test_resource: Creation complete after 1m18s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest33996/providers/Microsoft.EventHub/namespaces/turbottest33996]
azurerm_monitor_log_profile.named_test_resource: Creating...

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 26, in data "null_data_source" "resource":
  26: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Error: creating/updating Monitor Log Profile: (Name "turbottest33996"): insights.LogProfilesClient#CreateOrUpdate: Failure sending request: StatusCode=409 -- Original Error: autorest/azure: Service returned an error. Status=<nil> <nil>

  with azurerm_monitor_log_profile.named_test_resource,
  on variables.tf line 53, in resource "azurerm_monitor_log_profile" "named_test_resource":
  53: resource "azurerm_monitor_log_profile" "named_test_resource" {

Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_log_profile

SUMMARY:

✘ tests/azure_log_profile failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_mssql_elasticpool []

PRETEST: tests/azure_mssql_elasticpool

TEST: tests/azure_mssql_elasticpool
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_mssql_elasticpool.named_test_resource will be created
  + resource "azurerm_mssql_elasticpool" "named_test_resource" {
      + id                             = (known after apply)
      + license_type                   = (known after apply)
      + location                       = "eastus"
      + maintenance_configuration_name = "SQL_Default"
      + max_size_bytes                 = (known after apply)
      + max_size_gb                    = 4.8828125
      + name                           = "turbottest14057"
      + resource_group_name            = "turbottest14057"
      + server_name                    = "turbottest14057"

      + per_database_settings {
          + max_capacity = 5
          + min_capacity = 0
        }

      + sku {
          + capacity = 50
          + name     = "BasicPool"
          + tier     = "Basic"
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "eastus"
      + name     = "turbottest14057"
    }

  # azurerm_sql_server.named_test_resource will be created
  + resource "azurerm_sql_server" "named_test_resource" {
      + administrator_login          = "4dm1n157r470r"
      + administrator_login_password = (sensitive value)
      + connection_policy            = "Default"
      + fully_qualified_domain_name  = (known after apply)
      + id                           = (known after apply)
      + location                     = "eastus"
      + name                         = "turbottest14057"
      + resource_group_name          = "turbottest14057"
      + version                      = "12.0"

      + threat_detection_policy {
          + disabled_alerts            = (known after apply)
          + email_account_admins       = (known after apply)
          + email_addresses            = (known after apply)
          + retention_days             = (known after apply)
          + state                      = (known after apply)
          + storage_account_access_key = (sensitive value)
          + storage_endpoint           = (known after apply)
        }
    }

Plan: 3 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest14057"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 4s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest14057]
azurerm_sql_server.named_test_resource: Creating...
azurerm_sql_server.named_test_resource: Still creating... [10s elapsed]
azurerm_sql_server.named_test_resource: Still creating... [20s elapsed]
azurerm_sql_server.named_test_resource: Still creating... [30s elapsed]
azurerm_sql_server.named_test_resource: Still creating... [40s elapsed]
azurerm_sql_server.named_test_resource: Still creating... [50s elapsed]
azurerm_sql_server.named_test_resource: Creation complete after 58s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest14057/providers/Microsoft.Sql/servers/turbottest14057]
azurerm_mssql_elasticpool.named_test_resource: Creating...
azurerm_mssql_elasticpool.named_test_resource: Still creating... [10s elapsed]
azurerm_mssql_elasticpool.named_test_resource: Still creating... [20s elapsed]
azurerm_mssql_elasticpool.named_test_resource: Still creating... [30s elapsed]
azurerm_mssql_elasticpool.named_test_resource: Still creating... [40s elapsed]
azurerm_mssql_elasticpool.named_test_resource: Creation complete after 50s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest14057/providers/Microsoft.Sql/servers/turbottest14057/elasticPools/turbottest14057]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 28, in data "null_data_source" "resource":
  28: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Warning: Deprecated Resource

  with azurerm_sql_server.named_test_resource,
  on variables.tf line 39, in resource "azurerm_sql_server" "named_test_resource":
  39: resource "azurerm_sql_server" "named_test_resource" {

The `azurerm_sql_server` resource is deprecated and will be removed in
version 4.0 of the AzureRM provider. Please use the `azurerm_mssql_server`
resource instead.

(and 2 more similar warnings elsewhere)

Apply complete! Resources: 3 added, 0 changed, 0 destroyed.

Outputs:

resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest14057/providers/Microsoft.Sql/servers/turbottest14057/elasticPools/turbottest14057"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest14057/providers/microsoft.sql/servers/turbottest14057/elasticpools/turbottest14057"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest14057/providers/Microsoft.Sql/servers/turbottest14057/elasticPools/turbottest14057"
resource_name = "turbottest14057"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest14057/providers/Microsoft.Sql/servers/turbottest14057/elasticPools/turbottest14057",
    "name": "turbottest14057",
    "resource_group": "turbottest14057",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "type": "Microsoft.Sql/servers/elasticPools"
  }
]
✔ PASSED

Running SQL query: test-list-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest14057/providers/Microsoft.Sql/servers/turbottest14057/elasticPools/turbottest14057",
    "name": "turbottest14057",
    "type": "Microsoft.Sql/servers/elasticPools"
  }
]
✔ PASSED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
null
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest14057/providers/Microsoft.Sql/servers/turbottest14057/elasticPools/turbottest14057",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest14057/providers/microsoft.sql/servers/turbottest14057/elasticpools/turbottest14057"
    ],
    "name": "turbottest14057",
    "title": "turbottest14057"
  }
]

✘ FAILED

TEARDOWN: tests/azure_mssql_elasticpool

SUMMARY:

✘ tests/azure_mssql_elasticpool failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_network_interface []

PRETEST: tests/azure_network_interface

TEST: tests/azure_network_interface
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_network_interface.named_test_resource will be created
  + resource "azurerm_network_interface" "named_test_resource" {
      + applied_dns_servers           = (known after apply)
      + dns_servers                   = (known after apply)
      + enable_accelerated_networking = false
      + enable_ip_forwarding          = false
      + id                            = (known after apply)
      + internal_dns_name_label       = (known after apply)
      + internal_domain_name_suffix   = (known after apply)
      + location                      = "westus"
      + mac_address                   = (known after apply)
      + name                          = "turbottest49520"
      + private_ip_address            = (known after apply)
      + private_ip_addresses          = (known after apply)
      + resource_group_name           = "turbottest49520"
      + tags                          = {
          + "name" = "turbottest49520"
        }
      + virtual_machine_id            = (known after apply)

      + ip_configuration {
          + gateway_load_balancer_frontend_ip_configuration_id = (known after apply)
          + name                                               = "turbottest49520"
          + primary                                            = (known after apply)
          + private_ip_address                                 = (known after apply)
          + private_ip_address_allocation                      = "Dynamic"
          + private_ip_address_version                         = "IPv4"
          + subnet_id                                          = (known after apply)
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "westus"
      + name     = "turbottest49520"
    }

  # azurerm_subnet.named_test_resource will be created
  + resource "azurerm_subnet" "named_test_resource" {
      + address_prefixes                               = [
          + "10.0.2.0/24",
        ]
      + enforce_private_link_endpoint_network_policies = (known after apply)
      + enforce_private_link_service_network_policies  = (known after apply)
      + id                                             = (known after apply)
      + name                                           = "turbottest49520"
      + private_endpoint_network_policies_enabled      = (known after apply)
      + private_link_service_network_policies_enabled  = (known after apply)
      + resource_group_name                            = "turbottest49520"
      + virtual_network_name                           = "turbottest49520"
    }

  # azurerm_virtual_network.named_test_resource will be created
  + resource "azurerm_virtual_network" "named_test_resource" {
      + address_space       = [
          + "10.0.0.0/16",
        ]
      + dns_servers         = (known after apply)
      + guid                = (known after apply)
      + id                  = (known after apply)
      + location            = "westus"
      + name                = "turbottest49520"
      + resource_group_name = "turbottest49520"
      + subnet              = (known after apply)
    }

Plan: 4 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest49520"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 5s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest49520]
azurerm_virtual_network.named_test_resource: Creating...
azurerm_virtual_network.named_test_resource: Still creating... [10s elapsed]
azurerm_virtual_network.named_test_resource: Creation complete after 12s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest49520/providers/Microsoft.Network/virtualNetworks/turbottest49520]
azurerm_subnet.named_test_resource: Creating...
azurerm_subnet.named_test_resource: Still creating... [10s elapsed]
azurerm_subnet.named_test_resource: Creation complete after 10s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest49520/providers/Microsoft.Network/virtualNetworks/turbottest49520/subnets/turbottest49520]
azurerm_network_interface.named_test_resource: Creating...
azurerm_network_interface.named_test_resource: Creation complete after 8s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest49520/providers/Microsoft.Network/networkInterfaces/turbottest49520]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 29, in data "null_data_source" "resource":
  29: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Apply complete! Resources: 4 added, 0 changed, 0 destroyed.

Outputs:

resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest49520/providers/Microsoft.Network/networkInterfaces/turbottest49520"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest49520/providers/microsoft.network/networkinterfaces/turbottest49520"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest49520/providers/Microsoft.Network/networkInterfaces/turbottest49520"
resource_name = "turbottest49520"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "enable_accelerated_networking": false,
    "enable_ip_forwarding": false,
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest49520/providers/Microsoft.Network/networkInterfaces/turbottest49520",
    "ip_configurations": [
      {
        "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest49520/providers/Microsoft.Network/networkInterfaces/turbottest49520/ipConfigurations/turbottest49520",
        "name": "turbottest49520",
        "properties": {
          "primary": true,
          "privateIPAddress": "10.0.2.4",
          "privateIPAddressVersion": "IPv4",
          "privateIPAllocationMethod": "Dynamic",
          "subnet": {
            "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest49520/providers/Microsoft.Network/virtualNetworks/turbottest49520/subnets/turbottest49520"
            "id": "/subscriptions/d7245080-b4ae-4fe5-b6fa-2e71b3dae6c8/resourceGroups/turbottest49520/providers/Microsoft.Network/virtualNetworks/turbottest49520/subnets/turbottest49520"
          }
        }
      }
    ],
    "name": "turbottest49520",
    "region": "westus",
    "resource_group": "turbottest49520",
    "type": "Microsoft.Network/networkInterfaces"
  }
]

✘ FAILED

Running SQL query: test-hydrate-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest49520/providers/Microsoft.Network/networkInterfaces/turbottest49520",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest49520/providers/microsoft.network/networkinterfaces/turbottest49520"
    ],
    "name": "turbottest49520",
    "tags": {
      "name": "turbottest49520"
    },
    "title": "turbottest49520"
  }
]
✔ PASSED

Running SQL query: test-list-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest49520/providers/Microsoft.Network/networkInterfaces/turbottest49520",
    "name": "turbottest49520"
  }
]
✔ PASSED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest49520/providers/Microsoft.Network/networkInterfaces/turbottest49520",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest49520/providers/microsoft.network/networkinterfaces/turbottest49520"
    ],
    "name": "turbottest49520",
    "tags": {
      "name": "turbottest49520"
    },
    "title": "turbottest49520"
  }
]
✔ PASSED

TEARDOWN: tests/azure_network_interface

SUMMARY:

✘ tests/azure_network_interface failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_network_security_group []

PRETEST: tests/azure_network_security_group

TEST: tests/azure_network_security_group
Running terraform
data.azuread_client_config.current: Reading...
data.azuread_client_config.current: Read complete after 0s [id=cdffd708-7da0-4cea-abeb-0a4c334d7f64-04b07795-8ddb-461a-bbee-02f9e1bf7b46-06fd46b0-a867-49a1-a4f1-f7768465caba]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_network_security_group.named_test_resource will be created
  + resource "azurerm_network_security_group" "named_test_resource" {
      + id                  = (known after apply)
      + location            = "westus"
      + name                = "turbottest46840"
      + resource_group_name = "turbottest46840"
      + security_rule       = [
          + {
              + access                                     = "Allow"
              + description                                = ""
              + destination_address_prefix                 = "*"
              + destination_address_prefixes               = []
              + destination_application_security_group_ids = []
              + destination_port_range                     = "*"
              + destination_port_ranges                    = []
              + direction                                  = "Inbound"
              + name                                       = "turbottest46840"
              + priority                                   = 100
              + protocol                                   = "Tcp"
              + source_address_prefix                      = "*"
              + source_address_prefixes                    = []
              + source_application_security_group_ids      = []
              + source_port_range                          = "*"
              + source_port_ranges                         = []
            },
        ]
      + tags                = {
          + "name" = "turbottest46840"
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "westus"
      + name     = "turbottest46840"
    }

Plan: 2 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest46840"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 3s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46840]
azurerm_network_security_group.named_test_resource: Creating...
azurerm_network_security_group.named_test_resource: Still creating... [10s elapsed]
azurerm_network_security_group.named_test_resource: Creation complete after 10s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46840/providers/Microsoft.Network/networkSecurityGroups/turbottest46840]

Apply complete! Resources: 2 added, 0 changed, 0 destroyed.

Outputs:

resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46840/providers/Microsoft.Network/networkSecurityGroups/turbottest46840"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest46840/providers/microsoft.network/networksecuritygroups/turbottest46840"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46840/providers/Microsoft.Network/networkSecurityGroups/turbottest46840"
resource_name = "turbottest46840"

Running SQL query: test-get-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46840/providers/Microsoft.Network/networkSecurityGroups/turbottest46840",
    "name": "turbottest46840",
    "region": "westus",
    "resource_group": "turbottest46840",
    "security_rules": [
      {
        "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46840/providers/Microsoft.Network/networkSecurityGroups/turbottest46840/securityRules/turbottest46840",
        "name": "turbottest46840",
        "properties": {
          "access": "Allow",
          "destinationAddressPrefix": "*",
          "destinationAddressPrefixes": [],
          "destinationPortRange": "*",
          "destinationPortRanges": [],
          "direction": "Inbound",
          "priority": 100,
          "protocol": "Tcp",
          "sourceAddressPrefix": "*",
          "sourceAddressPrefixes": [],
          "sourcePortRange": "*",
          "sourcePortRanges": []
        }
      }
    ],
    "type": "Microsoft.Network/networkSecurityGroups"
  }
]
✔ PASSED

Running SQL query: test-hydrate-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46840/providers/Microsoft.Network/networkSecurityGroups/turbottest46840",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest46840/providers/microsoft.network/networksecuritygroups/turbottest46840"
    ],
    "name": "turbottest46840"
  }
]
✔ PASSED

Running SQL query: test-list-query.sql
null
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46840/providers/Microsoft.Network/networkSecurityGroups/turbottest46840",
    "name": "turbottest46840"
  }
]

✘ FAILED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46840/providers/Microsoft.Network/networkSecurityGroups/turbottest46840",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest46840/providers/microsoft.network/networksecuritygroups/turbottest46840"
    ],
    "name": "turbottest46840",
    "tags": {
      "name": "turbottest46840"
    },
    "title": "turbottest46840"
  }
]
✔ PASSED

TEARDOWN: tests/azure_network_security_group

SUMMARY:

✘ tests/azure_network_security_group failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_network_watcher []

PRETEST: tests/azure_network_watcher

TEST: tests/azure_network_watcher
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_network_watcher.named_test_resource will be created
  + resource "azurerm_network_watcher" "named_test_resource" {
      + id                  = (known after apply)
      + location            = "eastus"
      + name                = "turbottest48053"
      + resource_group_name = "turbottest48053"
      + tags                = {
          + "name" = "turbottest48053"
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "eastus"
      + name     = "turbottest48053"
    }

Plan: 2 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest48053"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 2s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest48053]
azurerm_network_watcher.named_test_resource: Creating...

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 28, in data "null_data_source" "resource":
  28: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Error: network.WatchersClient#CreateOrUpdate: Failure responding to request: StatusCode=400 -- Original Error: autorest/azure: Service returned an error. Status=400 Code="NetworkWatcherCountLimitReached" Message="Cannot create more than 1 network watchers for this subscription in this region." Details=[]

  with azurerm_network_watcher.named_test_resource,
  on variables.tf line 41, in resource "azurerm_network_watcher" "named_test_resource":
  41: resource "azurerm_network_watcher" "named_test_resource" {

Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_network_watcher

SUMMARY:

✘ tests/azure_network_watcher failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_network_watcher_flow_log []

PRETEST: tests/azure_network_watcher_flow_log

TEST: tests/azure_network_watcher_flow_log
Running terraform

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 28, in data "null_data_source" "resource":
  28: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

Error: Missing required argument

  on variables.tf line 71, in resource "azurerm_network_watcher_flow_log" "named_test_resource":
  71: resource "azurerm_network_watcher_flow_log" "named_test_resource" {

The argument "name" is required, but no definition was found.
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_network_watcher_flow_log


Error: Missing required argument

  on variables.tf line 71, in resource "azurerm_network_watcher_flow_log" "named_test_resource":
  71: resource "azurerm_network_watcher_flow_log" "named_test_resource" {

The argument "name" is required, but no definition was found.
SUMMARY:

✘ tests/azure_network_watcher_flow_log failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_policy_assignment []

PRETEST: tests/azure_policy_assignment

TEST: tests/azure_policy_assignment
Running terraform

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 29, in data "null_data_source" "resource":
  29: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

Error: Invalid resource type

  on variables.tf line 72, in resource "azurerm_policy_assignment" "named_test_resource":
  72: resource "azurerm_policy_assignment" "named_test_resource" {

The provider hashicorp/azurerm does not support resource type
"azurerm_policy_assignment".

Did you intend to use the data source "azurerm_policy_assignment"? If so,
declare this using a "data" block instead of a "resource" block.
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_policy_assignment


Error: Invalid resource type

  on variables.tf line 72, in resource "azurerm_policy_assignment" "named_test_resource":
  72: resource "azurerm_policy_assignment" "named_test_resource" {

The provider hashicorp/azurerm does not support resource type
"azurerm_policy_assignment".

Did you intend to use the data source "azurerm_policy_assignment"? If so,
declare this using a "data" block instead of a "resource" block.
SUMMARY:

✘ tests/azure_policy_assignment failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_provider []

PRETEST: tests/azure_provider

TEST: tests/azure_provider
Running terraform

Warning: Version constraints inside provider configuration blocks are deprecated

  on variables.tf line 16, in provider "azuread":
  16:   version         = "=0.10.0"

Terraform 0.13 and earlier allowed provider version constraints inside the
provider configuration block, but that is now deprecated and will be removed
in a future version of Terraform. To silence this warning, move the provider
version constraint into the required_providers block.

Error: Error building AzureAD Client: Error populating Client ID from the Azure CLI: No Authorization Tokens were found - please ensure the Azure CLI is installed and then log-in with `az login`.

  with provider["registry.terraform.io/hashicorp/azuread"],
  on variables.tf line 14, in provider "azuread":
  14: provider "azuread" {

Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_provider


Error: Error building AzureAD Client: Error populating Client ID from the Azure CLI: No Authorization Tokens were found - please ensure the Azure CLI is installed and then log-in with `az login`.

  with provider["registry.terraform.io/hashicorp/azuread"],
  on variables.tf line 14, in provider "azuread":
  14: provider "azuread" {

SUMMARY:

✘ tests/azure_provider failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_redis_cache []

PRETEST: tests/azure_redis_cache

TEST: tests/azure_redis_cache
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_redis_cache.named_test_resource will be created
  + resource "azurerm_redis_cache" "named_test_resource" {
      + capacity                      = 0
      + enable_non_ssl_port           = false
      + family                        = "C"
      + hostname                      = (known after apply)
      + id                            = (known after apply)
      + location                      = "eastus"
      + minimum_tls_version           = "1.2"
      + name                          = "turbottest46545"
      + port                          = (known after apply)
      + primary_access_key            = (sensitive value)
      + primary_connection_string     = (sensitive value)
      + private_static_ip_address     = (known after apply)
      + public_network_access_enabled = true
      + redis_version                 = (known after apply)
      + replicas_per_master           = (known after apply)
      + replicas_per_primary          = (known after apply)
      + resource_group_name           = "turbottest46545"
      + secondary_access_key          = (sensitive value)
      + secondary_connection_string   = (sensitive value)
      + sku_name                      = "Basic"
      + ssl_port                      = (known after apply)
      + tags                          = {
          + "name" = "turbottest46545"
        }

      + redis_configuration {
          + enable_authentication           = true
          + maxclients                      = (known after apply)
          + maxfragmentationmemory_reserved = (known after apply)
          + maxmemory_delta                 = (known after apply)
          + maxmemory_policy                = "volatile-lru"
          + maxmemory_reserved              = (known after apply)
        }
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "eastus"
      + name     = "turbottest46545"
    }

Plan: 2 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + location           = "eastus"
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest46545"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 3s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46545]
azurerm_redis_cache.named_test_resource: Creating...
azurerm_redis_cache.named_test_resource: Still creating... [10s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [20s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [30s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [40s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [50s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [1m0s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [1m10s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [1m20s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [1m30s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [1m40s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [1m50s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [2m0s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [2m10s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [2m20s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [2m30s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [2m40s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [2m50s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [3m0s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [3m10s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [3m20s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [3m30s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [3m40s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [3m50s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [4m0s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [4m10s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [4m20s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [4m30s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [4m40s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [4m50s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [5m0s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [5m10s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [5m20s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [5m30s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [5m40s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [5m50s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [6m0s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [6m10s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [6m20s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [6m30s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [6m40s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [6m50s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [7m0s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [7m10s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [7m20s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [7m30s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [7m40s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [7m50s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [8m0s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [8m10s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [8m20s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [8m30s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [8m40s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [8m50s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [9m0s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [9m10s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [9m20s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [9m30s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [9m40s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [9m50s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [10m0s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [10m10s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [10m20s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [10m30s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [10m40s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [10m50s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [11m0s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [11m10s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [11m20s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [11m30s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [11m40s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [11m50s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [12m0s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [12m10s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [12m20s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [12m30s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [12m40s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [12m50s elapsed]
azurerm_redis_cache.named_test_resource: Still creating... [13m0s elapsed]
azurerm_redis_cache.named_test_resource: Creation complete after 13m2s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46545/providers/Microsoft.Cache/redis/turbottest46545]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 28, in data "null_data_source" "resource":
  28: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Apply complete! Resources: 2 added, 0 changed, 0 destroyed.

Outputs:

location = "eastus"
resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46545/providers/Microsoft.Cache/redis/turbottest46545"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest46545/providers/microsoft.cache/redis/turbottest46545"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46545/providers/Microsoft.Cache/redis/turbottest46545"
resource_name = "turbottest46545"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "enable_non_ssl_port": false,
    "host_name": "turbottest46545.redis.cache.windows.net",
    "minimum_tls_version": "1.2",
    "name": "turbottest46545",
    "public_network_access": "Enabled",
    "redis_version": "6.0.14",
    "redis_version": "4.0.14",
    "region": "eastus",
    "resource_group": "turbottest46545",
    "sku_capacity": 0,
    "sku_family": "C",
    "sku_name": "Basic",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "type": "Microsoft.Cache/Redis"
  }
]

✘ FAILED

Running SQL query: test-list-query.sql
null
[
  {
    "name": "turbottest46545",
    "type": "Microsoft.Cache/Redis"
  }
]

✘ FAILED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46545/providers/Microsoft.Cache/Redis/turbottest46545",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest46545/providers/Microsoft.Cache/redis/turbottest46545",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest46545/providers/microsoft.cache/redis/turbottest46545"
    ],
    "name": "turbottest46545",
    "tags": {
      "name": "turbottest46545"
    },
    "title": "turbottest46545"
  }
]

✘ FAILED

TEARDOWN: tests/azure_redis_cache

SUMMARY:

✘ tests/azure_redis_cache failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_role_definition []

PRETEST: tests/azure_role_definition

TEST: tests/azure_role_definition
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.azurerm_subscription.primary: Reading...
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]
data.azurerm_subscription.primary: Read complete after 0s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_role_definition.named_test_resource will be created
  + resource "azurerm_role_definition" "named_test_resource" {
      + assignable_scopes           = [
          + "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c",
        ]
      + description                 = "This is a custom role created via Terraform"
      + id                          = (known after apply)
      + name                        = "turbottest64461"
      + role_definition_id          = (known after apply)
      + role_definition_resource_id = (known after apply)
      + scope                       = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c"

      + permissions {
          + actions     = [
              + "*",
            ]
          + not_actions = []
        }
    }

Plan: 1 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest64461"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_role_definition.named_test_resource: Creating...
azurerm_role_definition.named_test_resource: Creation complete after 3s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/providers/Microsoft.Authorization/roleDefinitions/d3bfe87b-6f6c-269d-20db-99398ffcc154|/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 29, in data "null_data_source" "resource":
  29: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Apply complete! Resources: 1 added, 0 changed, 0 destroyed.

Outputs:

resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/providers/Microsoft.Authorization/roleDefinitions/d3bfe87b-6f6c-269d-20db-99398ffcc154|/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/providers/microsoft.authorization/roledefinitions/d3bfe87b-6f6c-269d-20db-99398ffcc154|/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/providers/Microsoft.Authorization/roleDefinitions/d3bfe87b-6f6c-269d-20db-99398ffcc154|/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c"
resource_name = "turbottest64461"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
Error: authorization.RoleDefinitionsClient#Get: Failure responding to request: StatusCode=404 -- Original Error: autorest/azure: Service returned an error. Status=404 Code="RoleDefinitionDoesNotExist" Message="The specified role definition with ID 'd46d7416-f95f-4771-bbb5-529d4c76659c' does not exist." (SQLSTATE HV000)
{}
[
  {
    "assignable_scopes": [
      "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c"
    ],
    "description": "This is a custom role created via Terraform",
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/providers/Microsoft.Authorization/roleDefinitions/d3bfe87b-6f6c-269d-20db-99398ffcc154|/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c",
    "name": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "permissions": [
      {
        "actions": [
          "*"
        ],
        "dataActions": [],
        "notActions": [],
        "notDataActions": []
      }
    ],
    "role_name": "turbottest64461",
    "role_type": "CustomRole",
    "type": "Microsoft.Authorization/roleDefinitions"
  }
]

✘ FAILED

Running SQL query: test-hydrate-query.sql
Error: authorization.RoleDefinitionsClient#Get: Failure responding to request: StatusCode=404 -- Original Error: autorest/azure: Service returned an error. Status=404 Code="RoleDefinitionDoesNotExist" Message="The specified role definition with ID 'd46d7416-f95f-4771-bbb5-529d4c76659c' does not exist." (SQLSTATE HV000)
{}
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/providers/Microsoft.Authorization/roleDefinitions/d3bfe87b-6f6c-269d-20db-99398ffcc154|/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/providers/microsoft.authorization/roledefinitions/d3bfe87b-6f6c-269d-20db-99398ffcc154|/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c"
    ],
    "name": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "title": "turbottest64461"
  }
]

✘ FAILED

Running SQL query: test-list-query.sql
Error: authorization.RoleDefinitionsClient#Get: Failure responding to request: StatusCode=404 -- Original Error: autorest/azure: Service returned an error. Status=404 Code="RoleDefinitionDoesNotExist" Message="The specified role definition with ID 'd46d7416-f95f-4771-bbb5-529d4c76659c' does not exist." (SQLSTATE HV000)
{}
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/providers/Microsoft.Authorization/roleDefinitions/d3bfe87b-6f6c-269d-20db-99398ffcc154|/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c",
    "name": "d46d7416-f95f-4771-bbb5-529d4c76659c"
  }
]

✘ FAILED

TEARDOWN: tests/azure_role_definition

SUMMARY:

✘ tests/azure_role_definition failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_security_center_automation []

PRETEST: tests/azure_security_center_automation

TEST: tests/azure_security_center_automation
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_eventhub.named_test_resource will be created
  + resource "azurerm_eventhub" "named_test_resource" {
      + id                  = (known after apply)
      + message_retention   = 2
      + name                = "turbottest21031"
      + namespace_name      = "turbottest21031"
      + partition_count     = 2
      + partition_ids       = (known after apply)
      + resource_group_name = "turbottest21031"
      + status              = "Active"
    }

  # azurerm_eventhub_authorization_rule.named_test_resource will be created
  + resource "azurerm_eventhub_authorization_rule" "named_test_resource" {
      + eventhub_name                     = "turbottest21031"
      + id                                = (known after apply)
      + listen                            = true
      + manage                            = false
      + name                              = "turbottest21031"
      + namespace_name                    = "turbottest21031"
      + primary_connection_string         = (sensitive value)
      + primary_connection_string_alias   = (sensitive value)
      + primary_key                       = (sensitive value)
      + resource_group_name               = "turbottest21031"
      + secondary_connection_string       = (sensitive value)
      + secondary_connection_string_alias = (sensitive value)
      + secondary_key                     = (sensitive value)
      + send                              = false
    }

  # azurerm_eventhub_namespace.named_test_resource will be created
  + resource "azurerm_eventhub_namespace" "named_test_resource" {
      + auto_inflate_enabled                      = false
      + capacity                                  = 2
      + default_primary_connection_string         = (sensitive value)
      + default_primary_connection_string_alias   = (sensitive value)
      + default_primary_key                       = (sensitive value)
      + default_secondary_connection_string       = (sensitive value)
      + default_secondary_connection_string_alias = (sensitive value)
      + default_secondary_key                     = (sensitive value)
      + id                                        = (known after apply)
      + local_authentication_enabled              = true
      + location                                  = "westeurope"
      + maximum_throughput_units                  = (known after apply)
      + minimum_tls_version                       = (known after apply)
      + name                                      = "turbottest21031"
      + network_rulesets                          = (known after apply)
      + public_network_access_enabled             = true
      + resource_group_name                       = "turbottest21031"
      + sku                                       = "Standard"
      + zone_redundant                            = false
    }

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "westeurope"
      + name     = "turbottest21031"
    }

  # azurerm_security_center_automation.named_test_resource will be created
  + resource "azurerm_security_center_automation" "named_test_resource" {
      + enabled             = true
      + id                  = (known after apply)
      + location            = "westeurope"
      + name                = "turbottest21031"
      + resource_group_name = "turbottest21031"
      + scopes              = [
          + "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c",
        ]

      + action {
          + connection_string = (sensitive value)
          + resource_id       = (known after apply)
          + type              = "eventhub"
        }

      + source {
          + event_source = "Alerts"

          + rule_set {
              + rule {
                  + expected_value = "High"
                  + operator       = "Equals"
                  + property_path  = "properties.metadata.severity"
                  + property_type  = "String"
                }
            }
        }
    }

Plan: 5 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest21031"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 2s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest21031]
azurerm_eventhub_namespace.named_test_resource: Creating...
azurerm_eventhub_namespace.named_test_resource: Still creating... [10s elapsed]
azurerm_eventhub_namespace.named_test_resource: Still creating... [20s elapsed]
azurerm_eventhub_namespace.named_test_resource: Still creating... [30s elapsed]
azurerm_eventhub_namespace.named_test_resource: Still creating... [40s elapsed]
azurerm_eventhub_namespace.named_test_resource: Still creating... [50s elapsed]
azurerm_eventhub_namespace.named_test_resource: Still creating... [1m0s elapsed]
azurerm_eventhub_namespace.named_test_resource: Still creating... [1m10s elapsed]
azurerm_eventhub_namespace.named_test_resource: Creation complete after 1m18s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest21031/providers/Microsoft.EventHub/namespaces/turbottest21031]
azurerm_eventhub.named_test_resource: Creating...
azurerm_eventhub.named_test_resource: Creation complete after 6s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest21031/providers/Microsoft.EventHub/namespaces/turbottest21031/eventhubs/turbottest21031]
azurerm_eventhub_authorization_rule.named_test_resource: Creating...
azurerm_eventhub_authorization_rule.named_test_resource: Creation complete after 6s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest21031/providers/Microsoft.EventHub/namespaces/turbottest21031/eventhubs/turbottest21031/authorizationRules/turbottest21031]
azurerm_security_center_automation.named_test_resource: Creating...
azurerm_security_center_automation.named_test_resource: Creation complete after 5s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest21031/providers/Microsoft.Security/automations/turbottest21031]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 29, in data "null_data_source" "resource":
  29: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Apply complete! Resources: 5 added, 0 changed, 0 destroyed.

Outputs:

resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest21031/providers/Microsoft.Security/automations/turbottest21031"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest21031/providers/microsoft.security/automations/turbottest21031"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest21031/providers/Microsoft.Security/automations/turbottest21031"
resource_name = "turbottest21031"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest21031/providers/Microsoft.Security/automations/turbottest21031",
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest21031/providers/Microsoft.Security/automations/turbottest21031",
    "name": "turbottest21031"
  }
]

✘ FAILED

Running SQL query: test-list-query.sql
null
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest21031/providers/Microsoft.Security/automations/turbottest21031",
    "name": "turbottest21031"
  }
]

✘ FAILED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest21031/providers/Microsoft.Security/automations/turbottest21031",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest21031/providers/microsoft.security/automations/turbottest21031"
    ],
    "name": "turbottest21031",
    "title": "turbottest21031"
  }
]
✔ PASSED

TEARDOWN: tests/azure_security_center_automation

SUMMARY:

✘ tests/azure_security_center_automation failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_security_center_setting []

PRETEST: tests/azure_security_center_setting

TEST: tests/azure_security_center_setting
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_security_center_setting.named_test_resource will be created
  + resource "azurerm_security_center_setting" "named_test_resource" {
      + enabled      = true
      + id           = (known after apply)
      + setting_name = "MCAS"
    }

Plan: 1 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "MCAS"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_security_center_setting.named_test_resource: Creating...

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 35, in data "null_data_source" "resource":
  35: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Error: A resource with the ID "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/providers/Microsoft.Security/settings/MCAS" already exists - to be managed via Terraform this resource needs to be imported into the State. Please see the resource documentation for "azurerm_security_center_setting" for more information.

  with azurerm_security_center_setting.named_test_resource,
  on variables.tf line 41, in resource "azurerm_security_center_setting" "named_test_resource":
  41: resource "azurerm_security_center_setting" "named_test_resource" {

Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_security_center_setting

SUMMARY:

✘ tests/azure_security_center_setting failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_service_fabric_cluster []

PRETEST: tests/azure_service_fabric_cluster

TEST: tests/azure_service_fabric_cluster
Running terraform

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "eastus"
      + name     = "turbottest17927"
    }

  # azurerm_service_fabric_cluster.named_test_resource will be created
  + resource "azurerm_service_fabric_cluster" "named_test_resource" {
      + cluster_code_version = "8.1.316.9590"
      + cluster_endpoint     = (known after apply)
      + id                   = (known after apply)
      + location             = "eastus"
      + management_endpoint  = "https://example:80"
      + name                 = "turbottest17927"
      + reliability_level    = "Bronze"
      + resource_group_name  = "turbottest17927"
      + upgrade_mode         = "Manual"
      + vm_image             = "Windows"

      + node_type {
          + client_endpoint_port = 2020
          + durability_level     = "Bronze"
          + http_endpoint_port   = 80
          + instance_count       = 3
          + is_primary           = true
          + name                 = "first"

          + application_ports {
              + end_port   = (known after apply)
              + start_port = (known after apply)
            }

          + ephemeral_ports {
              + end_port   = (known after apply)
              + start_port = (known after apply)
            }
        }
    }

Plan: 2 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + management_endpoint = "https://example:80"
  + region              = "eastus"
  + reliability_level   = "Bronze"
  + resource_aka        = (known after apply)
  + resource_aka_lower  = (known after apply)
  + resource_id         = (known after apply)
  + resource_name       = "turbottest17927"
  + subscription_id     = "d46d7416-f95f-4771-bbb5-529d4c76659c"
  + upgrade_mode        = "Manual"
  + vm_image            = "Windows"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 3s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest17927]
azurerm_service_fabric_cluster.named_test_resource: Creating...

Error: creating Service Fabric Cluster "turbottest17927" (Resource Group "turbottest17927"): servicefabric.ClustersClient#Create: Failure sending request: StatusCode=0 -- Original Error: Code="InvalidClusterVersionSelected" Message="Version '8.1.316.9590' is not valid. Available versions are 8.2.1235.9590 8.2.1363.9590 8.2.1486.9590 8.2.1571.9590 8.2.1620.9590 8.2.1659.9590 8.2.1686.9590 8.2.1692.9590 8.2.1723.9590 8.2.1748.9590 9.0.1017.9590 9.0.1028.9590 9.0.1048.9590 9.0.1107.9590 9.0.1121.9590 9.0.1155.9590 9.0.1309.9590 9.1.1390.9590 9.1.1436.9590 9.1.1583.9590  for current version . Additional details: https://learn.microsoft.com/en-us/azure/service-fabric/service-fabric-cluster-upgrade-version-azure#check-for-supported-upgrade-path" Details=[]

  with azurerm_service_fabric_cluster.named_test_resource,
  on variables.tf line 40, in resource "azurerm_service_fabric_cluster" "named_test_resource":
  40: resource "azurerm_service_fabric_cluster" "named_test_resource" {

Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_service_fabric_cluster

SUMMARY:

✘ tests/azure_service_fabric_cluster failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_signalr_service []

PRETEST: tests/azure_signalr_service

TEST: tests/azure_signalr_service
Running terraform

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "westeurope"
      + name     = "turbottest75089"
    }

  # azurerm_signalr_service.named_test_resource will be created
  + resource "azurerm_signalr_service" "named_test_resource" {
      + hostname                    = (known after apply)
      + id                          = (known after apply)
      + ip_address                  = (known after apply)
      + location                    = "westeurope"
      + name                        = "turbottest75089"
      + primary_access_key          = (sensitive value)
      + primary_connection_string   = (sensitive value)
      + public_port                 = (known after apply)
      + resource_group_name         = "turbottest75089"
      + secondary_access_key        = (sensitive value)
      + secondary_connection_string = (sensitive value)
      + server_port                 = (known after apply)

      + cors {
          + allowed_origins = (known after apply)
        }

      + features {
          + flag  = (known after apply)
          + value = (known after apply)
        }

      + sku {
          + capacity = 1
          + name     = "Free_F1"
        }
    }

Plan: 2 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + region             = "westeurope"
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest75089"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 4s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest75089]
azurerm_signalr_service.named_test_resource: Creating...
azurerm_signalr_service.named_test_resource: Still creating... [10s elapsed]
azurerm_signalr_service.named_test_resource: Still creating... [20s elapsed]
azurerm_signalr_service.named_test_resource: Still creating... [30s elapsed]
azurerm_signalr_service.named_test_resource: Still creating... [40s elapsed]
azurerm_signalr_service.named_test_resource: Still creating... [50s elapsed]
azurerm_signalr_service.named_test_resource: Still creating... [1m0s elapsed]
azurerm_signalr_service.named_test_resource: Still creating... [1m10s elapsed]
azurerm_signalr_service.named_test_resource: Creation complete after 1m17s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest75089/providers/Microsoft.SignalRService/SignalR/turbottest75089]

Apply complete! Resources: 2 added, 0 changed, 0 destroyed.

Outputs:

region = "westeurope"
resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest75089/providers/Microsoft.SignalRService/SignalR/turbottest75089"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest75089/providers/microsoft.signalrservice/signalr/turbottest75089"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest75089/providers/Microsoft.SignalRService/SignalR/turbottest75089"
resource_name = "turbottest75089"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest75089/providers/Microsoft.SignalRService/SignalR/turbottest75089",
    "name": "turbottest75089",
    "region": "westeurope",
    "resource_group": "turbottest75089",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "type": "Microsoft.SignalRService/SignalR"
  }
]
✔ PASSED

Running SQL query: test-list-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest75089/providers/Microsoft.SignalRService/SignalR/turbottest75089",
    "name": "turbottest75089",
    "region": "westeurope",
    "resource_group": "turbottest75089",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "type": "Microsoft.SignalRService/SignalR"
  }
]
✔ PASSED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest75089/providers/Microsoft.SignalRService/SignalR/turbottest75089",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest75089/providers/microsoft.signalrservice/signalr/turbottest75089"
    ],
    "name": "turbottest75089",
    "title": "turbottest75089"
  }
]
✔ PASSED

POSTTEST: tests/azure_signalr_service

TEARDOWN: tests/azure_signalr_service

SUMMARY:

1/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_sql_database []

PRETEST: tests/azure_sql_database

TEST: tests/azure_sql_database
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "eastus"
      + name     = "turbottest71475"
    }

  # azurerm_sql_database.named_test_resource will be created
  + resource "azurerm_sql_database" "named_test_resource" {
      + collation                        = (known after apply)
      + create_mode                      = "Default"
      + creation_date                    = (known after apply)
      + default_secondary_location       = (known after apply)
      + edition                          = (known after apply)
      + elastic_pool_name                = (known after apply)
      + encryption                       = (known after apply)
      + id                               = (known after apply)
      + location                         = "eastus"
      + max_size_bytes                   = (known after apply)
      + max_size_gb                      = (known after apply)
      + name                             = "turbottest71475"
      + read_scale                       = false
      + requested_service_objective_id   = (known after apply)
      + requested_service_objective_name = (known after apply)
      + resource_group_name              = "turbottest71475"
      + restore_point_in_time            = (known after apply)
      + server_name                      = "turbottest71475"
      + source_database_deletion_date    = (known after apply)
      + source_database_id               = (known after apply)
      + tags                             = {
          + "foo" = "bar"
        }

      + threat_detection_policy {
          + disabled_alerts            = (known after apply)
          + email_account_admins       = (known after apply)
          + email_addresses            = (known after apply)
          + retention_days             = (known after apply)
          + state                      = (known after apply)
          + storage_account_access_key = (sensitive value)
          + storage_endpoint           = (known after apply)
        }
    }

  # azurerm_sql_server.named_test_resource will be created
  + resource "azurerm_sql_server" "named_test_resource" {
      + administrator_login          = "mradministrator"
      + administrator_login_password = (sensitive value)
      + connection_policy            = "Default"
      + fully_qualified_domain_name  = (known after apply)
      + id                           = (known after apply)
      + location                     = "eastus"
      + name                         = "turbottest71475"
      + resource_group_name          = "turbottest71475"
      + version                      = "12.0"

      + threat_detection_policy {
          + disabled_alerts            = (known after apply)
          + email_account_admins       = (known after apply)
          + email_addresses            = (known after apply)
          + retention_days             = (known after apply)
          + state                      = (known after apply)
          + storage_account_access_key = (sensitive value)
          + storage_endpoint           = (known after apply)
        }
    }

Plan: 3 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + resource_aka                        = (known after apply)
  + resource_aka_lower                  = (known after apply)
  + resource_creation_date              = (known after apply)
  + resource_default_secondary_location = (known after apply)
  + resource_id                         = (known after apply)
  + resource_location                   = "East US"
  + resource_name                       = "turbottest71475"
  + resource_region                     = "east us"
  + subscription_id                     = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 2s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest71475]
azurerm_sql_server.named_test_resource: Creating...
azurerm_sql_server.named_test_resource: Still creating... [10s elapsed]
azurerm_sql_server.named_test_resource: Still creating... [20s elapsed]
azurerm_sql_server.named_test_resource: Still creating... [30s elapsed]
azurerm_sql_server.named_test_resource: Still creating... [40s elapsed]
azurerm_sql_server.named_test_resource: Still creating... [50s elapsed]
azurerm_sql_server.named_test_resource: Still creating... [1m0s elapsed]
azurerm_sql_server.named_test_resource: Still creating... [1m10s elapsed]
azurerm_sql_server.named_test_resource: Creation complete after 1m18s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest71475/providers/Microsoft.Sql/servers/turbottest71475]
azurerm_sql_database.named_test_resource: Creating...
azurerm_sql_database.named_test_resource: Still creating... [10s elapsed]
azurerm_sql_database.named_test_resource: Still creating... [20s elapsed]
azurerm_sql_database.named_test_resource: Still creating... [30s elapsed]
azurerm_sql_database.named_test_resource: Still creating... [40s elapsed]
azurerm_sql_database.named_test_resource: Still creating... [50s elapsed]
azurerm_sql_database.named_test_resource: Still creating... [1m0s elapsed]
azurerm_sql_database.named_test_resource: Still creating... [1m10s elapsed]
azurerm_sql_database.named_test_resource: Creation complete after 1m11s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest71475/providers/Microsoft.Sql/servers/turbottest71475/databases/turbottest71475]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 35, in data "null_data_source" "resource":
  35: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Warning: Deprecated Resource

  with azurerm_sql_server.named_test_resource,
  on variables.tf line 46, in resource "azurerm_sql_server" "named_test_resource":
  46: resource "azurerm_sql_server" "named_test_resource" {

The `azurerm_sql_server` resource is deprecated and will be removed in
version 4.0 of the AzureRM provider. Please use the `azurerm_mssql_server`
resource instead.

(and 5 more similar warnings elsewhere)

Apply complete! Resources: 3 added, 0 changed, 0 destroyed.

Outputs:

resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest71475/providers/Microsoft.Sql/servers/turbottest71475/databases/turbottest71475"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest71475/providers/microsoft.sql/servers/turbottest71475/databases/turbottest71475"
resource_creation_date = "2023-03-10T11:18:47.65Z"
resource_default_secondary_location = "West US"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest71475/providers/Microsoft.Sql/servers/turbottest71475/databases/turbottest71475"
resource_location = "East US"
resource_name = "turbottest71475"
resource_region = "east us"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest71475/providers/Microsoft.Sql/servers/turbottest71475/databases/turbottest71475",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest71475/providers/microsoft.sql/servers/turbottest71475/databases/turbottest71475"
    ],
    "containment_state": 2,
    "default_secondary_location": "West US",
    "earliest_restore_date": null,
    "edition": "GeneralPurpose",
    "elastic_pool_name": null,
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest71475/providers/Microsoft.Sql/servers/turbottest71475/databases/turbottest71475",
    "location": "East US",
    "max_size_bytes": "34359738368",
    "name": "turbottest71475",
    "region": "east us",
    "requested_service_objective_name": "GP_Gen5_2",
    "resource_group": "turbottest71475",
    "server_name": "turbottest71475",
    "service_level_objective": "GP_Gen5_2",
    "status": "Online",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "tags": {
      "foo": "bar"
    },
    "title": "turbottest71475",
    "transparent_data_encryption": {
      "status": "Enabled"
    },
    "type": "Microsoft.Sql/servers/databases",
    "zone_redundant": false
  }
]
✔ PASSED

Running SQL query: test-hydrate-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest71475/providers/Microsoft.Sql/servers/turbottest71475/databases/turbottest71475",
    "name": "turbottest71475",
    "server_name": "turbottest71475",
    "transparent_data_encryption": {
      "status": "Enabled"
    }
  }
]
✔ PASSED

Running SQL query: test-list-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest71475/providers/Microsoft.Sql/servers/turbottest71475/databases/turbottest71475",
    "location": "East US",
    "name": "turbottest71475",
    "resource_group": "turbottest71475",
    "server_name": "turbottest71475"
  }
]
✔ PASSED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest71475/providers/Microsoft.Sql/servers/turbottest71475/databases/turbottest71475",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest71475/providers/microsoft.sql/servers/turbottest71475/databases/turbottest71475"
    ],
    "name": "turbottest71475",
    "tags": {
      "foo": "bar"
    },
    "title": "turbottest71475"
  }
]
✔ PASSED

POSTTEST: tests/azure_sql_database

TEARDOWN: tests/azure_sql_database

SUMMARY:

1/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_sql_server []

PRETEST: tests/azure_sql_server

TEST: tests/azure_sql_server
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "eastus"
      + name     = "turbottest84610"
    }

  # azurerm_sql_firewall_rule.named_test_resource will be created
  + resource "azurerm_sql_firewall_rule" "named_test_resource" {
      + end_ip_address      = "10.0.17.62"
      + id                  = (known after apply)
      + name                = "turbottest84610"
      + resource_group_name = "turbottest84610"
      + server_name         = "turbottest84610"
      + start_ip_address    = "10.0.17.62"
    }

  # azurerm_sql_server.named_test_resource will be created
  + resource "azurerm_sql_server" "named_test_resource" {
      + administrator_login          = "mradministrator"
      + administrator_login_password = (sensitive value)
      + connection_policy            = "Default"
      + fully_qualified_domain_name  = (known after apply)
      + id                           = (known after apply)
      + location                     = "eastus"
      + name                         = "turbottest84610"
      + resource_group_name          = "turbottest84610"
      + tags                         = {
          + "name" = "turbottest84610"
        }
      + version                      = "12.0"

      + threat_detection_policy {
          + disabled_alerts            = (known after apply)
          + email_account_admins       = (known after apply)
          + email_addresses            = (known after apply)
          + retention_days             = (known after apply)
          + state                      = (known after apply)
          + storage_account_access_key = (sensitive value)
          + storage_endpoint           = (known after apply)
        }
    }

  # azurerm_storage_account.named_test_resource will be created
  + resource "azurerm_storage_account" "named_test_resource" {
      + access_tier                       = (known after apply)
      + account_kind                      = "StorageV2"
      + account_replication_type          = "LRS"
      + account_tier                      = "Standard"
      + allow_nested_items_to_be_public   = true
      + cross_tenant_replication_enabled  = true
      + default_to_oauth_authentication   = false
      + enable_https_traffic_only         = true
      + id                                = (known after apply)
      + infrastructure_encryption_enabled = false
      + is_hns_enabled                    = false
      + large_file_share_enabled          = (known after apply)
      + location                          = "eastus"
      + min_tls_version                   = "TLS1_2"
      + name                              = "turbottest84610"
      + nfsv3_enabled                     = false
      + primary_access_key                = (sensitive value)
      + primary_blob_connection_string    = (sensitive value)
      + primary_blob_endpoint             = (known after apply)
      + primary_blob_host                 = (known after apply)
      + primary_connection_string         = (sensitive value)
      + primary_dfs_endpoint              = (known after apply)
      + primary_dfs_host                  = (known after apply)
      + primary_file_endpoint             = (known after apply)
      + primary_file_host                 = (known after apply)
      + primary_location                  = (known after apply)
      + primary_queue_endpoint            = (known after apply)
      + primary_queue_host                = (known after apply)
      + primary_table_endpoint            = (known after apply)
      + primary_table_host                = (known after apply)
      + primary_web_endpoint              = (known after apply)
      + primary_web_host                  = (known after apply)
      + public_network_access_enabled     = true
      + queue_encryption_key_type         = "Service"
      + resource_group_name               = "turbottest84610"
      + secondary_access_key              = (sensitive value)
      + secondary_blob_connection_string  = (sensitive value)
      + secondary_blob_endpoint           = (known after apply)
      + secondary_blob_host               = (known after apply)
      + secondary_connection_string       = (sensitive value)
      + secondary_dfs_endpoint            = (known after apply)
      + secondary_dfs_host                = (known after apply)
      + secondary_file_endpoint           = (known after apply)
      + secondary_file_host               = (known after apply)
      + secondary_location                = (known after apply)
      + secondary_queue_endpoint          = (known after apply)
      + secondary_queue_host              = (known after apply)
      + secondary_table_endpoint          = (known after apply)
      + secondary_table_host              = (known after apply)
      + secondary_web_endpoint            = (known after apply)
      + secondary_web_host                = (known after apply)
      + sftp_enabled                      = false
      + shared_access_key_enabled         = true
      + table_encryption_key_type         = "Service"

      + blob_properties {
          + change_feed_enabled           = (known after apply)
          + change_feed_retention_in_days = (known after apply)
          + default_service_version       = (known after apply)
          + last_access_time_enabled      = (known after apply)
          + versioning_enabled            = (known after apply)

          + container_delete_retention_policy {
              + days = (known after apply)
            }

          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + delete_retention_policy {
              + days = (known after apply)
            }

          + restore_policy {
              + days = (known after apply)
            }
        }

      + network_rules {
          + bypass                     = (known after apply)
          + default_action             = (known after apply)
          + ip_rules                   = (known after apply)
          + virtual_network_subnet_ids = (known after apply)

          + private_link_access {
              + endpoint_resource_id = (known after apply)
              + endpoint_tenant_id   = (known after apply)
            }
        }

      + queue_properties {
          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + hour_metrics {
              + enabled               = (known after apply)
              + include_apis          = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
            }

          + logging {
              + delete                = (known after apply)
              + read                  = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
              + write                 = (known after apply)
            }

          + minute_metrics {
              + enabled               = (known after apply)
              + include_apis          = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
            }
        }

      + routing {
          + choice                      = (known after apply)
          + publish_internet_endpoints  = (known after apply)
          + publish_microsoft_endpoints = (known after apply)
        }

      + share_properties {
          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + retention_policy {
              + days = (known after apply)
            }

          + smb {
              + authentication_types            = (known after apply)
              + channel_encryption_type         = (known after apply)
              + kerberos_ticket_encryption_type = (known after apply)
              + multichannel_enabled            = (known after apply)
              + versions                        = (known after apply)
            }
        }
    }

Plan: 4 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + firewall_rule_id   = (known after apply)
  + location           = "eastus"
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest84610"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 3s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest84610]
azurerm_sql_server.named_test_resource: Creating...
azurerm_storage_account.named_test_resource: Creating...
azurerm_sql_server.named_test_resource: Still creating... [10s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [10s elapsed]
azurerm_sql_server.named_test_resource: Still creating... [20s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [20s elapsed]
azurerm_sql_server.named_test_resource: Still creating... [30s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [30s elapsed]
azurerm_storage_account.named_test_resource: Creation complete after 35s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest84610/providers/Microsoft.Storage/storageAccounts/turbottest84610]
azurerm_sql_server.named_test_resource: Still creating... [40s elapsed]
azurerm_sql_server.named_test_resource: Still creating... [50s elapsed]
azurerm_sql_server.named_test_resource: Still creating... [1m0s elapsed]
azurerm_sql_server.named_test_resource: Still creating... [1m10s elapsed]
azurerm_sql_server.named_test_resource: Creation complete after 1m20s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest84610/providers/Microsoft.Sql/servers/turbottest84610]
azurerm_sql_firewall_rule.named_test_resource: Creating...
azurerm_sql_firewall_rule.named_test_resource: Still creating... [10s elapsed]
azurerm_sql_firewall_rule.named_test_resource: Creation complete after 16s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest84610/providers/Microsoft.Sql/servers/turbottest84610/firewallRules/turbottest84610]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 29, in data "null_data_source" "resource":
  29: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Warning: Deprecated Resource

  with azurerm_sql_server.named_test_resource,
  on variables.tf line 48, in resource "azurerm_sql_server" "named_test_resource":
  48: resource "azurerm_sql_server" "named_test_resource" {

The `azurerm_sql_server` resource is deprecated and will be removed in
version 4.0 of the AzureRM provider. Please use the `azurerm_mssql_server`
resource instead.

(and 5 more similar warnings elsewhere)

Apply complete! Resources: 4 added, 0 changed, 0 destroyed.

Outputs:

firewall_rule_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest84610/providers/Microsoft.Sql/servers/turbottest84610/firewallRules/turbottest84610"
location = "eastus"
resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest84610/providers/Microsoft.Sql/servers/turbottest84610"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest84610/providers/microsoft.sql/servers/turbottest84610"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest84610/providers/Microsoft.Sql/servers/turbottest84610"
resource_name = "turbottest84610"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "administrator_login": "mradministrator",
    "fully_qualified_domain_name": "turbottest84610.database.windows.net",
    "kind": "v12.0",
    "location": "eastus",
    "name": "turbottest84610",
    "region": "eastus",
    "resource_group": "turbottest84610",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "tags_src": {
      "name": "turbottest84610"
    },
    "type": "Microsoft.Sql/servers",
    "version": "12.0"
  }
]
✔ PASSED

Running SQL query: test-hydrate-query.sql
[
  {
    "encryption_protector": [
      {
        "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest84610/providers/Microsoft.Sql/servers/turbottest84610/encryptionProtector/current",
        "kind": "servicemanaged",
        "name": "current",
        "serverKeyName": "ServiceManaged",
        "serverKeyType": "ServiceManaged",
        "type": "Microsoft.Sql/servers/encryptionProtector"
      }
    ],
    "firewall_rules": [
      {
        "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest84610/providers/Microsoft.Sql/servers/turbottest84610/firewallRules/turbottest84610",
        "name": "turbottest84610",
        "properties": {
          "endIpAddress": "10.0.17.62",
          "startIpAddress": "10.0.17.62"
        },
        "type": "Microsoft.Sql/servers/firewallRules"
      }
    ],
    "name": "turbottest84610",
    "server_audit_policy": [
      {
        "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest84610/providers/Microsoft.Sql/servers/turbottest84610/auditingSettings/Default",
        "name": "Default",
        "properties": {
          "auditActionsAndGroups": [],
          "isAzureMonitorTargetEnabled": false,
          "isStorageSecondaryKeyInUse": false,
          "retentionDays": 0,
          "state": "Disabled",
          "storageAccountSubscriptionId": "00000000-0000-0000-0000-000000000000",
          "storageEndpoint": ""
        },
        "type": "Microsoft.Sql/servers/auditingSettings"
      }
    ],
    "server_azure_ad_administrator": null,
    "server_security_alert_policy": [
      {
        "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest84610/providers/Microsoft.Sql/servers/turbottest84610/securityAlertPolicies/Default",
        "name": "Default",
        "properties": {
          "disabledAlerts": [
            ""
          ],
          "emailAccountAdmins": false,
          "emailAddresses": [
            ""
          ],
          "retentionDays": 0,
          "state": "Disabled",
          "storageAccountAccessKey": "",
          "storageEndpoint": ""
        },
        "type": "Microsoft.Sql/servers/securityAlertPolicies"
      }
    ],
    "server_vulnerability_assessment": [
      {
        "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest84610/providers/Microsoft.Sql/servers/turbottest84610/vulnerabilityAssessments/Default",
        "name": "Default",
        "properties": {
          "recurringScans": {
            "emailSubscriptionAdmins": true,
            "isEnabled": false
          }
        },
        "type": "Microsoft.Sql/servers/vulnerabilityAssessments"
      }
    ]
  }
]
✔ PASSED

Running SQL query: test-list-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest84610/providers/Microsoft.Sql/servers/turbottest84610",
    "location": "eastus",
    "name": "turbottest84610"
  }
]
✔ PASSED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest84610/providers/Microsoft.Sql/servers/turbottest84610",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest84610/providers/microsoft.sql/servers/turbottest84610"
    ],
    "name": "turbottest84610",
    "title": "turbottest84610"
  }
]
✔ PASSED

POSTTEST: tests/azure_sql_server

TEARDOWN: tests/azure_sql_server

SUMMARY:

1/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_storage_sync []

PRETEST: tests/azure_storage_sync

TEST: tests/azure_storage_sync
Running terraform
data.azuread_client_config.current: Reading...
data.azuread_client_config.current: Read complete after 0s [id=cdffd708-7da0-4cea-abeb-0a4c334d7f64-04b07795-8ddb-461a-bbee-02f9e1bf7b46-06fd46b0-a867-49a1-a4f1-f7768465caba]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "westeurope"
      + name     = "turbottest34214"
    }

  # azurerm_storage_sync.named_test_resource will be created
  + resource "azurerm_storage_sync" "named_test_resource" {
      + id                      = (known after apply)
      + incoming_traffic_policy = "AllowAllTraffic"
      + location                = "westeurope"
      + name                    = "turbottest34214"
      + resource_group_name     = "turbottest34214"
      + tags                    = {
          + "name" = "turbottest34214"
        }
    }

Plan: 2 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + region             = "westeurope"
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest34214"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 3s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest34214]
azurerm_storage_sync.named_test_resource: Creating...
azurerm_storage_sync.named_test_resource: Still creating... [10s elapsed]
azurerm_storage_sync.named_test_resource: Still creating... [20s elapsed]
azurerm_storage_sync.named_test_resource: Still creating... [30s elapsed]
azurerm_storage_sync.named_test_resource: Still creating... [40s elapsed]
azurerm_storage_sync.named_test_resource: Creation complete after 47s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest34214/providers/Microsoft.StorageSync/storageSyncServices/turbottest34214]

Apply complete! Resources: 2 added, 0 changed, 0 destroyed.

Outputs:

region = "westeurope"
resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest34214/providers/Microsoft.StorageSync/storageSyncServices/turbottest34214"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest34214/providers/microsoft.storagesync/storagesyncservices/turbottest34214"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest34214/providers/Microsoft.StorageSync/storageSyncServices/turbottest34214"
resource_name = "turbottest34214"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest34214/providers/Microsoft.StorageSync/storageSyncServices/turbottest34214",
    "name": "turbottest34214",
    "region": "westeurope",
    "resource_group": "turbottest34214",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "tags": {
      "name": "turbottest34214"
    },
    "type": "Microsoft.StorageSync/storageSyncServices"
    "type": "microsoft.storagesync/storageSyncServices"
  }
]

✘ FAILED

Running SQL query: test-list-query.sql
null
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest34214/providers/Microsoft.StorageSync/storageSyncServices/turbottest34214",
    "name": "turbottest34214",
    "region": "westeurope",
    "resource_group": "turbottest34214",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "tags": {
      "name": "turbottest34214"
    },
    "type": "microsoft.storagesync/storageSyncServices"
  }
]

✘ FAILED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest34214/providers/Microsoft.StorageSync/storageSyncServices/turbottest34214",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest34214/providers/microsoft.storagesync/storagesyncservices/turbottest34214"
    ],
    "name": "turbottest34214",
    "tags": {
      "name": "turbottest34214"
    },
    "title": "turbottest34214"
  }
]
✔ PASSED

TEARDOWN: tests/azure_storage_sync

SUMMARY:

✘ tests/azure_storage_sync failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_stream_analytics_job []

PRETEST: tests/azure_stream_analytics_job

TEST: tests/azure_stream_analytics_job
Running terraform
data.azurerm_client_config.current: Reading...
data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9MDZmZDQ2YjAtYTg2Ny00OWExLWE0ZjEtZjc3Njg0NjVjYWJhO3N1YnNjcmlwdGlvbklkPWQ0NmQ3NDE2LWY5NWYtNDc3MS1iYmI1LTUyOWQ0Yzc2NjU5Yzt0ZW5hbnRJZD1jZGZmZDcwOC03ZGEwLTRjZWEtYWJlYi0wYTRjMzM0ZDdmNjQ=]
data.null_data_source.resource: Reading...
data.null_data_source.resource: Read complete after 0s [id=static]

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "eastus"
      + name     = "turbottest67134"
    }

  # azurerm_stream_analytics_job.named_test_resource will be created
  + resource "azurerm_stream_analytics_job" "named_test_resource" {
      + compatibility_level                      = "1.1"
      + content_storage_policy                   = "SystemAccount"
      + data_locale                              = "en-GB"
      + events_late_arrival_max_delay_in_seconds = 60
      + events_out_of_order_max_delay_in_seconds = 50
      + events_out_of_order_policy               = "Adjust"
      + id                                       = (known after apply)
      + job_id                                   = (known after apply)
      + location                                 = "eastus"
      + name                                     = "turbottest67134"
      + output_error_policy                      = "Drop"
      + resource_group_name                      = "turbottest67134"
      + streaming_units                          = 3
      + transformation_query                     = <<-EOT
                SELECT *
                INTO [YourOutputAlias]
                FROM [YourInputAlias]
        EOT
      + type                                     = "Cloud"
    }

Plan: 2 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + location           = "eastus"
  + resource_aka       = (known after apply)
  + resource_aka_lower = (known after apply)
  + resource_id        = (known after apply)
  + resource_name      = "turbottest67134"
  + subscription_id    = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 4s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest67134]
azurerm_stream_analytics_job.named_test_resource: Creating...
azurerm_stream_analytics_job.named_test_resource: Creation complete after 8s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest67134/providers/Microsoft.StreamAnalytics/streamingJobs/turbottest67134]

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 28, in data "null_data_source" "resource":
  28: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

(and one more similar warning elsewhere)

Apply complete! Resources: 2 added, 0 changed, 0 destroyed.

Outputs:

location = "eastus"
resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest67134/providers/Microsoft.StreamAnalytics/streamingJobs/turbottest67134"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest67134/providers/microsoft.streamanalytics/streamingjobs/turbottest67134"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest67134/providers/Microsoft.StreamAnalytics/streamingJobs/turbottest67134"
resource_name = "turbottest67134"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest67134/providers/Microsoft.StreamAnalytics/streamingjobs/turbottest67134",
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest67134/providers/Microsoft.StreamAnalytics/streamingJobs/turbottest67134",
    "name": "turbottest67134",
    "region": "eastus",
    "resource_group": "turbottest67134",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "type": "Microsoft.StreamAnalytics/streamingjobs"
  }
]

✘ FAILED

Running SQL query: test-list-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest67134/providers/Microsoft.StreamAnalytics/streamingjobs/turbottest67134",
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest67134/providers/Microsoft.StreamAnalytics/streamingJobs/turbottest67134",
    "name": "turbottest67134",
    "type": "Microsoft.StreamAnalytics/streamingjobs"
  }
]

✘ FAILED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest67134/providers/Microsoft.StreamAnalytics/streamingjobs/turbottest67134",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest67134/providers/Microsoft.StreamAnalytics/streamingJobs/turbottest67134",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest67134/providers/microsoft.streamanalytics/streamingjobs/turbottest67134"
    ],
    "name": "turbottest67134",
    "title": "turbottest67134"
  }
]

✘ FAILED

TEARDOWN: tests/azure_stream_analytics_job

SUMMARY:

✘ tests/azure_stream_analytics_job failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_subscription []

PRETEST: tests/azure_subscription

TEST: tests/azure_subscription
Running terraform

Error: Unsupported argument

  on variables.tf line 22, in provider "azuread":
  22:   subscription_id = var.azure_subscription

An argument named "subscription_id" is not expected here.

Error: Unsupported block type

  on variables.tf line 23, in provider "azuread":
  23:   features {}

Blocks of type "features" are not expected here.
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_subscription


Error: Unsupported argument

  on variables.tf line 22, in provider "azuread":
  22:   subscription_id = var.azure_subscription

An argument named "subscription_id" is not expected here.

Error: Unsupported block type

  on variables.tf line 23, in provider "azuread":
  23:   features {}

Blocks of type "features" are not expected here.
SUMMARY:

✘ tests/azure_subscription failed.

0/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_synapse_workspace []

PRETEST: tests/azure_synapse_workspace

TEST: tests/azure_synapse_workspace
Running terraform

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # azurerm_resource_group.named_test_resource will be created
  + resource "azurerm_resource_group" "named_test_resource" {
      + id       = (known after apply)
      + location = "westeurope"
      + name     = "turbottest2571"
    }

  # azurerm_storage_account.named_test_resource will be created
  + resource "azurerm_storage_account" "named_test_resource" {
      + access_tier                      = (known after apply)
      + account_kind                     = "StorageV2"
      + account_replication_type         = "LRS"
      + account_tier                     = "Standard"
      + allow_blob_public_access         = false
      + enable_https_traffic_only        = true
      + id                               = (known after apply)
      + is_hns_enabled                   = true
      + large_file_share_enabled         = (known after apply)
      + location                         = "westeurope"
      + min_tls_version                  = "TLS1_0"
      + name                             = "turbottest2571"
      + nfsv3_enabled                    = false
      + primary_access_key               = (sensitive value)
      + primary_blob_connection_string   = (sensitive value)
      + primary_blob_endpoint            = (known after apply)
      + primary_blob_host                = (known after apply)
      + primary_connection_string        = (sensitive value)
      + primary_dfs_endpoint             = (known after apply)
      + primary_dfs_host                 = (known after apply)
      + primary_file_endpoint            = (known after apply)
      + primary_file_host                = (known after apply)
      + primary_location                 = (known after apply)
      + primary_queue_endpoint           = (known after apply)
      + primary_queue_host               = (known after apply)
      + primary_table_endpoint           = (known after apply)
      + primary_table_host               = (known after apply)
      + primary_web_endpoint             = (known after apply)
      + primary_web_host                 = (known after apply)
      + resource_group_name              = "turbottest2571"
      + secondary_access_key             = (sensitive value)
      + secondary_blob_connection_string = (sensitive value)
      + secondary_blob_endpoint          = (known after apply)
      + secondary_blob_host              = (known after apply)
      + secondary_connection_string      = (sensitive value)
      + secondary_dfs_endpoint           = (known after apply)
      + secondary_dfs_host               = (known after apply)
      + secondary_file_endpoint          = (known after apply)
      + secondary_file_host              = (known after apply)
      + secondary_location               = (known after apply)
      + secondary_queue_endpoint         = (known after apply)
      + secondary_queue_host             = (known after apply)
      + secondary_table_endpoint         = (known after apply)
      + secondary_table_host             = (known after apply)
      + secondary_web_endpoint           = (known after apply)
      + secondary_web_host               = (known after apply)
      + shared_access_key_enabled        = true

      + blob_properties {
          + change_feed_enabled      = (known after apply)
          + default_service_version  = (known after apply)
          + last_access_time_enabled = (known after apply)
          + versioning_enabled       = (known after apply)

          + container_delete_retention_policy {
              + days = (known after apply)
            }

          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + delete_retention_policy {
              + days = (known after apply)
            }
        }

      + identity {
          + identity_ids = (known after apply)
          + principal_id = (known after apply)
          + tenant_id    = (known after apply)
          + type         = (known after apply)
        }

      + network_rules {
          + bypass                     = (known after apply)
          + default_action             = (known after apply)
          + ip_rules                   = (known after apply)
          + virtual_network_subnet_ids = (known after apply)

          + private_link_access {
              + endpoint_resource_id = (known after apply)
              + endpoint_tenant_id   = (known after apply)
            }
        }

      + queue_properties {
          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + hour_metrics {
              + enabled               = (known after apply)
              + include_apis          = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
            }

          + logging {
              + delete                = (known after apply)
              + read                  = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
              + write                 = (known after apply)
            }

          + minute_metrics {
              + enabled               = (known after apply)
              + include_apis          = (known after apply)
              + retention_policy_days = (known after apply)
              + version               = (known after apply)
            }
        }

      + routing {
          + choice                      = (known after apply)
          + publish_internet_endpoints  = (known after apply)
          + publish_microsoft_endpoints = (known after apply)
        }

      + share_properties {
          + cors_rule {
              + allowed_headers    = (known after apply)
              + allowed_methods    = (known after apply)
              + allowed_origins    = (known after apply)
              + exposed_headers    = (known after apply)
              + max_age_in_seconds = (known after apply)
            }

          + retention_policy {
              + days = (known after apply)
            }

          + smb {
              + authentication_types            = (known after apply)
              + channel_encryption_type         = (known after apply)
              + kerberos_ticket_encryption_type = (known after apply)
              + versions                        = (known after apply)
            }
        }
    }

  # azurerm_storage_data_lake_gen2_filesystem.named_test_resource will be created
  + resource "azurerm_storage_data_lake_gen2_filesystem" "named_test_resource" {
      + id                 = (known after apply)
      + name               = "turbottest2571"
      + storage_account_id = (known after apply)

      + ace {
          + id          = (known after apply)
          + permissions = (known after apply)
          + scope       = (known after apply)
          + type        = (known after apply)
        }
    }

  # azurerm_synapse_workspace.named_test_resource will be created
  + resource "azurerm_synapse_workspace" "named_test_resource" {
      + aad_admin                            = (known after apply)
      + connectivity_endpoints               = (known after apply)
      + id                                   = (known after apply)
      + identity                             = (known after apply)
      + location                             = "westeurope"
      + managed_resource_group_name          = (known after apply)
      + name                                 = "turbottest2571"
      + resource_group_name                  = "turbottest2571"
      + sql_administrator_login              = "sqladminuser"
      + sql_administrator_login_password     = (sensitive value)
      + storage_data_lake_gen2_filesystem_id = (known after apply)
      + tags                                 = {
          + "Name" = "turbottest2571"
        }
    }

Plan: 4 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + region                  = "westeurope"
  + resource_aka            = (known after apply)
  + resource_aka_lower      = (known after apply)
  + resource_id             = (known after apply)
  + resource_name           = "turbottest2571"
  + sql_administrator_login = "sqladminuser"
  + subscription_id         = "d46d7416-f95f-4771-bbb5-529d4c76659c"
azurerm_resource_group.named_test_resource: Creating...
azurerm_resource_group.named_test_resource: Creation complete after 4s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest2571]
azurerm_storage_account.named_test_resource: Creating...
azurerm_storage_account.named_test_resource: Still creating... [10s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [20s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [30s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [40s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [50s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [1m0s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [1m10s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [1m20s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [1m30s elapsed]
azurerm_storage_account.named_test_resource: Still creating... [1m40s elapsed]
azurerm_storage_account.named_test_resource: Creation complete after 1m42s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest2571/providers/Microsoft.Storage/storageAccounts/turbottest2571]
azurerm_storage_data_lake_gen2_filesystem.named_test_resource: Creating...
azurerm_storage_data_lake_gen2_filesystem.named_test_resource: Creation complete after 3s [id=https://turbottest2571.dfs.core.windows.net/turbottest2571]
azurerm_synapse_workspace.named_test_resource: Creating...
azurerm_synapse_workspace.named_test_resource: Still creating... [10s elapsed]
azurerm_synapse_workspace.named_test_resource: Still creating... [20s elapsed]
azurerm_synapse_workspace.named_test_resource: Still creating... [30s elapsed]
azurerm_synapse_workspace.named_test_resource: Still creating... [40s elapsed]
azurerm_synapse_workspace.named_test_resource: Still creating... [50s elapsed]
azurerm_synapse_workspace.named_test_resource: Still creating... [1m0s elapsed]
azurerm_synapse_workspace.named_test_resource: Still creating... [1m10s elapsed]
azurerm_synapse_workspace.named_test_resource: Still creating... [1m20s elapsed]
azurerm_synapse_workspace.named_test_resource: Still creating... [1m30s elapsed]
azurerm_synapse_workspace.named_test_resource: Still creating... [1m40s elapsed]
azurerm_synapse_workspace.named_test_resource: Still creating... [1m50s elapsed]
azurerm_synapse_workspace.named_test_resource: Still creating... [2m0s elapsed]
azurerm_synapse_workspace.named_test_resource: Still creating... [2m10s elapsed]
azurerm_synapse_workspace.named_test_resource: Still creating... [2m20s elapsed]
azurerm_synapse_workspace.named_test_resource: Still creating... [2m30s elapsed]
azurerm_synapse_workspace.named_test_resource: Still creating... [2m40s elapsed]
azurerm_synapse_workspace.named_test_resource: Still creating... [2m50s elapsed]
azurerm_synapse_workspace.named_test_resource: Still creating... [3m0s elapsed]
azurerm_synapse_workspace.named_test_resource: Still creating... [3m10s elapsed]
azurerm_synapse_workspace.named_test_resource: Creation complete after 3m20s [id=/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest2571/providers/Microsoft.Synapse/workspaces/turbottest2571]

Apply complete! Resources: 4 added, 0 changed, 0 destroyed.

Outputs:

region = "westeurope"
resource_aka = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest2571/providers/Microsoft.Synapse/workspaces/turbottest2571"
resource_aka_lower = "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest2571/providers/microsoft.synapse/workspaces/turbottest2571"
resource_id = "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest2571/providers/Microsoft.Synapse/workspaces/turbottest2571"
resource_name = "turbottest2571"
sql_administrator_login = "sqladminuser"
subscription_id = "d46d7416-f95f-4771-bbb5-529d4c76659c"

Running SQL query: test-get-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest2571/providers/Microsoft.Synapse/workspaces/turbottest2571",
    "name": "turbottest2571",
    "region": "westeurope",
    "resource_group": "turbottest2571",
    "sql_administrator_login": "sqladminuser",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "tags": {
      "Name": "turbottest2571"
    },
    "type": "Microsoft.Synapse/workspaces"
  }
]
✔ PASSED

Running SQL query: test-list-query.sql
[
  {
    "id": "/subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest2571/providers/Microsoft.Synapse/workspaces/turbottest2571",
    "name": "turbottest2571",
    "region": "westeurope",
    "resource_group": "turbottest2571",
    "sql_administrator_login": "sqladminuser",
    "subscription_id": "d46d7416-f95f-4771-bbb5-529d4c76659c",
    "tags": {
      "Name": "turbottest2571"
    },
    "type": "Microsoft.Synapse/workspaces"
  }
]
✔ PASSED

Running SQL query: test-not-found-query.sql
null
✔ PASSED

Running SQL query: test-turbot-query.sql
[
  {
    "akas": [
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourceGroups/turbottest2571/providers/Microsoft.Synapse/workspaces/turbottest2571",
      "azure:///subscriptions/d46d7416-f95f-4771-bbb5-529d4c76659c/resourcegroups/turbottest2571/providers/microsoft.synapse/workspaces/turbottest2571"
    ],
    "name": "turbottest2571",
    "tags": {
      "Name": "turbottest2571"
    },
    "title": "turbottest2571"
  }
]
✔ PASSED

POSTTEST: tests/azure_synapse_workspace

TEARDOWN: tests/azure_synapse_workspace

SUMMARY:

1/1 passed.

customEnv TURBOT_TEST_EXPECTED_TIMEOUT undefined

SETUP: tests/azure_virtual_network_gateway []

PRETEST: tests/azure_virtual_network_gateway

TEST: tests/azure_virtual_network_gateway
Running terraform

Warning: Deprecated

  with data.null_data_source.resource,
  on variables.tf line 28, in data "null_data_source" "resource":
  28: data "null_data_source" "resource" {

The null_data_source was historically used to construct intermediate values
to re-use elsewhere in configuration, the same can now be achieved using
locals

Error: Missing required argument

  on variables.tf line 46, in resource "azurerm_subnet" "named_test_resource":
  46: resource "azurerm_subnet" "named_test_resource" {

The argument "address_prefixes" is required, but no definition was found.

Error: Unsupported argument

  on variables.tf line 50, in resource "azurerm_subnet" "named_test_resource":
  50:   address_prefix       = "10.0.1.0/24"

An argument named "address_prefix" is not expected here. Did you mean
"address_prefixes"?
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED
Terraform run failed, skipping SQL queries

✘ FAILED

TEARDOWN: tests/azure_virtual_network_gateway


Error: Missing required argument

  on variables.tf line 46, in resource "azurerm_subnet" "named_test_resource":
  46: resource "azurerm_subnet" "named_test_resource" {

The argument "address_prefixes" is required, but no definition was found.

Error: Unsupported argument

  on variables.tf line 50, in resource "azurerm_subnet" "named_test_resource":
  50:   address_prefix       = "10.0.1.0/24"

An argument named "address_prefix" is not expected here. Did you mean
"address_prefixes"?
SUMMARY:

✘ tests/azure_virtual_network_gateway failed.

0/1 passed.

Fri Mar 10 11:45:04 UTC 2023
